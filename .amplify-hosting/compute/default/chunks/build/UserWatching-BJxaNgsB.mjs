import{_ as e}from"./BaseCard-5i8D5k_7.mjs";import{_ as t}from"./BaseHeader-CiSkdPXW.mjs";import{_ as r}from"./ProjectGrid-D_1C43qX.mjs";import{_ as a}from"./EmptyStateCard-3UqWseqH.mjs";import{toRef as o,withCtx as s,unref as i,createVNode as n,useSSRContext as m,ref as p,computed as l,watch as u}from"vue";import{ssrRenderComponent as c}from"vue/server-renderer";import{_ as d,u as g}from"./server.mjs";import"./VCard-CsohsM82.mjs";import"./VAvatar-JL8WKjry.mjs";import"./VImg-B2jcJjnn.mjs";import"./MediaThumbnail-jyEgcC54.mjs";import"hls.js";import"./UserAvatar-DFFlBvus.mjs";import"./ProjectCardSkeleton-DMcYuKOy.mjs";import"./VSkeletonLoader-CXOx9RZQ.mjs";import"./ProjectCardCompact-C94E1iON.mjs";import"./useDateFormatter-W2Hui1rv.mjs";import"./index-8pAncyvV.mjs";import"./index-DfGQ-Pg8.mjs";import"./VContainer-By3q0af_.mjs";import"./VRow-rkX0LEXR.mjs";import"./VCol-CKxprC4g.mjs";import"node:http";import"node:https";import"node:zlib";import"node:stream";import"node:buffer";import"node:util";import"node:url";import"node:net";import"node:fs";import"node:path";import"../_/nitro.mjs";import"consola/core";import"nuxt-site-config/urls";import"ipx";import"unhead";import"vue-router";import"pinia-plugin-persistedstate";const v={__name:"UserWatching",__ssrInlineRender:!0,props:{username:{type:String,required:!0}},setup(m){const d=o(m,"username"),{projects:v,isLoading:j,hasMore:h,currentPage:f,lastPage:y,loadMoreItems:_}=function(e){const{$axios:t}=g(),r=p([]),a=p(1),o=p(1),s=p(0),i=p(!1),fetchPage=async n=>{if(!e.value)throw new Error("Username is required");try{i.value=!0;const m=(await t.get(`/api/user/${e.value}/watching`,{params:{page:n,per_page:12}})).data;r.value=1===n?m.projects||[]:[...r.value,...m.projects||[]],o.value=m.last_page||1,s.value=m.total||0,a.value=n}catch(e){throw console.error("Error fetching watching projects:",e),e}finally{i.value=!1}},n=l((()=>a.value<o.value)),refresh=async()=>{r.value=[],a.value=1,o.value=1,s.value=0;try{await fetchPage(1)}catch(e){console.error("Error refreshing data:",e)}},reset=()=>{r.value=[],a.value=1,o.value=1,s.value=0,i.value=!1};return u(e,(e=>{e&&(reset(),refresh())}),{immediate:!0}),{projects:r,isLoading:i,hasMore:n,total:s,currentPage:a,lastPage:o,loadMoreItems:async()=>{if(n.value&&!i.value)try{await fetchPage(a.value+1)}catch(e){console.error("Error loading more items:",e)}},refresh:refresh,reset:reset}}(d),loadMore=()=>{h.value&&!j.value&&_()};return(o,m,p,l)=>{const u=t,d=r,g=a;m(c(e,l,{default:s(((e,t,r,a)=>{if(!t)return[n(u,{title:"Watching"}),n("div",{class:"user-watching"},[n(d,{projects:i(v),"current-page":i(f),"last-page":i(y),"is-loading":i(j),title:"Watching",variant:"grid",onLoadMore:loadMore},{"empty-state":s((()=>[n(g,{title:"No Watchings",message:"This user isn't watching any projects yet."})])),_:1},8,["projects","current-page","last-page","is-loading"])])];t(c(u,{title:"Watching"},null,r,a)),t(`<div class="user-watching" data-v-fd2e97d0${a}>`),t(c(d,{projects:i(v),"current-page":i(f),"last-page":i(y),"is-loading":i(j),title:"Watching",variant:"grid",onLoadMore:loadMore},{"empty-state":s(((e,t,r,a)=>{if(!t)return[n(g,{title:"No Watchings",message:"This user isn't watching any projects yet."})];t(c(g,{title:"No Watchings",message:"This user isn't watching any projects yet."},null,r,a))})),_:1},r,a)),t("</div>")})),_:1},p))}}},j=v.setup;v.setup=(e,t)=>{const r=m();return(r.modules||(r.modules=new Set)).add("components/profile/UserWatching.vue"),j?j(e,t):void 0};const h=d(v,[["__scopeId","data-v-fd2e97d0"]]);export{h as default};
