import{ref as e,useSSRContext as a,defineComponent as l,mergeProps as r,withCtx as s,unref as t,openBlock as n,createBlock as i,createCommentVNode as o,createVNode as d,toDisplayString as c,createTextVNode as u,renderSlot as m,Fragment as p,renderList as f}from"vue";import{ssrRenderAttrs as g,ssrRenderComponent as h,ssrRenderList as y,ssrInterpolate as _,ssrRenderSlot as v}from"vue/server-renderer";import x from"lodash/debounce.js";import{d as k,u as b,U as V,b as S,V as z,_ as L}from"./server.mjs";import{b as j,a as C}from"./index--K8ZrFMm.mjs";import{V as U}from"./VCard-CsohsM82.mjs";import{V as $}from"./VTextField-rd-VvEF8.mjs";import{V as w,a as R,b as I}from"./VListItem-jTLuICGb.mjs";import{V as F}from"./VAvatar-JL8WKjry.mjs";import{V as M}from"./VImg-B2jcJjnn.mjs";const q=k("userSearch",(()=>{const a=e([]),l=e(!1),r=e(null);return{searchResults:a,isLoading:l,error:r,searchUsers:async e=>{if(!e.trim())return a.value=[],{data:[]};l.value=!0,r.value=null;try{const{$axios:l}=b(),r=await l.get("/api/search-users",{params:{query:e}});return a.value=r.data.data,r.data}catch(e){throw r.value="Failed to search users. Please try again.",e}finally{l.value=!1}},clearSearch:()=>{a.value=[],r.value=null}}})),E=l({__name:"SearchUser",__ssrInlineRender:!0,props:{minSearchLength:{default:2},debounceMs:{default:300},loading:{type:Boolean,default:!1},placeholder:{default:""}},emits:["user-selected"],setup(a,{emit:l}){const k=a,b=l,L=q(),E=e(""),N=x((async e=>{e.length>=k.minSearchLength?await L.searchUsers(e):L.clearSearch()}),k.debounceMs),handleSearch=e=>{N(e)},handleClear=()=>{E.value="",L.clearSearch()},selectUser=e=>{b("user-selected",e)},getInitials=e=>e.split(" ").map((e=>e[0])).join("").toUpperCase().slice(0,2);return(e,a,l,x)=>{a(`<div${g(r({class:"user-search"},x))} data-v-c623875a>`),a(h(U,{flat:"",class:"mb-4 pa-2"},{default:s(((a,l,r,c)=>{if(!l)return[d($,{modelValue:E.value,"onUpdate:modelValue":[e=>E.value=e,handleSearch],density:"comfortable",variant:"outlined",label:"Search users",placeholder:e.placeholder||"Enter name or username","prepend-inner-icon":"mdi-magnify",loading:t(L).isLoading,error:!!t(L).error,"error-messages":t(L).error,clearable:"","onClick:clear":handleClear,"hide-details":""},{append:s((()=>[d(j,null,{default:s((()=>[t(L).isLoading?(n(),i(V,{key:0,indeterminate:"",size:"24",color:"primary"})):o("",!0)])),_:1})])),_:1},8,["modelValue","onUpdate:modelValue","placeholder","loading","error","error-messages"])];l(h($,{modelValue:E.value,"onUpdate:modelValue":[e=>E.value=e,handleSearch],density:"comfortable",variant:"outlined",label:"Search users",placeholder:e.placeholder||"Enter name or username","prepend-inner-icon":"mdi-magnify",loading:t(L).isLoading,error:!!t(L).error,"error-messages":t(L).error,clearable:"","onClick:clear":handleClear,"hide-details":""},{append:s(((e,a,l,r)=>{if(!a)return[d(j,null,{default:s((()=>[t(L).isLoading?(n(),i(V,{key:0,indeterminate:"",size:"24",color:"primary"})):o("",!0)])),_:1})];a(h(j,null,{default:s(((e,a,l,r)=>{if(!a)return[t(L).isLoading?(n(),i(V,{key:0,indeterminate:"",size:"24",color:"primary"})):o("",!0)];t(L).isLoading?a(h(V,{indeterminate:"",size:"24",color:"primary"},null,l,r)):a("\x3c!----\x3e")})),_:1},l,r))})),_:1},r,c))})),_:1},l)),a(h(C,{group:""},{default:s(((a,l,r,g)=>{if(!l)return[t(L).searchResults.length?(n(!0),i(p,{key:0},f(t(L).searchResults,(a=>(n(),i(U,{key:a.id,flat:"",class:"mb-2 user-card"},{default:s((()=>[d(w,null,{prepend:s((()=>[d(F,{size:"40",color:"grey-lighten-3"},{default:s((()=>[a.profile_photo?(n(),i(M,{key:0,src:a.profile_photo,alt:a.display_name},null,8,["src","alt"])):(n(),i("span",{key:1,class:"text-h6"},c(getInitials(a.display_name)),1))])),_:2},1024)])),append:s((()=>[d("div",{class:"d-flex align-center"},[m(e.$slots,"user-action",{user:a,selectUser:()=>selectUser(a)},(()=>[d(S,{color:"primary",variant:"tonal",size:"small",onClick:e=>selectUser(a),loading:e.loading},{default:s((()=>[u(" Select ")])),_:2},1032,["onClick","loading"])]),!0)])])),default:s((()=>[d(R,{class:"font-weight-medium"},{default:s((()=>[u(c(a.display_name),1)])),_:2},1024),d(I,{class:"text-grey"},{default:s((()=>[u(" @"+c(a.username),1)])),_:2},1024)])),_:2},1024)])),_:2},1024)))),128)):E.value&&!t(L).isLoading?(n(),i(U,{key:1,flat:"",class:"pa-4 text-center"},{default:s((()=>[d(z,{icon:"mdi-account-search-outline",size:"48",color:"grey-lighten-1",class:"mb-2"}),d("div",{class:"text-body-1 text-grey"},' No users found matching "'+c(E.value)+'" ',1)])),_:1})):o("",!0)];t(L).searchResults.length?(l("\x3c!--[--\x3e"),y(t(L).searchResults,(a=>{l(h(U,{key:a.id,flat:"",class:"mb-2 user-card"},{default:s(((l,r,t,o)=>{if(!r)return[d(w,null,{prepend:s((()=>[d(F,{size:"40",color:"grey-lighten-3"},{default:s((()=>[a.profile_photo?(n(),i(M,{key:0,src:a.profile_photo,alt:a.display_name},null,8,["src","alt"])):(n(),i("span",{key:1,class:"text-h6"},c(getInitials(a.display_name)),1))])),_:2},1024)])),append:s((()=>[d("div",{class:"d-flex align-center"},[m(e.$slots,"user-action",{user:a,selectUser:()=>selectUser(a)},(()=>[d(S,{color:"primary",variant:"tonal",size:"small",onClick:e=>selectUser(a),loading:e.loading},{default:s((()=>[u(" Select ")])),_:2},1032,["onClick","loading"])]),!0)])])),default:s((()=>[d(R,{class:"font-weight-medium"},{default:s((()=>[u(c(a.display_name),1)])),_:2},1024),d(I,{class:"text-grey"},{default:s((()=>[u(" @"+c(a.username),1)])),_:2},1024)])),_:2},1024)];r(h(w,null,{prepend:s(((e,l,r,t)=>{if(!l)return[d(F,{size:"40",color:"grey-lighten-3"},{default:s((()=>[a.profile_photo?(n(),i(M,{key:0,src:a.profile_photo,alt:a.display_name},null,8,["src","alt"])):(n(),i("span",{key:1,class:"text-h6"},c(getInitials(a.display_name)),1))])),_:2},1024)];l(h(F,{size:"40",color:"grey-lighten-3"},{default:s(((e,l,r,s)=>{if(!l)return[a.profile_photo?(n(),i(M,{key:0,src:a.profile_photo,alt:a.display_name},null,8,["src","alt"])):(n(),i("span",{key:1,class:"text-h6"},c(getInitials(a.display_name)),1))];a.profile_photo?l(h(M,{src:a.profile_photo,alt:a.display_name},null,r,s)):l(`<span class="text-h6" data-v-c623875a${s}>${_(getInitials(a.display_name))}</span>`)})),_:2},r,t))})),append:s(((l,r,t,n)=>{if(!r)return[d("div",{class:"d-flex align-center"},[m(e.$slots,"user-action",{user:a,selectUser:()=>selectUser(a)},(()=>[d(S,{color:"primary",variant:"tonal",size:"small",onClick:e=>selectUser(a),loading:e.loading},{default:s((()=>[u(" Select ")])),_:2},1032,["onClick","loading"])]),!0)])];r(`<div class="d-flex align-center" data-v-c623875a${n}>`),v(e.$slots,"user-action",{user:a,selectUser:()=>selectUser(a)},(()=>{r(h(S,{color:"primary",variant:"tonal",size:"small",onClick:e=>selectUser(a),loading:e.loading},{default:s(((e,a,l,r)=>{if(!a)return[u(" Select ")];a(" Select ")})),_:2},t,n))}),r,t,n),r("</div>")})),default:s(((e,l,r,t)=>{if(!l)return[d(R,{class:"font-weight-medium"},{default:s((()=>[u(c(a.display_name),1)])),_:2},1024),d(I,{class:"text-grey"},{default:s((()=>[u(" @"+c(a.username),1)])),_:2},1024)];l(h(R,{class:"font-weight-medium"},{default:s(((e,l,r,s)=>{if(!l)return[u(c(a.display_name),1)];l(`${_(a.display_name)}`)})),_:2},r,t)),l(h(I,{class:"text-grey"},{default:s(((e,l,r,s)=>{if(!l)return[u(" @"+c(a.username),1)];l(` @${_(a.username)}`)})),_:2},r,t))})),_:2},t,o))})),_:2},r,g))})),l("\x3c!--]--\x3e")):E.value&&!t(L).isLoading?l(h(U,{flat:"",class:"pa-4 text-center"},{default:s(((e,a,l,r)=>{if(!a)return[d(z,{icon:"mdi-account-search-outline",size:"48",color:"grey-lighten-1",class:"mb-2"}),d("div",{class:"text-body-1 text-grey"},' No users found matching "'+c(E.value)+'" ',1)];a(h(z,{icon:"mdi-account-search-outline",size:"48",color:"grey-lighten-1",class:"mb-2"},null,l,r)),a(`<div class="text-body-1 text-grey" data-v-c623875a${r}> No users found matching &quot;${_(E.value)}&quot; </div>`)})),_:1},r,g)):l("\x3c!----\x3e")})),_:3},l)),a("</div>")}}}),N=E.setup;E.setup=(e,l)=>{const r=a();return(r.modules||(r.modules=new Set)).add("components/search/SearchUser.vue"),N?N(e,l):void 0};const B=L(E,[["__scopeId","data-v-c623875a"]]);export{B as _};
