import{_ as t}from"./BaseContent-D2jufG_L.mjs";import{_ as a}from"./BaseButton-BTGPFNw4.mjs";import{useSSRContext as e,ref as s,computed as n,mergeProps as r,withCtx as i,createVNode as o,createTextVNode as l,toDisplayString as c,defineComponent as u,watch as d,openBlock as m,createBlock as p,createCommentVNode as v,Fragment as f,renderList as y}from"vue";import{ssrRenderAttrs as h,ssrRenderComponent as x,ssrInterpolate as w,ssrRenderClass as g,ssrRenderList as _}from"vue/server-renderer";import{u as b}from"./useDateFormatter-W2Hui1rv.mjs";import{d as T,u as $,V as j,U as A,_ as W}from"./server.mjs";import{V as k}from"./VAvatar-JL8WKjry.mjs";import{a as V}from"./VChip-f_o2BAA4.mjs";import{useRouter as z}from"vue-router";import{isAxiosError as I}from"axios";import{u as F}from"./useWalletStore-C5It8oQZ.mjs";import{c as B}from"./index-8pAncyvV.mjs";const C={__name:"WalletTransactionItem",__ssrInlineRender:!0,props:{transaction:{type:Object,required:!0}},setup(t){const a=t,e=s(!1),{formatRelativeDate:u}=b(),d=n((()=>{const t={withdrawal:"mdi-cash-minus",deposit:"mdi-cash-plus",transfer:"mdi-bank-transfer",default:"mdi-cash"};return t[a.transaction.transaction_type]||t.default})),m=n((()=>{const t={withdrawal:"error",deposit:"success",transfer:"primary",default:"grey"};return t[a.transaction.transaction_type]||t.default})),p=n((()=>a.transaction.transaction_type.charAt(0).toUpperCase()+a.transaction.transaction_type.slice(1))),v=n((()=>{const t=parseFloat(a.transaction.amount);return`${a.transaction.currency_symbol} ${t.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}`})),f=n((()=>"withdrawal"===a.transaction.transaction_type?"text-error":"text-success")),y=n((()=>u(a.transaction.created_at))),_=n((()=>{const t={completed:"success",pending:"warning",failed:"error",default:"info"};return t[a.transaction.status]||t.default})),T=n((()=>"completed"===a.transaction.status?"flat":"outlined"));return(a,s,n,u)=>{s(`<div${h(r({class:["transaction-item d-flex align-center py-4",{"hover-state":e.value}]},u))} data-v-c7b69ce6>`),s(x(k,{color:m.value,size:"42",class:"mr-4"},{default:i(((t,a,e,s)=>{if(!a)return[o(j,{icon:d.value,color:"white",size:"20"},null,8,["icon"])];a(x(j,{icon:d.value,color:"white",size:"20"},null,e,s))})),_:1},n)),s(`<div class="flex-grow-1" data-v-c7b69ce6><div class="d-flex align-center justify-space-between" data-v-c7b69ce6><div data-v-c7b69ce6><div class="text-h6 font-weight-medium" data-v-c7b69ce6>${w(p.value)}</div><div class="text-caption text-medium-emphasis mt-1 d-flex align-center" data-v-c7b69ce6>`),s(x(j,{size:"14",icon:"mdi-clock-outline",class:"mr-1"},null,n)),s(` ${w(y.value)}</div></div><div class="text-end" data-v-c7b69ce6><div class="${g(["text-h6 font-weight-medium",f.value])}" data-v-c7b69ce6>${w(v.value)}</div>`),s(x(V,{color:_.value,size:"small",class:"mt-1",variant:T.value,density:"comfortable"},{default:i(((a,e,s,n)=>{if(!e)return[l(c(t.transaction.status),1)];e(`${w(t.transaction.status)}`)})),_:1},n)),s("</div></div></div></div>")}}},D=C.setup;C.setup=(t,a)=>{const s=e();return(s.modules||(s.modules=new Set)).add("components/wallet/WalletTransactionItem.vue"),D?D(t,a):void 0};const N=W(C,[["__scopeId","data-v-c7b69ce6"]]),S=T("wallet-transactions",(()=>{const{$axios:t}=$(),a=F(),handleTransactionError=t=>{var a,e,s,n,r;if(I(t)){const i=t;throw{message:(null==(e=null==(a=i.response)?void 0:a.data)?void 0:e.message)||i.message,status:null==(s=i.response)?void 0:s.status,code:null==(r=null==(n=i.response)?void 0:n.data)?void 0:r.code}}throw{message:t instanceof Error?t.message:"An unexpected error occurred"}};return{transferFunds:async e=>{try{const{data:s}=await t.post("/api/wallet/transfer",e);return await a.fetchWallet(),s}catch(t){return handleTransactionError(t)}},processTransaction:async(e,s)=>{try{const{data:n}=await t.post(`/api/wallet/transactions/${e}`,s);return await a.fetchWallet(),n}catch(t){return handleTransactionError(t)}},fetchTransactions:async(a={})=>{const{type:e="all",page:s=1,limit:n=10,recent:r=!1}=a;try{const{data:a}=await t.get("/api/wallet/transactions",{params:{type:e,page:s,limit:n,recent:r}});return a}catch(t){return handleTransactionError(t)}},fetchWalletStatistics:async()=>{try{const{data:a}=await t.get("/api/wallet/transactions/statistics");return a}catch(t){return handleTransactionError(t)}}}})),R=u({__name:"WalletTransactions",__ssrInlineRender:!0,props:{transactionType:{type:String,default:"all"},limit:{type:Number,default:10},showViewAll:{type:Boolean,default:!0}},setup(e){const l=e,u=z(),h=S(),g=s([]),b=s(1),T=s(!1),$=s(null),W=s(!0),k=n((()=>{switch(l.transactionType){case"deposit":return"Deposit Transactions";case"withdrawal":return"Withdrawal Transactions";case"transfer":return"Transfer Transactions";default:return"Recent Transactions"}})),fetchTransactions=async(t=b.value)=>{if(!T.value&&W.value){T.value=!0;try{const a=await h.fetchTransactions({type:l.transactionType,page:t,limit:l.limit}),e=a.data.map(formatTransaction);g.value=1===t?e:[...g.value,...e],a.meta?(b.value=a.meta.current_page,W.value=a.meta.current_page<a.meta.last_page):W.value=e.length===l.limit}catch(t){console.error("Error fetching transactions:",t)}finally{T.value=!1}}},formatTransaction=t=>({...t,title:getTitle(t),subtitle:getSubtitle(t)}),getTitle=t=>t.transaction_type.charAt(0).toUpperCase()+t.transaction_type.slice(1),getSubtitle=t=>t.status.charAt(0).toUpperCase()+t.status.slice(1),viewAllTransactions=()=>{u.push("/wallet/transactions")};return B($,(()=>{W.value&&!T.value&&fetchTransactions(b.value+1)}),{distance:10,throttle:500}),d((()=>l.transactionType),(()=>{b.value=1,g.value=[],W.value=!0,fetchTransactions()})),(s,n,l,u)=>{const d=a,h=N;n(x(t,r({title:k.value},u),{action:i(((t,a,s,n)=>{if(!a)return[e.showViewAll?(m(),p(d,{key:0,title:"View All",action:viewAllTransactions,disabled:T.value,prependIcon:"mdi-eye",color:"primary",variant:"tonal"},null,8,["disabled"])):v("",!0)];e.showViewAll?a(x(d,{title:"View All",action:viewAllTransactions,disabled:T.value,prependIcon:"mdi-eye",color:"primary",variant:"tonal"},null,s,n)):a("\x3c!----\x3e")})),content:i(((t,a,s,n)=>{if(!a)return[o("div",{class:"transactions-list",ref_key:"transactionListRef",ref:$},[g.value.length?(m(),p(f,{key:0},[(m(!0),p(f,null,y(g.value,(t=>(m(),p(h,{key:t.id,transaction:t},null,8,["transaction"])))),128)),T.value?(m(),p("div",{key:0,class:"d-flex justify-center py-4"},[o(A,{indeterminate:"",color:"primary",size:"24"})])):v("",!0),W.value?v("",!0):(m(),p("div",{key:1,class:"text-center py-4 text-caption text-medium-emphasis"}," No more transactions to load "))],64)):T.value?v("",!0):(m(),p("div",{key:1,class:"empty-state"},[o(j,{icon:"mdi-cash-multiple-off",size:"64",color:"grey-lighten-1",class:"mb-4"}),o("h3",{class:"text-h6 mb-2"},"No Transactions Found"),o("p",{class:"text-body-2 text-medium-emphasis"}," There are no "+c(e.transactionType)+" transactions to display. ",1)]))],512)];a(`<div class="transactions-list" data-v-4b56f2f3${n}>`),g.value.length?(a("\x3c!--[--\x3e\x3c!--[--\x3e"),_(g.value,(t=>{a(x(h,{key:t.id,transaction:t},null,s,n))})),a("\x3c!--]--\x3e"),T.value?(a(`<div class="d-flex justify-center py-4" data-v-4b56f2f3${n}>`),a(x(A,{indeterminate:"",color:"primary",size:"24"},null,s,n)),a("</div>")):a("\x3c!----\x3e"),W.value?a("\x3c!----\x3e"):a(`<div class="text-center py-4 text-caption text-medium-emphasis" data-v-4b56f2f3${n}> No more transactions to load </div>`),a("\x3c!--]--\x3e")):T.value?a("\x3c!----\x3e"):(a(`<div class="empty-state" data-v-4b56f2f3${n}>`),a(x(j,{icon:"mdi-cash-multiple-off",size:"64",color:"grey-lighten-1",class:"mb-4"},null,s,n)),a(`<h3 class="text-h6 mb-2" data-v-4b56f2f3${n}>No Transactions Found</h3><p class="text-body-2 text-medium-emphasis" data-v-4b56f2f3${n}> There are no ${w(e.transactionType)} transactions to display. </p></div>`)),a("</div>")})),_:1},l))}}}),L=R.setup;R.setup=(t,a)=>{const s=e();return(s.modules||(s.modules=new Set)).add("components/wallet/WalletTransactions.vue"),L?L(t,a):void 0};const U=W(R,[["__scopeId","data-v-4b56f2f3"]]);export{U as _};
