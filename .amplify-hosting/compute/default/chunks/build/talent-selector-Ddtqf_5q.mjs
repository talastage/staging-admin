import{useSSRContext as e,defineComponent as a,ref as t,mergeProps as l,withCtx as r,createVNode as o,openBlock as s,createBlock as i,Fragment as n,renderList as u,createTextVNode as d,toDisplayString as m,createCommentVNode as c}from"vue";import{ssrRenderAttrs as p,ssrRenderComponent as v,ssrRenderList as f,ssrInterpolate as g}from"vue/server-renderer";import{B as y}from"./BaseDialog-DsGYlnLZ.mjs";import{_ as h,u as _,a as x,b,V}from"./server.mjs";import{V as j}from"./VRow-rkX0LEXR.mjs";import{V as k}from"./VCol-CKxprC4g.mjs";import{V as C}from"./VSkeletonLoader-CXOx9RZQ.mjs";import{V as R}from"./VAlert-DneVUU3Q.mjs";import{V as T,a as $}from"./VChip-f_o2BAA4.mjs";import{V as w}from"./VSpacer-_gFExeVk.mjs";import{V as B}from"./VSnackbar-zBX8NfdO.mjs";import"./VDialog-DA9BdIfh.mjs";import"./VOverlay-ZKavbTei.mjs";import"./easing-Bn3h-KUg.mjs";import"./VImg-B2jcJjnn.mjs";import"./forwardRefs-BSTjJZPU.mjs";import"./dialog-transition-BU2TTOTj.mjs";import"./VCard-CsohsM82.mjs";import"./VAvatar-JL8WKjry.mjs";import"node:http";import"node:https";import"node:zlib";import"node:stream";import"node:buffer";import"node:util";import"node:url";import"node:net";import"node:fs";import"node:path";import"../_/nitro.mjs";import"consola/core";import"nuxt-site-config/urls";import"ipx";import"unhead";import"vue-router";import"pinia-plugin-persistedstate";import"./index--K8ZrFMm.mjs";const U=a({__name:"PopularTalentSelector",__ssrInlineRender:!0,emits:["talentRegistered","error"],setup(e,{emit:a}){const{$axios:h}=_(),U=x(),z=t(!1),S=t(!1),A=t(null),D=t([]),E=t(null),F=t(null),K=t(!1),Y=t(!1),Z=a,fetchPopularTalents=async()=>{var e,a;z.value=!0,A.value=null;try{const e=await h.get("/api/talents/popular");if(!e.data.success)throw new Error(e.data.message||"Failed to fetch popular talents");D.value=e.data.data}catch(t){console.error("Error fetching popular talents:",t),A.value=(null==(a=null==(e=t.response)?void 0:e.data)?void 0:a.message)||t.message||"Failed to load popular talents"}finally{z.value=!1}},selectTalent=(e,a)=>{E.value=e,F.value=a,K.value=!0},cancelSelection=()=>{E.value=null,F.value=null,K.value=!1},confirmRegistration=async()=>{var e,a;if(E.value){S.value=!0;try{const e={talent_category_id:E.value.category_id,talent_id:E.value.id},a=await h.post("/api/user/talent",e);if(201===a.status){const e=a.data.user_talent;U.updateUser({has_talent:"yes",talent:e.name,talent_details:{category:e.category.name,talent:e.name,talent_id:e.talent_id,category_id:e.category_id}}),Y.value=!0,K.value=!1,Z("talentRegistered",E.value),E.value=null,F.value=null}}catch(t){console.error("Error registering talent:",t);const l=(null==(a=null==(e=t.response)?void 0:e.data)?void 0:a.message)||"Failed to register talent";A.value=l,Z("error",l)}finally{S.value=!1}}};return(e,a,t,h)=>{a(`<div${p(l({class:"popular-talent-selector"},h))} data-v-1e02a67d>`),z.value?(a('<div class="loading-container" data-v-1e02a67d>'),a(v(j,null,{default:r(((e,a,t,l)=>{if(!a)return[(s(),i(n,null,u(8,(e=>o(k,{key:e,cols:"6",sm:"4",md:"3"},{default:r((()=>[o(C,{type:"chip",class:"mb-2"})])),_:2},1024))),64))];a("\x3c!--[--\x3e"),f(8,(e=>{a(v(k,{key:e,cols:"6",sm:"4",md:"3"},{default:r(((e,a,t,l)=>{if(!a)return[o(C,{type:"chip",class:"mb-2"})];a(v(C,{type:"chip",class:"mb-2"},null,t,l))})),_:2},t,l))})),a("\x3c!--]--\x3e")})),_:1},t)),a("</div>")):A.value?a(v(R,{type:"error",class:"mb-4"},{append:r(((e,a,t,l)=>{if(!a)return[o(b,{size:"small",variant:"text",onClick:fetchPopularTalents},{default:r((()=>[d(" Retry ")])),_:1})];a(v(b,{size:"small",variant:"text",onClick:fetchPopularTalents},{default:r(((e,a,t,l)=>{if(!a)return[d(" Retry ")];a(" Retry ")})),_:1},t,l))})),default:r(((e,a,t,l)=>{if(!a)return[d(m(A.value)+" ",1)];a(`${g(A.value)} `)})),_:1},t)):D.value.length>0?(a('<div class="talents-grid" data-v-1e02a67d>'),a(v(T,{modelValue:F.value,"onUpdate:modelValue":e=>F.value=e,column:"",mandatory:"{false}",class:"talent-chips"},{default:r(((e,a,t,l)=>{if(!a)return[(s(!0),i(n,null,u(D.value,((e,a)=>(s(),i($,{key:e.id,value:a,variant:"outlined",size:"default",class:["talent-chip",{"talent-chip--selected":F.value===a}],onClick:t=>selectTalent(e,a)},{default:r((()=>[d(m(e.name),1)])),_:2},1032,["value","class","onClick"])))),128))];a("\x3c!--[--\x3e"),f(D.value,((e,o)=>{a(v($,{key:e.id,value:o,variant:"outlined",size:"default",class:["talent-chip",{"talent-chip--selected":F.value===o}],onClick:a=>selectTalent(e,o)},{default:r(((a,t,l,r)=>{if(!t)return[d(m(e.name),1)];t(`${g(e.name)}`)})),_:2},t,l))})),a("\x3c!--]--\x3e")})),_:1},t)),a("</div>")):a(v(R,{type:"info",variant:"tonal"},{default:r(((e,a,t,l)=>{if(!a)return[d(" No popular talents available at the moment. ")];a(" No popular talents available at the moment. ")})),_:1},t)),a(v(y,{modelValue:K.value,"onUpdate:modelValue":e=>K.value=e,title:"Confirm Talent Registration","max-width":"450px"},{actions:r(((e,a,t,l)=>{if(!a)return[o(w),o(b,{variant:"text",onClick:cancelSelection,disabled:S.value},{default:r((()=>[d(" Cancel ")])),_:1},8,["disabled"]),o(b,{color:"primary",variant:"flat",onClick:confirmRegistration,loading:S.value},{default:r((()=>[d(" Confirm Registration ")])),_:1},8,["loading"])];a(v(w,null,null,t,l)),a(v(b,{variant:"text",onClick:cancelSelection,disabled:S.value},{default:r(((e,a,t,l)=>{if(!a)return[d(" Cancel ")];a(" Cancel ")})),_:1},t,l)),a(v(b,{color:"primary",variant:"flat",onClick:confirmRegistration,loading:S.value},{default:r(((e,a,t,l)=>{if(!a)return[d(" Confirm Registration ")];a(" Confirm Registration ")})),_:1},t,l))})),default:r(((e,a,t,l)=>{var n,u;if(!a)return[E.value?(s(),i("div",{key:0,class:"confirmation-content"},[o("div",{class:"text-center mb-4"},[o(V,{size:"48",color:"primary",class:"mb-2"},{default:r((()=>[d("mdi-star")])),_:1}),o("h3",{class:"text-h6 mb-2"},"Register Your Talent"),o("p",{class:"text-body-1"},[d(" You're about to register "),o("strong",null,m(E.value.name),1),d(" in the "),o("strong",null,m(null==(u=E.value.category)?void 0:u.name),1),d(" category. ")]),o("p",{class:"text-body-2 text-medium-emphasis mt-2"}," This will be added to your profile and help others discover your skills. ")])])):c("",!0)];E.value?(a(`<div class="confirmation-content" data-v-1e02a67d${l}><div class="text-center mb-4" data-v-1e02a67d${l}>`),a(v(V,{size:"48",color:"primary",class:"mb-2"},{default:r(((e,a,t,l)=>{if(!a)return[d("mdi-star")];a("mdi-star")})),_:1},t,l)),a(`<h3 class="text-h6 mb-2" data-v-1e02a67d${l}>Register Your Talent</h3><p class="text-body-1" data-v-1e02a67d${l}> You&#39;re about to register <strong data-v-1e02a67d${l}>${g(E.value.name)}</strong> in the <strong data-v-1e02a67d${l}>${g(null==(n=E.value.category)?void 0:n.name)}</strong> category. </p><p class="text-body-2 text-medium-emphasis mt-2" data-v-1e02a67d${l}> This will be added to your profile and help others discover your skills. </p></div></div>`)):a("\x3c!----\x3e")})),_:1},t)),a(v(B,{modelValue:Y.value,"onUpdate:modelValue":e=>Y.value=e,color:"success",timeout:"4000",location:"top"},{default:r(((e,a,t,l)=>{if(!a)return[o(V,null,{default:r((()=>[d("mdi-check-circle")])),_:1}),d(" Talent registered successfully! ")];a(v(V,null,{default:r(((e,a,t,l)=>{if(!a)return[d("mdi-check-circle")];a("mdi-check-circle")})),_:1},t,l)),a(" Talent registered successfully! ")})),_:1},t)),a("</div>")}}}),z=U.setup;U.setup=(a,t)=>{const l=e();return(l.modules||(l.modules=new Set)).add("components/talent/PopularTalentSelector.vue"),z?z(a,t):void 0};const S=h(U,[["__scopeId","data-v-1e02a67d"]]),A={};const D=A.setup;A.setup=(a,t)=>{const l=e();return(l.modules||(l.modules=new Set)).add("pages/test/talent-selector.vue"),D?D(a,t):void 0};const E=h(A,[["ssrRender",function(e,a,t,l){a(v(S,l,null,t))}]]);export{E as default};
