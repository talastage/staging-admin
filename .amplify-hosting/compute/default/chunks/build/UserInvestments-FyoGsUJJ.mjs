import{_ as e}from"./BaseCard-5i8D5k_7.mjs";import{_ as t}from"./BaseHeader-CiSkdPXW.mjs";import{_ as n}from"./nuxt-link-CU98Qcmd.mjs";import{_ as a}from"./MediaThumbnail-jyEgcC54.mjs";import{useSSRContext as s,defineComponent as r,computed as o,mergeProps as i,withCtx as l,createVNode as m,createTextVNode as c,toDisplayString as u,openBlock as v,createBlock as d,createCommentVNode as p,ref as f,unref as _,Fragment as h,renderList as g}from"vue";import{ssrRenderComponent as j,ssrInterpolate as y,ssrRenderList as x}from"vue/server-renderer";import{_ as b,a as k,b as w,u as C,af as V,U}from"./server.mjs";import{V as I}from"./VCard-CsohsM82.mjs";import{V as $}from"./VRow-rkX0LEXR.mjs";import{V as D}from"./VCol-CKxprC4g.mjs";import{a as A}from"./VChip-f_o2BAA4.mjs";import{_ as S}from"./EmptyStateCard-3UqWseqH.mjs";import{_ as M}from"./ApproveInvestmentDialog-BXN4VChx.mjs";import{u as B}from"./useInfiniteScroll-CumoSAIu.mjs";import"hls.js";import"./VImg-B2jcJjnn.mjs";import"node:http";import"node:https";import"node:zlib";import"node:stream";import"node:buffer";import"node:util";import"node:url";import"node:net";import"node:fs";import"node:path";import"../_/nitro.mjs";import"consola/core";import"nuxt-site-config/urls";import"ipx";import"unhead";import"vue-router";import"pinia-plugin-persistedstate";import"./VAvatar-JL8WKjry.mjs";import"./index--K8ZrFMm.mjs";import"./BaseDialog-DsGYlnLZ.mjs";import"./VDialog-DA9BdIfh.mjs";import"./VOverlay-ZKavbTei.mjs";import"./easing-Bn3h-KUg.mjs";import"./forwardRefs-BSTjJZPU.mjs";import"./dialog-transition-BU2TTOTj.mjs";import"./useSnackMessage-PVLwAm7x.mjs";import"./VSpacer-_gFExeVk.mjs";import"./VContainer-By3q0af_.mjs";import"./VListItem-jTLuICGb.mjs";import"./VTextarea-DkPaPTLI.mjs";import"./VCounter-BZE6l8kb.mjs";import"./VField-ZM6yOiXp.mjs";import"./VInput-DRJS2l97.mjs";const L=r({__name:"UserInvestmentCard",__ssrInlineRender:!0,props:{investment:{}},emits:["openApproveDialog"],setup(e){const t=e,s=k(),r=o((()=>{var e;return(null==(e=s.user)?void 0:e.id)||""})),f=o((()=>`/watch/${t.investment.project.access_uuid}`)),_=o((()=>`/investments/earnings/projects/${t.investment.project.access_uuid}/investor-details-${r.value}`));o((()=>`/project/${t.investment.project.access_uuid}/earnings/`));const formatDate=e=>{if(!e)return"";return`${Math.floor((Date.now()-new Date(e).getTime())/2592e6)} months ago`},getStatusColor=e=>({approved:"success",pending:"warning",rejected:"error"}[e]||"grey");return(e,t,s,r)=>{const o=n,h=a;t(j(I,i({elevation:"2",class:"investment-card mb-4"},r),{default:l(((t,n,a,s)=>{if(!n)return[m($,{"no-gutters":""},{default:l((()=>[m(D,{cols:"12",sm:"3",class:"media-column"},{default:l((()=>[m(o,{to:f.value,class:"media-link"},{default:l((()=>[m(h,{size:"md",videoUrl:e.investment.project.video_url,thumbnailUrl:e.investment.project.thumbnail_url,showViews:!1,showDuration:!0,class:"project-thumbnail-wrapper"},null,8,["videoUrl","thumbnailUrl"])])),_:1},8,["to"])])),_:1}),m(D,{cols:"12",sm:"6",class:"content-column pa-4"},{default:l((()=>{var t;return[m("h3",{class:"text-h6 font-weight-medium text-truncate"},u(e.investment.project.name),1),m("div",{class:"text-body-2 text-grey-darken-1 mt-1"},u(null==(t=e.investment.project.views_count)?void 0:t.toLocaleString())+" views • "+u(formatDate(e.investment.project.created_at)),1),m("div",{class:"mt-2 d-flex gap-2"},[m(A,{small:"",color:e.investment.is_creator?"primary":"grey",variant:"flat"},{default:l((()=>[c(u(e.investment.is_creator?"Creator":"Investor"),1)])),_:1},8,["color"]),m(A,{small:"",color:getStatusColor(e.investment.status),variant:"flat"},{default:l((()=>[c(u(e.investment.status),1)])),_:1},8,["color"]),m(A,{small:"",color:"success",variant:"flat"},{default:l((()=>[c(u(e.investment.share_percentage)+"% Share ",1)])),_:1})])]})),_:2},1024),m(D,{cols:"12",sm:"3",class:"actions-column pa-4"},{default:l((()=>[m(w,{to:_.value,color:"primary",variant:"tonal","prepend-icon":"mdi-information",block:"",class:"mb-2"},{default:l((()=>[c(" My Earnings ")])),_:1},8,["to"]),"pending"===e.investment.status&&e.investment.can_approve?(v(),d(w,{key:0,color:"success",variant:"tonal","prepend-icon":"mdi-check",block:"",onClick:t=>e.$emit("openApproveDialog",e.investment)},{default:l((()=>[c(" Approve ")])),_:1},8,["onClick"])):p("",!0)])),_:1})])),_:2},1024)];n(j($,{"no-gutters":""},{default:l(((t,n,a,s)=>{if(!n)return[m(D,{cols:"12",sm:"3",class:"media-column"},{default:l((()=>[m(o,{to:f.value,class:"media-link"},{default:l((()=>[m(h,{size:"md",videoUrl:e.investment.project.video_url,thumbnailUrl:e.investment.project.thumbnail_url,showViews:!1,showDuration:!0,class:"project-thumbnail-wrapper"},null,8,["videoUrl","thumbnailUrl"])])),_:1},8,["to"])])),_:1}),m(D,{cols:"12",sm:"6",class:"content-column pa-4"},{default:l((()=>{var t;return[m("h3",{class:"text-h6 font-weight-medium text-truncate"},u(e.investment.project.name),1),m("div",{class:"text-body-2 text-grey-darken-1 mt-1"},u(null==(t=e.investment.project.views_count)?void 0:t.toLocaleString())+" views • "+u(formatDate(e.investment.project.created_at)),1),m("div",{class:"mt-2 d-flex gap-2"},[m(A,{small:"",color:e.investment.is_creator?"primary":"grey",variant:"flat"},{default:l((()=>[c(u(e.investment.is_creator?"Creator":"Investor"),1)])),_:1},8,["color"]),m(A,{small:"",color:getStatusColor(e.investment.status),variant:"flat"},{default:l((()=>[c(u(e.investment.status),1)])),_:1},8,["color"]),m(A,{small:"",color:"success",variant:"flat"},{default:l((()=>[c(u(e.investment.share_percentage)+"% Share ",1)])),_:1})])]})),_:2},1024),m(D,{cols:"12",sm:"3",class:"actions-column pa-4"},{default:l((()=>[m(w,{to:_.value,color:"primary",variant:"tonal","prepend-icon":"mdi-information",block:"",class:"mb-2"},{default:l((()=>[c(" My Earnings ")])),_:1},8,["to"]),"pending"===e.investment.status&&e.investment.can_approve?(v(),d(w,{key:0,color:"success",variant:"tonal","prepend-icon":"mdi-check",block:"",onClick:t=>e.$emit("openApproveDialog",e.investment)},{default:l((()=>[c(" Approve ")])),_:1},8,["onClick"])):p("",!0)])),_:1})];n(j(D,{cols:"12",sm:"3",class:"media-column"},{default:l(((t,n,a,s)=>{if(!n)return[m(o,{to:f.value,class:"media-link"},{default:l((()=>[m(h,{size:"md",videoUrl:e.investment.project.video_url,thumbnailUrl:e.investment.project.thumbnail_url,showViews:!1,showDuration:!0,class:"project-thumbnail-wrapper"},null,8,["videoUrl","thumbnailUrl"])])),_:1},8,["to"])];n(j(o,{to:f.value,class:"media-link"},{default:l(((t,n,a,s)=>{if(!n)return[m(h,{size:"md",videoUrl:e.investment.project.video_url,thumbnailUrl:e.investment.project.thumbnail_url,showViews:!1,showDuration:!0,class:"project-thumbnail-wrapper"},null,8,["videoUrl","thumbnailUrl"])];n(j(h,{size:"md",videoUrl:e.investment.project.video_url,thumbnailUrl:e.investment.project.thumbnail_url,showViews:!1,showDuration:!0,class:"project-thumbnail-wrapper"},null,a,s))})),_:1},a,s))})),_:1},a,s)),n(j(D,{cols:"12",sm:"6",class:"content-column pa-4"},{default:l(((t,n,a,s)=>{var r,o;if(!n)return[m("h3",{class:"text-h6 font-weight-medium text-truncate"},u(e.investment.project.name),1),m("div",{class:"text-body-2 text-grey-darken-1 mt-1"},u(null==(o=e.investment.project.views_count)?void 0:o.toLocaleString())+" views • "+u(formatDate(e.investment.project.created_at)),1),m("div",{class:"mt-2 d-flex gap-2"},[m(A,{small:"",color:e.investment.is_creator?"primary":"grey",variant:"flat"},{default:l((()=>[c(u(e.investment.is_creator?"Creator":"Investor"),1)])),_:1},8,["color"]),m(A,{small:"",color:getStatusColor(e.investment.status),variant:"flat"},{default:l((()=>[c(u(e.investment.status),1)])),_:1},8,["color"]),m(A,{small:"",color:"success",variant:"flat"},{default:l((()=>[c(u(e.investment.share_percentage)+"% Share ",1)])),_:1})])];n(`<h3 class="text-h6 font-weight-medium text-truncate" data-v-b1130182${s}>${y(e.investment.project.name)}</h3><div class="text-body-2 text-grey-darken-1 mt-1" data-v-b1130182${s}>${y(null==(r=e.investment.project.views_count)?void 0:r.toLocaleString())} views • ${y(formatDate(e.investment.project.created_at))}</div><div class="mt-2 d-flex gap-2" data-v-b1130182${s}>`),n(j(A,{small:"",color:e.investment.is_creator?"primary":"grey",variant:"flat"},{default:l(((t,n,a,s)=>{if(!n)return[c(u(e.investment.is_creator?"Creator":"Investor"),1)];n(`${y(e.investment.is_creator?"Creator":"Investor")}`)})),_:1},a,s)),n(j(A,{small:"",color:getStatusColor(e.investment.status),variant:"flat"},{default:l(((t,n,a,s)=>{if(!n)return[c(u(e.investment.status),1)];n(`${y(e.investment.status)}`)})),_:1},a,s)),n(j(A,{small:"",color:"success",variant:"flat"},{default:l(((t,n,a,s)=>{if(!n)return[c(u(e.investment.share_percentage)+"% Share ",1)];n(`${y(e.investment.share_percentage)}% Share `)})),_:1},a,s)),n("</div>")})),_:1},a,s)),n(j(D,{cols:"12",sm:"3",class:"actions-column pa-4"},{default:l(((t,n,a,s)=>{if(!n)return[m(w,{to:_.value,color:"primary",variant:"tonal","prepend-icon":"mdi-information",block:"",class:"mb-2"},{default:l((()=>[c(" My Earnings ")])),_:1},8,["to"]),"pending"===e.investment.status&&e.investment.can_approve?(v(),d(w,{key:0,color:"success",variant:"tonal","prepend-icon":"mdi-check",block:"",onClick:t=>e.$emit("openApproveDialog",e.investment)},{default:l((()=>[c(" Approve ")])),_:1},8,["onClick"])):p("",!0)];n(j(w,{to:_.value,color:"primary",variant:"tonal","prepend-icon":"mdi-information",block:"",class:"mb-2"},{default:l(((e,t,n,a)=>{if(!t)return[c(" My Earnings ")];t(" My Earnings ")})),_:1},a,s)),"pending"===e.investment.status&&e.investment.can_approve?n(j(w,{color:"success",variant:"tonal","prepend-icon":"mdi-check",block:"",onClick:t=>e.$emit("openApproveDialog",e.investment)},{default:l(((e,t,n,a)=>{if(!t)return[c(" Approve ")];t(" Approve ")})),_:1},a,s)):n("\x3c!----\x3e")})),_:1},a,s))})),_:1},a,s))})),_:1},s))}}}),R=L.setup;L.setup=(e,t)=>{const n=s();return(n.modules||(n.modules=new Set)).add("components/investment/UserInvestmentCard.vue"),R?R(e,t):void 0};const z=b(L,[["__scopeId","data-v-b1130182"]]),E=r({__name:"UserInvestments",__ssrInlineRender:!0,setup(n){const{$axios:a}=C(),s=f(!0),r=f(!1),{items:o,isLoading:i,error:u,hasMore:y,refresh:b,reset:k}=B((async e=>{const t=await a.get("/api/user/investments",{params:{page:e}});return 1===e&&(s.value=!1),t.data.data}),{threshold:100,throttle:200}),refreshInfinite=async()=>{r.value=!0,k(),await b(),r.value=!1},I=f(!1),$=f(null),openApproveDialog=e=>{$.value=e,I.value=!0},onApproved=async e=>{await a.post(`/api/user/investments/${e}/approve`),await refreshInfinite()},onRejected=async(e,t)=>{await a.post(`/api/user/investments/${e}/reject`,{message:t}),await refreshInfinite()};return(n,a,u,f)=>{const b=t,k=z,C=S,D=M;a(j(e,f,{default:l(((e,t,n,a)=>{if(!t)return[m(b,{title:"My Investments",subtitle:"Projects you have invested into"},{actions:l((()=>[m(w,{color:"primary",variant:"text","prepend-icon":"mdi-refresh",loading:r.value,onClick:refreshInfinite,size:"small"},{default:l((()=>[c(" Refresh ")])),_:1},8,["loading"])])),_:1}),m("div",{class:"investments-container"},[_(i)&&s.value?(v(),d(V,{key:0,indeterminate:"",class:"mb-4"})):p("",!0),_(o).length?(v(),d(h,{key:1},[m("div",{class:"investments-grid"},[(v(!0),d(h,null,g(_(o),(e=>(v(),d(k,{key:e.id,investment:e,onOpenApproveDialog:openApproveDialog},null,8,["investment"])))),128))]),_(i)&&!s.value?(v(),d("div",{key:0,class:"text-center py-4"},[m(U,{indeterminate:"",size:"24"})])):p("",!0),_(y)?p("",!0):(v(),d("div",{key:1,class:"text-center py-4 text-body-2 text-medium-emphasis"}," No more investments to load "))],64)):_(i)?p("",!0):(v(),d(C,{key:2,title:"No Investments",message:"You haven't made any investments yet."}))]),m(D,{modelValue:I.value,"onUpdate:modelValue":e=>I.value=e,investment:$.value,onApproved:onApproved,onRejected:onRejected},null,8,["modelValue","onUpdate:modelValue","investment"])];t(j(b,{title:"My Investments",subtitle:"Projects you have invested into"},{actions:l(((e,t,n,a)=>{if(!t)return[m(w,{color:"primary",variant:"text","prepend-icon":"mdi-refresh",loading:r.value,onClick:refreshInfinite,size:"small"},{default:l((()=>[c(" Refresh ")])),_:1},8,["loading"])];t(j(w,{color:"primary",variant:"text","prepend-icon":"mdi-refresh",loading:r.value,onClick:refreshInfinite,size:"small"},{default:l(((e,t,n,a)=>{if(!t)return[c(" Refresh ")];t(" Refresh ")})),_:1},n,a))})),_:1},n,a)),t(`<div class="investments-container" data-v-e41da06f${a}>`),_(i)&&s.value?t(j(V,{indeterminate:"",class:"mb-4"},null,n,a)):t("\x3c!----\x3e"),_(o).length?(t(`\x3c!--[--\x3e<div class="investments-grid" data-v-e41da06f${a}>\x3c!--[--\x3e`),x(_(o),(e=>{t(j(k,{key:e.id,investment:e,onOpenApproveDialog:openApproveDialog},null,n,a))})),t("\x3c!--]--\x3e</div>"),_(i)&&!s.value?(t(`<div class="text-center py-4" data-v-e41da06f${a}>`),t(j(U,{indeterminate:"",size:"24"},null,n,a)),t("</div>")):t("\x3c!----\x3e"),_(y)?t("\x3c!----\x3e"):t(`<div class="text-center py-4 text-body-2 text-medium-emphasis" data-v-e41da06f${a}> No more investments to load </div>`),t("\x3c!--]--\x3e")):_(i)?t("\x3c!----\x3e"):t(j(C,{title:"No Investments",message:"You haven't made any investments yet."},null,n,a)),t("</div>"),t(j(D,{modelValue:I.value,"onUpdate:modelValue":e=>I.value=e,investment:$.value,onApproved:onApproved,onRejected:onRejected},null,n,a))})),_:1},u))}}}),T=E.setup;E.setup=(e,t)=>{const n=s();return(n.modules||(n.modules=new Set)).add("components/profile/UserInvestments.vue"),T?T(e,t):void 0};const P=b(E,[["__scopeId","data-v-e41da06f"]]);export{P as default};
