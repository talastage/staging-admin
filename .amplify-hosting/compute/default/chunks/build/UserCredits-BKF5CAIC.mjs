import{_ as e}from"./BaseCard-5i8D5k_7.mjs";import{_ as r}from"./BaseHeader-CiSkdPXW.mjs";import{_ as t}from"./ProjectGrid-D_1C43qX.mjs";import{_ as a}from"./EmptyStateCard-3UqWseqH.mjs";import{toRef as s,withCtx as o,unref as i,createVNode as n,useSSRContext as m,ref as p,computed as l,watch as u}from"vue";import{ssrRenderComponent as d}from"vue/server-renderer";import{_ as c,u as g}from"./server.mjs";import"./VCard-CsohsM82.mjs";import"./VAvatar-JL8WKjry.mjs";import"./VImg-B2jcJjnn.mjs";import"./MediaThumbnail-jyEgcC54.mjs";import"hls.js";import"./UserAvatar-DFFlBvus.mjs";import"./ProjectCardSkeleton-DMcYuKOy.mjs";import"./VSkeletonLoader-CXOx9RZQ.mjs";import"./ProjectCardCompact-C94E1iON.mjs";import"./useDateFormatter-W2Hui1rv.mjs";import"./index-8pAncyvV.mjs";import"./index-DfGQ-Pg8.mjs";import"./VContainer-By3q0af_.mjs";import"./VRow-rkX0LEXR.mjs";import"./VCol-CKxprC4g.mjs";import"node:http";import"node:https";import"node:zlib";import"node:stream";import"node:buffer";import"node:util";import"node:url";import"node:net";import"node:fs";import"node:path";import"../_/nitro.mjs";import"consola/core";import"nuxt-site-config/urls";import"ipx";import"unhead";import"vue-router";import"pinia-plugin-persistedstate";const v={__name:"UserCredits",__ssrInlineRender:!0,props:{username:{type:String,required:!0}},setup(m){const c=s(m,"username"),{projects:v,isLoading:j,hasMore:f,currentPage:C,lastPage:y,loadMoreItems:_}=function(e){const{$axios:r}=g(),t=p([]),a=p(1),s=p(1),o=p(0),i=p(!1),fetchPage=async n=>{if(!e.value)throw new Error("Username is required");try{i.value=!0;const m=(await r.get(`/api/user/${e.value}/user-project-credits`,{params:{page:n,per_page:12}})).data;t.value=1===n?m.projects||[]:[...t.value,...m.projects||[]],s.value=m.last_page||1,o.value=m.total||0,a.value=n}catch(e){throw console.error("Error fetching project credits:",e),e}finally{i.value=!1}},n=l((()=>a.value<s.value)),refresh=async()=>{t.value=[],a.value=1,s.value=1,o.value=0;try{await fetchPage(1)}catch(e){console.error("Error refreshing data:",e)}},reset=()=>{t.value=[],a.value=1,s.value=1,o.value=0,i.value=!1};return u(e,(e=>{e&&(reset(),refresh())}),{immediate:!0}),{projects:t,isLoading:i,hasMore:n,total:o,currentPage:a,lastPage:s,loadMoreItems:async()=>{if(n.value&&!i.value)try{await fetchPage(a.value+1)}catch(e){console.error("Error loading more items:",e)}},refresh:refresh,reset:reset}}(c),loadMore=()=>{f.value&&!j.value&&_()};return(s,m,p,l)=>{const u=r,c=t,g=a;m(d(e,l,{default:o(((e,r,t,a)=>{if(!r)return[n(u,{title:"My Castings"}),n("div",{class:"user-castings"},[n(c,{projects:i(v),"current-page":i(C),"last-page":i(y),"is-loading":i(j),title:"My Castings",variant:"grid",onLoadMore:loadMore},{"empty-state":o((()=>[n(g,{title:"No Castings",message:"No castings yet."})])),_:1},8,["projects","current-page","last-page","is-loading"])])];r(d(u,{title:"My Castings"},null,t,a)),r(`<div class="user-castings" data-v-732ab37d${a}>`),r(d(c,{projects:i(v),"current-page":i(C),"last-page":i(y),"is-loading":i(j),title:"My Castings",variant:"grid",onLoadMore:loadMore},{"empty-state":o(((e,r,t,a)=>{if(!r)return[n(g,{title:"No Castings",message:"No castings yet."})];r(d(g,{title:"No Castings",message:"No castings yet."},null,t,a))})),_:1},t,a)),r("</div>")})),_:1},p))}}},j=v.setup;v.setup=(e,r)=>{const t=m();return(t.modules||(t.modules=new Set)).add("components/profile/UserCredits.vue"),j?j(e,r):void 0};const f=c(v,[["__scopeId","data-v-732ab37d"]]);export{f as default};
