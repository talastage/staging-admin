import{d as t,u as e}from"./server.mjs";const a=t("talentCategories",{state:()=>({categories:[],currentCategory:null,currentPage:1,lastPage:1,isFetching:!1,error:null,searchTerm:"",hasMorePages:!1,perPage:16,total:0,talents:[],isFetchingTalents:!1,talentsError:null,hasMoreTalents:!1,currentCategorySlug:null,isFetchingCategory:!1}),getters:{hasMore:t=>t.hasMorePages&&!t.isFetching,hasMoreTalentsToLoad:t=>t.hasMoreTalents&&!t.isFetchingTalents},actions:{async fetchCategories(t=1,a=!0){if(this.isFetching)return[];this.isFetching=!0,this.error=null;try{const{$axios:s}=e(),r=await s.get("/guest/talent/categories",{params:{page:t,per_page:this.perPage}}),{data:i,meta:h}=r.data;if(a)this.categories=i;else{const t=i.filter((t=>!this.categories.some((e=>e.id===t.id))));this.categories=[...this.categories,...t]}return this.updatePaginationMeta(h),i}catch(t){return this.handleError("Failed to fetch categories. Please try again."),[]}finally{this.isFetching=!1}},async fetchCategoryTalents(t,a={},s=!1){if(!(this.isFetchingTalents||!s&&this.currentCategorySlug===t&&this.talents.length)){this.currentCategorySlug===t||s||(this.talents=[],this.currentCategorySlug=t),this.isFetchingTalents=!0,this.talentsError=null;try{const{$axios:r}=e(),i=await r.get(`/guest/talent/categories/${t}/talents`,{params:a}),{data:h,meta:n}=i.data;return this.talents=s?[...this.talents,...h]:h,this.updatePaginationMeta(n),h}catch(t){return this.handleError("Failed to fetch talents. Please try again."),[]}finally{this.isFetchingTalents=!1}}},async fetchCategoryBySlug(t){if(t){this.currentCategory=null,this.isFetchingCategory=!0,this.error=null;try{const{$axios:a}=e(),s=await a.get(`/guest/talent/categories/${t}`);this.currentCategory=s.data}catch(t){this.handleError("Failed to fetch category details. Please try again.")}finally{this.isFetchingCategory=!1}}},async loadMore(){return this.hasMore?this.fetchCategories(this.currentPage+1,!1):[]},setSearchTerm(t){this.searchTerm!==t&&(this.searchTerm=t,this.resetCategories(),this.fetchCategories())},resetCategories(){this.categories=[],this.currentPage=1,this.lastPage=1,this.hasMorePages=!1,this.error=null,this.total=0},resetTalents(){this.talents=[],this.currentPage=1,this.lastPage=1,this.hasMoreTalents=!1,this.talentsError=null,this.currentCategorySlug=null},getSingleValue:t=>Array.isArray(t)?t[0]:t,updatePaginationMeta(t){this.hasMorePages=this.getSingleValue(t.has_more_pages),this.hasMoreTalents=this.getSingleValue(t.has_more_pages),this.currentPage=this.getSingleValue(t.current_page),this.lastPage=this.getSingleValue(t.last_page),this.perPage=this.getSingleValue(t.per_page),this.total=this.getSingleValue(t.total)},handleError(t){console.error(t),this.error=t}}});export{a as u};
