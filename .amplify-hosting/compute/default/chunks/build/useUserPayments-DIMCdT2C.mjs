import{ref as e,computed as t}from"vue";import{useRoute as a}from"vue-router";import{u as r}from"./server.mjs";function useUserPayments(){const{$axios:n}=r(),c=a(),i=e([]),l=e(null),o=e(!1),s=e(null),p=e(!0),m=t((()=>["project_tip","project_watching","project_premiering"])),fetchPaymentDetail=async e=>{try{o.value=!0,s.value=null;const t=e.toString().replace("payment-",""),{data:a}=await n.get(`/api/user/payments/${t}`);a.success?l.value=a.payment:s.value="Payment not found"}catch(e){console.error("Error fetching payment details:",e),s.value="Unable to fetch payment details. Please try again later.",l.value=null}finally{o.value=!1}};return{payments:i,currentPayment:l,loading:o,error:s,hasMore:p,fetchPayments:async(e=1)=>{try{o.value=!0;const{data:t}=await n.get("/api/user/payments",{params:{page:e}});i.value=1===e?t.payments.data:[...i.value,...t.payments.data],p.value=e<t.meta.last_page,s.value=null}catch(e){console.error("Error fetching payments:",e),s.value="Unable to fetch payment history. Please try again later.",p.value=!1}finally{o.value=!1}},fetchPaymentDetail:fetchPaymentDetail,initPaymentDetail:()=>{c.params.reference&&fetchPaymentDetail(c.params.reference.toString())},getStatusColor:e=>({pending:"warning",processing:"info",completed:"success",failed:"error",cancelled:"error",refunded:"error"}[e]||"grey"),getStatusIcon:e=>({pending:"mdi-clock-outline",processing:"mdi-progress-clock",completed:"mdi-check-circle",failed:"mdi-alert-circle",cancelled:"mdi-cancel",refunded:"mdi-cash-refund"}[e]||"mdi-help-circle"),getPaymentTypeTitle:e=>({tip:"Tip Payment",project_tip:"Project Tip",project_watching:"Project Purchase",project_premiering:"Project Premiere"}[e]||"Payment"),getRecipientTitle:e=>({tip:"Tipped User",project_tip:"Tipped Project",project_watching:"Purchased Projects",project_premiering:"Premiering Projects"}[e]||"Details"),formatStatus:e=>e.charAt(0).toUpperCase()+e.slice(1),projectPaymentTypes:m}}export{useUserPayments as u};
