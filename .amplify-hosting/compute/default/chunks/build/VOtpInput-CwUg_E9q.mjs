import{computed as e,ref as l,watch as a,nextTick as t,createVNode as u,mergeProps as o,Fragment as n}from"vue";import{m as r,V as i}from"./VField-ZM6yOiXp.mjs";import{V as s}from"./VOverlay-ZKavbTei.mjs";import{p as v,r as d,ab as p,h as c,F as m,a2 as f,a7 as y,l as b,j as g,ac as h,U as V,a1 as k}from"./server.mjs";import{b as A,u as S}from"./VInput-DRJS2l97.mjs";const j=v({autofocus:Boolean,divider:String,focusAll:Boolean,label:{type:String,default:"$vuetify.input.otp"},length:{type:[Number,String],default:6},modelValue:{type:[Number,String],default:void 0},placeholder:String,type:{type:String,default:"number"},...d(),...A(),...p(r({variant:"outlined"}),["baseColor","bgColor","class","color","disabled","error","loading","rounded","style","theme","variant"])},"VOtpInput"),w=c()({name:"VOtpInput",props:j(),emits:{finish:e=>!0,"update:focused":e=>!0,"update:modelValue":e=>!0},setup(r,v){let{attrs:d,emit:p,slots:c}=v;const{dimensionStyles:A}=m(r),{isFocused:j,focus:w,blur:B}=S(r),F=f(r,"modelValue","",(e=>String(e).split("")),(e=>e.join(""))),{t:_}=y(),x=e((()=>Number(r.length))),D=e((()=>Array(x.value).fill(0))),I=l(-1),C=l(),K=l([]),O=e((()=>K.value[I.value]));function onInput(){if("number"===r.type&&/[^0-9]/g.test(O.value.value))return void(O.value.value="");const e=F.value.slice(),l=O.value.value;e[I.value]=l;let a=null;I.value>F.value.length?a=F.value.length+1:I.value+1!==x.value&&(a="next"),F.value=e,a&&k(C.value,a)}function onKeydown(e){const l=F.value.slice(),a=I.value;let t=null;["ArrowLeft","ArrowRight","Backspace","Delete"].includes(e.key)&&(e.preventDefault(),"ArrowLeft"===e.key?t="prev":"ArrowRight"===e.key?t="next":["Backspace","Delete"].includes(e.key)&&(l[I.value]="",F.value=l,I.value>0&&"Backspace"===e.key?t="prev":requestAnimationFrame((()=>{var e;null==(e=K.value[a])||e.select()}))),requestAnimationFrame((()=>{null!=t&&k(C.value,t)})))}function onBlur(){B(),I.value=-1}return b({VField:{color:e((()=>r.color)),bgColor:e((()=>r.color)),baseColor:e((()=>r.baseColor)),disabled:e((()=>r.disabled)),error:e((()=>r.error)),variant:e((()=>r.variant))}},{scoped:!0}),a(F,(e=>{e.length===x.value&&p("finish",e.join(""))}),{deep:!0}),a(I,(e=>{e<0||t((()=>{var l;null==(l=K.value[e])||l.select()}))})),g((()=>{var e;const[l,a]=h(d);return u("div",o({class:["v-otp-input",{"v-otp-input--divided":!!r.divider},r.class],style:[r.style]},l),[u("div",{ref:C,class:"v-otp-input__content",style:[A.value]},[D.value.map(((e,l)=>u(n,null,[r.divider&&0!==l&&u("span",{class:"v-otp-input__divider"},[r.divider]),u(i,{focused:j.value&&r.focusAll||I.value===l,key:l},{...c,default:()=>u("input",{ref:e=>K.value[l]=e,"aria-label":_(r.label,l+1),autofocus:0===l&&r.autofocus,autocomplete:"one-time-code",class:["v-otp-input__field"],disabled:r.disabled,inputmode:"number"===r.type?"numeric":"text",min:"number"===r.type?0:void 0,maxlength:"1",placeholder:r.placeholder,type:"number"===r.type?"text":r.type,value:F.value[l],onInput:onInput,onFocus:e=>{return a=l,w(),void(I.value=a);var a},onBlur:onBlur,onKeydown:onKeydown,onPaste:e=>function(e,l){var a,t,u;l.preventDefault(),l.stopPropagation(),F.value=(null!=(a=null==(t=null==l?void 0:l.clipboardData)?void 0:t.getData("Text"))?a:"").split(""),null==(u=K.value)||u[e].blur()}(l,e)},null)})]))),u("input",o({class:"v-otp-input-input",type:"hidden"},a,{value:F.value.join("")}),null),u(s,{contained:!0,"content-class":"v-otp-input__loader","model-value":!!r.loading,persistent:!0},{default:()=>{var e,l;return[null!=(e=null==(l=c.loader)?void 0:l.call(c))?e:u(V,{color:"boolean"==typeof r.loading?void 0:r.loading,indeterminate:!0,size:"24",width:"2"},null)]}}),null==(e=c.default)?void 0:e.call(c)])])})),{blur:()=>{var e;null==(e=K.value)||e.some((e=>e.blur()))},focus:()=>{var e;null==(e=K.value)||e[0].focus()},reset:function(){F.value=[]},isFocused:j}}});export{w as V};
