import{bc as r,a as e,bd as o,aA as t,be as i}from"./server.mjs";import{u as s}from"./useProjectStore-ICfMYGpe.mjs";import"vue";import"node:http";import"node:https";import"node:zlib";import"node:stream";import"node:buffer";import"node:util";import"node:url";import"node:net";import"node:fs";import"node:path";import"../_/nitro.mjs";import"consola/core";import"nuxt-site-config/urls";import"ipx";import"unhead";import"vue-router";import"pinia-plugin-persistedstate";import"vue/server-renderer";const a=r((async r=>{var a,n,u,c,p,d;let m,l;const v=s(),f=e(),h=`project_creator_${r.params.access_uuid}`;try{if(!(null==(a=f.user)?void 0:a.value))try{[m,l]=o((()=>f.fetchUser())),await m,l()}catch(r){return console.error("Authentication error:",r),t("/login")}const e=i(h,"$yxfnoHWCWn");if(void 0!==e.value)return e.value?void 0:t("/404");let s=v.currentProject;if(s&&s.access_uuid===r.params.access_uuid||([m,l]=o((()=>v.fetchProject(r.params.access_uuid))),m=await m,l(),s=m),!s)throw new Error("Project not found");const p=(null==(n=s.creator)?void 0:n.id)===(null==(c=null==(u=f.user)?void 0:u.value)?void 0:c.id);if(i(h,(()=>p)),!p)return t("/404")}catch(e){return console.error("Project creator check error:",{error:e,access_uuid:r.params.access_uuid,user:null==(d=null==(p=f.user)?void 0:p.value)?void 0:d.id}),e instanceof Response&&401===e.status?t("/login"):t("/404")}}));export{a as default};
