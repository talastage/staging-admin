import{_ as e}from"./BaseCard-5i8D5k_7.mjs";import{_ as a}from"./BaseHeader-CiSkdPXW.mjs";import{_ as n}from"./UserTalentCard-DkmnZIe8.mjs";import{_ as l}from"./FanButton-B8LLympe.mjs";import{_ as t}from"./UserTalentSkeleton-CTIt9ofy.mjs";import{_ as s}from"./NoContentFound-CUaHAUXR.mjs";import{useSSRContext as r,defineComponent as i,ref as u,computed as o,watch as v,withCtx as m,createVNode as d,createTextVNode as p,toDisplayString as f,openBlock as c,createBlock as g,Fragment as y,renderList as _,createCommentVNode as k,withDirectives as x,vShow as h}from"vue";import{ssrRenderComponent as j,ssrRenderList as U,ssrRenderStyle as b,ssrInterpolate as F}from"vue/server-renderer";import{u as C}from"./index-8pAncyvV.mjs";import{_ as V,U as $,u as w}from"./server.mjs";import{V as z}from"./VContainer-By3q0af_.mjs";import{V as B}from"./VAlert-DneVUU3Q.mjs";import"./VCard-CsohsM82.mjs";import"./VAvatar-JL8WKjry.mjs";import"./VImg-B2jcJjnn.mjs";import"./nuxt-link-CU98Qcmd.mjs";import"./VOverlay-ZKavbTei.mjs";import"./easing-Bn3h-KUg.mjs";import"./VSkeletonLoader-CXOx9RZQ.mjs";import"./index-DfGQ-Pg8.mjs";import"node:http";import"node:https";import"node:zlib";import"node:stream";import"node:buffer";import"node:util";import"node:url";import"node:net";import"node:fs";import"node:path";import"../_/nitro.mjs";import"consola/core";import"nuxt-site-config/urls";import"ipx";import"unhead";import"vue-router";import"pinia-plugin-persistedstate";const D=i({__name:"UserFans",__ssrInlineRender:!0,props:{username:{}},setup(r){const i=r,V=u([]),D=u(!0),I=u(!1),T=u(null),N=u(null),A=u(1),L=u(1),Q=u(null),S=u(!1),K=o((()=>"medium")),P=o((()=>L.value<A.value));o((()=>!Q.value||Date.now()-Q.value>3e5));const R=o((()=>D.value||0!==V.value.length?"Followers":"No followers yet.")),fetchFans=async(e=!1)=>{if(e)D.value=!0,L.value=1,V.value=[];else{if(I.value||!P.value)return;I.value=!0}try{const{$axios:a}=w(),n=await a.get(`/api/fans/${i.username}/fans`,{params:{page:L.value,per_page:12}}),{fans:l,pagination:t}=n.data;V.value=e?l:[...V.value,...l],A.value=t.last_page,L.value++,Q.value=Date.now(),S.value=!0}catch(e){T.value="Failed to fetch fans. Please try again later.",console.error("Error fetching fans:",e)}finally{D.value=!1,I.value=!1}},handleFanningUpdate=(e,a)=>{const n=V.value.find((a=>a.id===e));n&&(n.is_fanned_by_auth_user=a)};return C(N,(([{isIntersecting:e}])=>{e&&!D.value&&P.value&&!I.value&&fetchFans(!1)}),{threshold:.1}),v((()=>i.username),((e,a)=>{e!==a&&(V.value=[],L.value=1,A.value=1,T.value=null,Q.value=null,S.value=!1,fetchFans(!0))})),(r,i,u,o)=>{const v=a,C=n,w=l,A=t,L=s;i(j(e,o,{default:m(((e,a,n,l)=>{if(!a)return[d("div",{class:"user-fans"},[d(v,{title:R.value},null,8,["title"]),d(z,{fluid:"",class:"pa-0"},{default:m((()=>[!D.value&&V.value.length>0?(c(),g("div",{key:0,class:"fans-grid"},[(c(!0),g(y,null,_(V.value,(e=>(c(),g(C,{key:e.id,user:e,size:K.value},{action:m((()=>[d(w,{username:e.username,"initial-fanning-state":e.is_fanned_by_auth_user,onFanningUpdated:a=>handleFanningUpdate(e.id,a)},null,8,["username","initial-fanning-state","onFanningUpdated"])])),_:2},1032,["user","size"])))),128))])):k("",!0),D.value?(c(),g("div",{key:1,class:"fans-grid"},[(c(),g(y,null,_(6,(e=>d(A,{key:"skeleton-"+e}))),64))])):k("",!0),x(d("div",{ref_key:"scrollTrigger",ref:N,class:"scroll-trigger"},[I.value?(c(),g("div",{key:0,class:"fans-grid mt-4"},[(c(),g(y,null,_(6,(e=>d(A,{key:"skeleton-more-"+e}))),64))])):k("",!0),I.value?(c(),g("div",{key:1,class:"text-center mt-4"},[d($,{indeterminate:"",color:"primary",size:"24"})])):k("",!0)],512),[[h,!D.value&&P.value]]),D.value||0!==V.value.length?k("",!0):(c(),g(L,{key:2,message:"No followers yet!"})),T.value?(c(),g(B,{key:3,type:"error",variant:"tonal",class:"mt-4"},{default:m((()=>[p(f(T.value),1)])),_:1})):k("",!0)])),_:1})])];a(`<div class="user-fans" data-v-6b721530${l}>`),a(j(v,{title:R.value},null,n,l)),a(j(z,{fluid:"",class:"pa-0"},{default:m(((e,a,n,l)=>{if(!a)return[!D.value&&V.value.length>0?(c(),g("div",{key:0,class:"fans-grid"},[(c(!0),g(y,null,_(V.value,(e=>(c(),g(C,{key:e.id,user:e,size:K.value},{action:m((()=>[d(w,{username:e.username,"initial-fanning-state":e.is_fanned_by_auth_user,onFanningUpdated:a=>handleFanningUpdate(e.id,a)},null,8,["username","initial-fanning-state","onFanningUpdated"])])),_:2},1032,["user","size"])))),128))])):k("",!0),D.value?(c(),g("div",{key:1,class:"fans-grid"},[(c(),g(y,null,_(6,(e=>d(A,{key:"skeleton-"+e}))),64))])):k("",!0),x(d("div",{ref_key:"scrollTrigger",ref:N,class:"scroll-trigger"},[I.value?(c(),g("div",{key:0,class:"fans-grid mt-4"},[(c(),g(y,null,_(6,(e=>d(A,{key:"skeleton-more-"+e}))),64))])):k("",!0),I.value?(c(),g("div",{key:1,class:"text-center mt-4"},[d($,{indeterminate:"",color:"primary",size:"24"})])):k("",!0)],512),[[h,!D.value&&P.value]]),D.value||0!==V.value.length?k("",!0):(c(),g(L,{key:2,message:"No followers yet!"})),T.value?(c(),g(B,{key:3,type:"error",variant:"tonal",class:"mt-4"},{default:m((()=>[p(f(T.value),1)])),_:1})):k("",!0)];!D.value&&V.value.length>0?(a(`<div class="fans-grid" data-v-6b721530${l}>\x3c!--[--\x3e`),U(V.value,(e=>{a(j(C,{key:e.id,user:e,size:K.value},{action:m(((a,n,l,t)=>{if(!n)return[d(w,{username:e.username,"initial-fanning-state":e.is_fanned_by_auth_user,onFanningUpdated:a=>handleFanningUpdate(e.id,a)},null,8,["username","initial-fanning-state","onFanningUpdated"])];n(j(w,{username:e.username,"initial-fanning-state":e.is_fanned_by_auth_user,onFanningUpdated:a=>handleFanningUpdate(e.id,a)},null,l,t))})),_:2},n,l))})),a("\x3c!--]--\x3e</div>")):a("\x3c!----\x3e"),D.value?(a(`<div class="fans-grid" data-v-6b721530${l}>\x3c!--[--\x3e`),U(6,(e=>{a(j(A,{key:"skeleton-"+e},null,n,l))})),a("\x3c!--]--\x3e</div>")):a("\x3c!----\x3e"),a(`<div style="${b(!D.value&&P.value?null:{display:"none"})}" class="scroll-trigger" data-v-6b721530${l}>`),I.value?(a(`<div class="fans-grid mt-4" data-v-6b721530${l}>\x3c!--[--\x3e`),U(6,(e=>{a(j(A,{key:"skeleton-more-"+e},null,n,l))})),a("\x3c!--]--\x3e</div>")):a("\x3c!----\x3e"),I.value?(a(`<div class="text-center mt-4" data-v-6b721530${l}>`),a(j($,{indeterminate:"",color:"primary",size:"24"},null,n,l)),a("</div>")):a("\x3c!----\x3e"),a("</div>"),D.value||0!==V.value.length?a("\x3c!----\x3e"):a(j(L,{message:"No followers yet!"},null,n,l)),T.value?a(j(B,{type:"error",variant:"tonal",class:"mt-4"},{default:m(((e,a,n,l)=>{if(!a)return[p(f(T.value),1)];a(`${F(T.value)}`)})),_:1},n,l)):a("\x3c!----\x3e")})),_:1},n,l)),a("</div>")})),_:1},u))}}}),I=D.setup;D.setup=(e,a)=>{const n=r();return(n.modules||(n.modules=new Set)).add("components/profile/UserFans.vue"),I?I(e,a):void 0};const T=V(D,[["__scopeId","data-v-6b721530"]]);export{T as default};
