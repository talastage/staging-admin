import{ref as e,computed as t,unref as l,watchEffect as n}from"vue";import{p as o,aF as i,Z as r}from"./server.mjs";const defaultFilter=(e,t,l)=>null==e||null==t?-1:e.toString().toLocaleLowerCase().indexOf(t.toString().toLocaleLowerCase()),u=o({customFilter:Function,customKeyFilter:Object,filterKeys:[Array,String],filterMode:{type:String,default:"intersection"},noFilter:Boolean},"filter");function useFilter(o,u,s,c){const f=e([]),a=e(new Map),d=t((()=>l(u)));return n((()=>{const e="function"==typeof s?s():l(s),t="string"!=typeof e&&"number"!=typeof e?"":String(e),n=function(e,t,l){var n,o,u;const s=[],c=null!=(n=null==l?void 0:l.default)?n:defaultFilter,f=!!(null==l?void 0:l.filterKeys)&&i(l.filterKeys),a=Object.keys(null!=(o=null==l?void 0:l.customKeyFilter)?o:{}).length;if(!(null==e?void 0:e.length))return s;e:for(let n=0;n<e.length;n++){const[o,d=o]=i(e[n]),v={},y={};let m=-1;if(t&&!(null==l?void 0:l.noFilter)){if("object"==typeof o){const e=f||Object.keys(d);for(const n of e){const e=r(d,n,d),i=null==(u=null==l?void 0:l.customKeyFilter)?void 0:u[n];if(m=i?i(e,t,o):c(e,t,o),-1!==m&&!1!==m)i?v[n]=m:y[n]=m;else if("every"===(null==l?void 0:l.filterMode))continue e}}else m=c(o,t,o),-1!==m&&!1!==m&&(y.title=m);const e=Object.keys(y).length,n=Object.keys(v).length;if(!e&&!n)continue;if("union"===(null==l?void 0:l.filterMode)&&n!==a&&!e)continue;if("intersection"===(null==l?void 0:l.filterMode)&&(n!==a||!e))continue}s.push({index:n,matches:{...y,...v}})}return s}(d.value,t,{customKeyFilter:{...o.customKeyFilter,...l(void 0)},default:o.customFilter,filterKeys:o.filterKeys,filterMode:o.filterMode,noFilter:o.noFilter}),c=l(u),v=[],y=new Map;n.forEach((e=>{let{index:t,matches:l}=e;const n=c[t];v.push(n),y.set(n.value,l)})),f.value=v,a.value=y})),{filteredItems:f,filteredMatches:a,getMatches:function(e){return a.value.get(e.value)}}}export{u as m,useFilter as u};
