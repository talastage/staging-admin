import{_ as e}from"./BaseCard-5i8D5k_7.mjs";import{_ as a}from"./BaseHeader-CiSkdPXW.mjs";import{_ as n}from"./UserTalentCard-DkmnZIe8.mjs";import{_ as t}from"./FanButton-B8LLympe.mjs";import{_ as l}from"./UserTalentSkeleton-CTIt9ofy.mjs";import{_ as i}from"./NoContentFound-CUaHAUXR.mjs";import{useSSRContext as r,defineComponent as o,ref as s,computed as u,watch as d,withCtx as v,createVNode as m,createTextVNode as p,toDisplayString as g,openBlock as c,createBlock as f,Fragment as y,renderList as _,createCommentVNode as x}from"vue";import{ssrRenderComponent as k,ssrRenderList as h,ssrInterpolate as w}from"vue/server-renderer";import{u as j}from"./index-8pAncyvV.mjs";import{_ as U,U as b,u as F}from"./server.mjs";import{V as P}from"./VContainer-By3q0af_.mjs";import{V as C}from"./VAlert-DneVUU3Q.mjs";import"./VCard-CsohsM82.mjs";import"./VAvatar-JL8WKjry.mjs";import"./VImg-B2jcJjnn.mjs";import"./nuxt-link-CU98Qcmd.mjs";import"./VOverlay-ZKavbTei.mjs";import"./easing-Bn3h-KUg.mjs";import"./VSkeletonLoader-CXOx9RZQ.mjs";import"./index-DfGQ-Pg8.mjs";import"node:http";import"node:https";import"node:zlib";import"node:stream";import"node:buffer";import"node:util";import"node:url";import"node:net";import"node:fs";import"node:path";import"../_/nitro.mjs";import"consola/core";import"nuxt-site-config/urls";import"ipx";import"unhead";import"vue-router";import"pinia-plugin-persistedstate";const V=o({__name:"UserFanning",__ssrInlineRender:!0,props:{username:{}},setup(r){const o=r,U=s([]),V=s(!0),z=s(!1),D=s(null),$=s(null),B=s(null),I=s(!1),T=s({currentPage:1,lastPage:1,total:0,perPage:12}),A=u((()=>T.value.currentPage<=T.value.lastPage)),Y=u((()=>"medium")),L=u((()=>V.value||0!==U.value.length?"Following":"You Havenâ€™t Followed Anyone Yet"));u((()=>!B.value||Date.now()-B.value>3e5));const fetchFanning=async(e=!1)=>{if(e)V.value=!0,T.value.currentPage=1,U.value=[];else{if(z.value||!A.value)return;z.value=!0}D.value=null;const{$axios:a}=F();try{const n=await a.get(`/api/fans/${o.username}/fanning`,{params:{page:T.value.currentPage,per_page:T.value.perPage}}),t=n.data.fanning;U.value=e?t:[...U.value,...t],T.value={currentPage:n.data.pagination.current_page+1,lastPage:n.data.pagination.last_page,total:n.data.pagination.total,perPage:n.data.pagination.per_page},B.value=Date.now(),I.value=!0}catch(e){D.value="Failed to fetch following users. Please try again later.",console.error("Error fetching following:",e)}finally{e?V.value=!1:z.value=!1}},handleFanningUpdate=(e,a)=>{const n=U.value.findIndex((a=>a.id===e));-1!==n&&(U.value[n].is_fanned_by_auth_user=a)};return j($,(([{isIntersecting:e}])=>{e&&!V.value&&A.value&&!z.value&&fetchFanning(!1)}),{threshold:.1}),d((()=>o.username),(()=>{fetchFanning(!0)})),(r,o,s,u)=>{const d=a,j=n,F=t,B=l,I=i;o(k(e,u,{default:v(((e,a,n,t)=>{if(!a)return[m("div",{class:"user-fanning"},[m(d,{title:L.value},null,8,["title"]),m(P,{fluid:"",class:"pa-0"},{default:v((()=>[!V.value&&U.value.length>0?(c(),f("div",{key:0,class:"following-grid"},[(c(!0),f(y,null,_(U.value,(e=>(c(),f(j,{key:e.id,user:e,size:Y.value},{action:v((()=>[m(F,{username:e.username,"initial-fanning-state":e.is_fanned_by_auth_user,onFanningUpdated:a=>handleFanningUpdate(e.id,a)},null,8,["username","initial-fanning-state","onFanningUpdated"])])),_:2},1032,["user","size"])))),128))])):x("",!0),V.value?(c(),f("div",{key:1,class:"following-grid"},[(c(),f(y,null,_(6,(e=>m(B,{key:"skeleton-"+e}))),64))])):x("",!0),!V.value&&A.value?(c(),f("div",{key:2,ref_key:"loadMoreTrigger",ref:$,class:"scroll-trigger"},[z.value?(c(),f("div",{key:0,class:"following-grid mt-4"},[(c(),f(y,null,_(6,(e=>m(B,{key:"skeleton-more-"+e}))),64))])):x("",!0),z.value?(c(),f("div",{key:1,class:"text-center mt-4"},[m(b,{indeterminate:"",color:"primary",size:"24"})])):x("",!0)],512)):x("",!0),V.value||0!==U.value.length?x("",!0):(c(),f(I,{key:3,message:"You haven't followed anyone yet! Discover new people to connect with and follow their updates."})),D.value?(c(),f(C,{key:4,type:"error",variant:"tonal",class:"mt-4"},{default:v((()=>[p(g(D.value),1)])),_:1})):x("",!0)])),_:1})])];a(`<div class="user-fanning" data-v-698b9a03${t}>`),a(k(d,{title:L.value},null,n,t)),a(k(P,{fluid:"",class:"pa-0"},{default:v(((e,a,n,t)=>{if(!a)return[!V.value&&U.value.length>0?(c(),f("div",{key:0,class:"following-grid"},[(c(!0),f(y,null,_(U.value,(e=>(c(),f(j,{key:e.id,user:e,size:Y.value},{action:v((()=>[m(F,{username:e.username,"initial-fanning-state":e.is_fanned_by_auth_user,onFanningUpdated:a=>handleFanningUpdate(e.id,a)},null,8,["username","initial-fanning-state","onFanningUpdated"])])),_:2},1032,["user","size"])))),128))])):x("",!0),V.value?(c(),f("div",{key:1,class:"following-grid"},[(c(),f(y,null,_(6,(e=>m(B,{key:"skeleton-"+e}))),64))])):x("",!0),!V.value&&A.value?(c(),f("div",{key:2,ref_key:"loadMoreTrigger",ref:$,class:"scroll-trigger"},[z.value?(c(),f("div",{key:0,class:"following-grid mt-4"},[(c(),f(y,null,_(6,(e=>m(B,{key:"skeleton-more-"+e}))),64))])):x("",!0),z.value?(c(),f("div",{key:1,class:"text-center mt-4"},[m(b,{indeterminate:"",color:"primary",size:"24"})])):x("",!0)],512)):x("",!0),V.value||0!==U.value.length?x("",!0):(c(),f(I,{key:3,message:"You haven't followed anyone yet! Discover new people to connect with and follow their updates."})),D.value?(c(),f(C,{key:4,type:"error",variant:"tonal",class:"mt-4"},{default:v((()=>[p(g(D.value),1)])),_:1})):x("",!0)];!V.value&&U.value.length>0?(a(`<div class="following-grid" data-v-698b9a03${t}>\x3c!--[--\x3e`),h(U.value,(e=>{a(k(j,{key:e.id,user:e,size:Y.value},{action:v(((a,n,t,l)=>{if(!n)return[m(F,{username:e.username,"initial-fanning-state":e.is_fanned_by_auth_user,onFanningUpdated:a=>handleFanningUpdate(e.id,a)},null,8,["username","initial-fanning-state","onFanningUpdated"])];n(k(F,{username:e.username,"initial-fanning-state":e.is_fanned_by_auth_user,onFanningUpdated:a=>handleFanningUpdate(e.id,a)},null,t,l))})),_:2},n,t))})),a("\x3c!--]--\x3e</div>")):a("\x3c!----\x3e"),V.value?(a(`<div class="following-grid" data-v-698b9a03${t}>\x3c!--[--\x3e`),h(6,(e=>{a(k(B,{key:"skeleton-"+e},null,n,t))})),a("\x3c!--]--\x3e</div>")):a("\x3c!----\x3e"),!V.value&&A.value?(a(`<div class="scroll-trigger" data-v-698b9a03${t}>`),z.value?(a(`<div class="following-grid mt-4" data-v-698b9a03${t}>\x3c!--[--\x3e`),h(6,(e=>{a(k(B,{key:"skeleton-more-"+e},null,n,t))})),a("\x3c!--]--\x3e</div>")):a("\x3c!----\x3e"),z.value?(a(`<div class="text-center mt-4" data-v-698b9a03${t}>`),a(k(b,{indeterminate:"",color:"primary",size:"24"},null,n,t)),a("</div>")):a("\x3c!----\x3e"),a("</div>")):a("\x3c!----\x3e"),V.value||0!==U.value.length?a("\x3c!----\x3e"):a(k(I,{message:"You haven't followed anyone yet! Discover new people to connect with and follow their updates."},null,n,t)),D.value?a(k(C,{type:"error",variant:"tonal",class:"mt-4"},{default:v(((e,a,n,t)=>{if(!a)return[p(g(D.value),1)];a(`${w(D.value)}`)})),_:1},n,t)):a("\x3c!----\x3e")})),_:1},n,t)),a("</div>")})),_:1},s))}}}),z=V.setup;V.setup=(e,a)=>{const n=r();return(n.modules||(n.modules=new Set)).add("components/profile/UserFanning.vue"),z?z(e,a):void 0};const D=U(V,[["__scopeId","data-v-698b9a03"]]);export{D as default};
