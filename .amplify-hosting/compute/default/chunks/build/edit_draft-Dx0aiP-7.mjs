import{_ as e}from"./PremieringProjectSettings-CkVWizCB.mjs";import{_ as t,a as r}from"./PremieringProjectSteppers-DtGl1Hzy.mjs";import{useSSRContext as o,defineComponent as a,ref as i,computed as m,mergeProps as s,withCtx as l,unref as n,createVNode as p,openBlock as u,createBlock as d,createCommentVNode as c,Fragment as j}from"vue";import{ssrRenderComponent as v}from"vue/server-renderer";import{useRoute as f,useRouter as g}from"vue-router";import{u as y}from"./useWalletStatus-D0U60UmT.mjs";import{u as V}from"./usePremieringMediaUpload-Pb41DpBw.mjs";import{u as P}from"./useWalletStore-C5It8oQZ.mjs";import{u as h}from"./useSnackMessage-PVLwAm7x.mjs";import{u as D}from"./useApps-hYo13Xt3.mjs";import{u as C}from"./useSeo-Dl9beXFt.mjs";import{_ as B,u as _}from"./server.mjs";import{V as F}from"./VContainer-By3q0af_.mjs";import{V as S}from"./VSkeletonLoader-CXOx9RZQ.mjs";import{V as b,a as U}from"./VCard-CsohsM82.mjs";import"./VMenu-BpdBiT5v.mjs";import"./VOverlay-ZKavbTei.mjs";import"./easing-Bn3h-KUg.mjs";import"./VImg-B2jcJjnn.mjs";import"./forwardRefs-BSTjJZPU.mjs";import"./dialog-transition-BU2TTOTj.mjs";import"./VTextField-rd-VvEF8.mjs";import"./VCounter-BZE6l8kb.mjs";import"./index--K8ZrFMm.mjs";import"./VField-ZM6yOiXp.mjs";import"./VInput-DRJS2l97.mjs";import"./VSelect-BWLkvD3S.mjs";import"./VList-CcwwrkQR.mjs";import"./VListItem-jTLuICGb.mjs";import"./VAvatar-JL8WKjry.mjs";import"./ssrBoot-BtvJZs44.mjs";import"./VDivider-BmyMVZMt.mjs";import"./VCheckboxBtn-v4ZZzD80.mjs";import"./VSelectionControl-BvLhSUlq.mjs";import"./VChip-f_o2BAA4.mjs";import"./VSpacer-_gFExeVk.mjs";import"@vuepic/vue-datepicker";import"./BaseDialog-DsGYlnLZ.mjs";import"./VDialog-DA9BdIfh.mjs";import"./BaseButton-BTGPFNw4.mjs";import"./AlertMessage-Do7IDlzi.mjs";import"./WalletStatusAlert-C7EXzF41.mjs";import"./VRow-rkX0LEXR.mjs";import"./VCol-CKxprC4g.mjs";import"./VRadioGroup-DcyDhdKu.mjs";import"./VTabs-t8Cp0Axr.mjs";import"./VWindowItem-DjFGFGcX.mjs";import"./PremieringProjectDetail-NBIIUvO8.mjs";import"./BaseCard-5i8D5k_7.mjs";import"./BaseTitle-CB_md7-d.mjs";import"vue-toastification";import"./index-DfGQ-Pg8.mjs";import"./VAlert-DneVUU3Q.mjs";import"./VForm-HRC00ryg.mjs";import"vue-cropperjs";import"./VToolbar-8wIfw3zK.mjs";import"hls.js";import"./useVaporUpload-BcV2ypUE.mjs";import"./VTextarea-DkPaPTLI.mjs";import"./AddProjectInvestors-4WgTDslN.mjs";import"./BaseHeader-CiSkdPXW.mjs";import"./EmptyStateCard-3UqWseqH.mjs";import"./PageAvatar-YzVemsBd.mjs";import"../_/nitro.mjs";import"node:http";import"node:https";import"node:fs";import"node:url";import"consola/core";import"nuxt-site-config/urls";import"ipx";import"node:path";import"./UserAvatar-DFFlBvus.mjs";import"./StatusBadge-s-9yaW6G.mjs";import"./useDebounce-MF5_aaOF.mjs";import"./VAutocomplete-BqaBgOKW.mjs";import"./filter-BWdoXH_J.mjs";import"./VSnackbar-zBX8NfdO.mjs";import"./ConfirmDeleteDialog-Bb7O4z7X.mjs";import"./useInfiniteScroll-CumoSAIu.mjs";import"./VTooltip-CE0EmfBU.mjs";import"./AddProjectCredits-BZTs-XFv.mjs";import"./ProjectCreditGrid-ClNP8uGo.mjs";import"./nuxt-link-CU98Qcmd.mjs";import"./TipButton-DzVv7844.mjs";import"./TipDialog-DeBBt-gS.mjs";import"./UserCard-DhDpEloc.mjs";import"./MediaThumbnail-jyEgcC54.mjs";import"./useDateFormatter-W2Hui1rv.mjs";import"./useCurrencies-Dkc4Yzgg.mjs";import"./useCurrencyFormatter-Dfs2ioxk.mjs";import"./SearchUser-DlNWcghk.mjs";import"lodash/debounce.js";import"./useTalentCategories-DQov3s2P.mjs";import"./VCombobox-CR2vKudT.mjs";import"./VStepper-CbeSoOmZ.mjs";import"./VSheet-CDtLFCXf.mjs";import"./useTimeFormatting-BygSFjON.mjs";import"./usePusher-CX6o09md.mjs";import"util";import"crypto";import"stream";import"url";import"buffer";import"events";import"assert";import"net";import"tls";import"child_process";import"fs";import"http";import"https";import"./interval-gl53xdpR.mjs";import"axios";import"node:zlib";import"node:stream";import"node:buffer";import"node:util";import"node:net";import"unhead";import"pinia-plugin-persistedstate";const T=a({__name:"edit_draft",__ssrInlineRender:!0,setup(o){const a=f(),B=g();_();const T=h(),x=y(),E=V(),I=P(),k=D(),A=i(!0),W=i(1),w=i(!1),z=i(""),q=m((()=>{var e,t,r,o;return{amount:(null==(t=null==(e=x.requirements)?void 0:e.premiering_fee)?void 0:t.amount)||0,currency:(null==(o=null==(r=x.requirements)?void 0:r.premiering_fee)?void 0:o.currency)||{id:0,code:"",name:"",symbol:""}}})),O=m((()=>{var e;return""!==(null==(e=q.value.currency)?void 0:e.code)})),$=m((()=>{var e;return`Premiering Payment - ${(null==(e=E.project)?void 0:e.name)||"Project"}`})),R=m((()=>E.error)),M=m((()=>a.params.access_uuid)),X=m((()=>{var e;return(null==(e=k.talastageApp)?void 0:e.name)||"TalaStage"}));function finish(){T.success("Project setup completed!"),B.push("/studio/projects/manage-projects")}function handlePaymentDialog(e){var t;"completed"!==(null==(t=E.project)?void 0:t.payment_status)&&(z.value="CURRENCY_MISMATCH"===e.code?"Currency Mismatch":"INSUFFICIENT_FUNDS"===e.code?"Insufficient Funds: Unable to charge your wallet":$.value,T.warning(e.message),w.value=!0)}function handlePaymentFailedEvent(){var e;"completed"!==(null==(e=E.project)?void 0:e.payment_status)&&(z.value=$.value,w.value=!0,T.error("Payment failed. Please try again."))}!function(e){const t=P(),r=m((()=>{var r;if(!e.value||!e.value.currency||!e.value.currency.code)return"loading";if(t.isFetching||!t.wallet)return"loading";if(!t.isWalletActive)return"error";const o=null==(r=t.wallet.data.currency.code)?void 0:r.trim().toUpperCase(),a=e.value.currency.code.trim().toUpperCase();return o&&a?o!==a?"currencyMismatch":parseFloat(t.wallet.data.balance)>=e.value.amount?"sufficient":"insufficient":"loading"})),o=m((()=>"sufficient"===r.value)),a=m((()=>"currencyMismatch"===r.value||"loading"===r.value||"error"===r.value?0:parseFloat(t.wallet.data.balance)-e.value.amount))}(q);const handlePaymentSuccess=()=>{T.success("Payment processed successfully!"),w.value=!1,E.updateUploadStateFromProject(E.project),I.fetchWallet()},handlePaymentFailed=e=>{var t,r;console.error("Payment error:",e),T.error((null==(r=null==(t=e.response)?void 0:t.data)?void 0:r.message)||"Payment processing failed"),w.value=!0,E.updateUploadStateFromProject(E.project),I.fetchWallet()};return C({title:m((()=>{var e;return(null==(e=E.project)?void 0:e.name)?`Edit Draft: ${E.project.name} - ${X.value}`:`Edit Draft - Project - ${X.value}`})),description:m((()=>{var e;return(null==(e=E.project)?void 0:e.name)?`Edit and finalize the draft for your project ${E.project.name} on ${X.value}.`:`Edit and finalize the draft details for your project on ${X.value}.`})),keywords:m((()=>{var e;return(null==(e=E.project)?void 0:e.name)?`${E.project.name}, edit project, draft, finalize, upload, ${X.value}`:`edit project, draft, finalize, upload, studio, ${X.value}`})),image:m((()=>{var e,t;return(null==(e=k.talastageApp)?void 0:e.thumbnail_url)||(null==(t=k.talastageApp)?void 0:t.logo_url)||"/default-project-edit-draft.png"})),type:"website",siteName:X,url:m((()=>`/studio/projects/${M.value}/edit_draft`)),noIndex:!0,structuredDataFactory:()=>{var e,t,r,o;return{"@context":"https://schema.org","@type":"WebPage",name:(null==(e=E.project)?void 0:e.name)?`Edit Draft: ${E.project.name} - ${X.value}`:`Edit Draft - Project - ${X.value}`,description:(null==(t=E.project)?void 0:t.name)?`Edit and finalize the draft for your project ${E.project.name} on ${X.value}.`:`Edit and finalize the draft details for your project on ${X.value}.`,url:`/studio/projects/${M.value}/edit_draft`,isPartOf:{"@type":"CreativeWork",name:(null==(r=E.project)?void 0:r.name)||"Project"},publisher:{"@type":"Organization",name:X.value,logo:{"@type":"ImageObject",url:(null==(o=k.talastageApp)?void 0:o.logo_url)||"/default-thumbnail.png"}}}}}),(o,a,i,m)=>{const f=e,g=t,y=r;a(v(F,s({fluid:"",class:"pa-0"},m),{default:l(((e,t,r,o)=>{var a,i;if(!t)return[O.value&&"completed"!==(null==(i=n(E).project)?void 0:i.payment_status)?(u(),d(f,{key:0,modelValue:w.value,"onUpdate:modelValue":e=>w.value=e,project:n(E).project,title:z.value,"error-message":R.value,onPaymentSuccess:handlePaymentSuccess,onPaymentFailed:handlePaymentFailed},null,8,["modelValue","onUpdate:modelValue","project","title","error-message"])):c("",!0),A.value?(u(),d(S,{key:1,type:"card, list-item-three-line@4",class:"mb-6"})):(u(),d(j,{key:2},[p(b,{flat:"",class:"mb-6"},{default:l((()=>[p(U,{class:"pa-6"},{default:l((()=>[p(g,{"requirements-data":n(x).formattedRequirements,onOpenPaymentDialog:handlePaymentDialog},null,8,["requirements-data"])])),_:1})])),_:1}),p(y,{modelValue:W.value,"onUpdate:modelValue":e=>W.value=e,project:n(E).project,mode:"editDraft",onFinish:finish,onPaymentFailed:handlePaymentFailedEvent},null,8,["modelValue","onUpdate:modelValue","project"])],64))];O.value&&"completed"!==(null==(a=n(E).project)?void 0:a.payment_status)?t(v(f,{modelValue:w.value,"onUpdate:modelValue":e=>w.value=e,project:n(E).project,title:z.value,"error-message":R.value,onPaymentSuccess:handlePaymentSuccess,onPaymentFailed:handlePaymentFailed},null,r,o)):t("\x3c!----\x3e"),A.value?t(v(S,{type:"card, list-item-three-line@4",class:"mb-6"},null,r,o)):(t("\x3c!--[--\x3e"),t(v(b,{flat:"",class:"mb-6"},{default:l(((e,t,r,o)=>{if(!t)return[p(U,{class:"pa-6"},{default:l((()=>[p(g,{"requirements-data":n(x).formattedRequirements,onOpenPaymentDialog:handlePaymentDialog},null,8,["requirements-data"])])),_:1})];t(v(U,{class:"pa-6"},{default:l(((e,t,r,o)=>{if(!t)return[p(g,{"requirements-data":n(x).formattedRequirements,onOpenPaymentDialog:handlePaymentDialog},null,8,["requirements-data"])];t(v(g,{"requirements-data":n(x).formattedRequirements,onOpenPaymentDialog:handlePaymentDialog},null,r,o))})),_:1},r,o))})),_:1},r,o)),t(v(y,{modelValue:W.value,"onUpdate:modelValue":e=>W.value=e,project:n(E).project,mode:"editDraft",onFinish:finish,onPaymentFailed:handlePaymentFailedEvent},null,r,o)),t("\x3c!--]--\x3e"))})),_:1},i))}}}),x=T.setup;T.setup=(e,t)=>{const r=o();return(r.modules||(r.modules=new Set)).add("pages/studio/projects/[access_uuid]/edit_draft.vue"),x?x(e,t):void 0};const E=B(T,[["__scopeId","data-v-223f8bc5"]]);export{E as default};
