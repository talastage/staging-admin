import{computed as e,ref as o,inject as n,shallowRef as t,provide as a,watch as l,mergeProps as r,createVNode as s,nextTick as u}from"vue";import{m as i,u as c,c as v,V as d}from"./VOverlay-ZKavbTei.mjs";import{f as p}from"./forwardRefs-BSTjJZPU.mjs";import{p as f,$ as m,h as y,a2 as w,a3 as g,j as T,o as V,aN as E,aO as K,a1 as b}from"./server.mjs";import{V as k}from"./dialog-transition-BU2TTOTj.mjs";const A=f({id:String,...m(i({closeDelay:250,closeOnContentClick:!0,locationStrategy:"connected",openDelay:300,scrim:!1,scrollStrategy:"reposition",transition:{component:k}}),["absolute"])},"VMenu"),j=y()({name:"VMenu",props:A(),emits:{"update:modelValue":e=>!0},setup(i,f){let{slots:m}=f;const y=w(i,"modelValue"),{scopeId:k}=c(),A=g(),j=e((()=>i.id||`v-menu-${A}`)),D=o(),P=n(v,null),C=t(0);async function onFocusIn(e){var o,n,t;const a=e.relatedTarget,l=e.target;if(await u(),y.value&&a!==l&&(null==(o=D.value)?void 0:o.contentEl)&&(null==(n=D.value)?void 0:n.globalTop)&&![void 0,D.value.contentEl].includes(l)&&!D.value.contentEl.contains(l)){null==(t=E(D.value.contentEl)[0])||t.focus()}}function onClickOutside(){null==P||P.closeParents()}function onKeydown(e){var o,n,t;if(!i.disabled&&"Tab"===e.key){K(E(null==(o=D.value)?void 0:o.contentEl,!1),e.shiftKey?"prev":"next",(e=>e.tabIndex>=0))||(y.value=!1,null==(t=null==(n=D.value)?void 0:n.activatorEl)||t.focus())}}function onActivatorKeydown(e){var o;if(i.disabled)return;const n=null==(o=D.value)?void 0:o.contentEl;n&&y.value?"ArrowDown"===e.key?(e.preventDefault(),b(n,"next")):"ArrowUp"===e.key&&(e.preventDefault(),b(n,"prev")):["ArrowDown","ArrowUp"].includes(e.key)&&(y.value=!0,e.preventDefault(),setTimeout((()=>setTimeout((()=>onActivatorKeydown(e))))))}a(v,{register(){++C.value},unregister(){--C.value},closeParents(){setTimeout((()=>{C.value||(y.value=!1,null==P||P.closeParents())}),40)}}),l(y,(e=>{e?(null==P||P.register(),(void 0).addEventListener("focusin",onFocusIn,{once:!0})):(null==P||P.unregister(),(void 0).removeEventListener("focusin",onFocusIn))}));const O=e((()=>r({"aria-haspopup":"menu","aria-expanded":String(y.value),"aria-owns":j.value,onKeydown:onActivatorKeydown},i.activatorProps)));return T((()=>{const e=d.filterProps(i);return s(d,r({ref:D,class:["v-menu",i.class],style:i.style},e,{modelValue:y.value,"onUpdate:modelValue":e=>y.value=e,absolute:!0,activatorProps:O.value,"onClick:outside":onClickOutside,onKeydown:onKeydown},k),{activator:m.activator,default:function(){for(var e=arguments.length,o=new Array(e),n=0;n<e;n++)o[n]=arguments[n];return s(V,{root:"VMenu"},{default:()=>{var e;return[null==(e=m.default)?void 0:e.call(m,...o)]}})}})})),p({id:j,"Î¨openChildren":C},D)}});export{j as V};
