import{_ as e}from"./BaseHeader-CiSkdPXW.mjs";import{_ as t}from"./MediaThumbnail-jyEgcC54.mjs";import{useSSRContext as n,defineComponent as a,computed as r,mergeProps as o,withCtx as s,createVNode as i,createTextVNode as l,toDisplayString as m,openBlock as c,createBlock as u,createCommentVNode as p,ref as d,unref as v,Fragment as f,renderList as _}from"vue";import{ssrRenderComponent as g,ssrInterpolate as h,ssrRenderList as j}from"vue/server-renderer";import{u as y}from"./pageAuthStore-DpqSeziz.mjs";import{useRoute as x}from"vue-router";import{V as k}from"./VCard-CsohsM82.mjs";import{V as w}from"./VRow-rkX0LEXR.mjs";import{V as b}from"./VCol-CKxprC4g.mjs";import{a as V}from"./VChip-f_o2BAA4.mjs";import{_ as C,b as A,u as D,af as I,U as $}from"./server.mjs";import{_ as U}from"./ProjectCardCompact-C94E1iON.mjs";import{_ as S}from"./ApproveInvestmentDialog-BXN4VChx.mjs";import{u as P}from"./useInfiniteScroll-CumoSAIu.mjs";import{V as L}from"./VContainer-By3q0af_.mjs";import{V as M}from"./VAlert-DneVUU3Q.mjs";import"hls.js";import"./VImg-B2jcJjnn.mjs";import"./VAvatar-JL8WKjry.mjs";import"./index--K8ZrFMm.mjs";import"node:http";import"node:https";import"node:zlib";import"node:stream";import"node:buffer";import"node:util";import"node:url";import"node:net";import"node:fs";import"node:path";import"../_/nitro.mjs";import"consola/core";import"nuxt-site-config/urls";import"ipx";import"unhead";import"pinia-plugin-persistedstate";import"./useDateFormatter-W2Hui1rv.mjs";import"./BaseDialog-DsGYlnLZ.mjs";import"./VDialog-DA9BdIfh.mjs";import"./VOverlay-ZKavbTei.mjs";import"./easing-Bn3h-KUg.mjs";import"./forwardRefs-BSTjJZPU.mjs";import"./dialog-transition-BU2TTOTj.mjs";import"./useSnackMessage-PVLwAm7x.mjs";import"./VSpacer-_gFExeVk.mjs";import"./VListItem-jTLuICGb.mjs";import"./VTextarea-DkPaPTLI.mjs";import"./VCounter-BZE6l8kb.mjs";import"./VField-ZM6yOiXp.mjs";import"./VInput-DRJS2l97.mjs";const R=a({__name:"PageInvestmentCard",__ssrInlineRender:!0,props:{investment:{}},emits:["openApproveDialog"],setup(e){const n=e,a=y();x().params.pageSlug;const d=r((()=>{var e;const t=null==(e=a.page)?void 0:e.id;return t?`/investments/earnings/projects/${n.investment.project.access_uuid}/investor-details-${t}`:"#"})),formatDate=e=>{if(!e)return"";return`${Math.floor((Date.now()-new Date(e).getTime())/2592e6)} months ago`},getStatusColor=e=>({approved:"success",pending:"warning",rejected:"error"}[e]||"grey");return(e,n,a,r)=>{const v=t;n(g(k,o({elevation:"2",class:"investment-card mb-4"},r),{default:s(((t,n,a,r)=>{if(!n)return[i(w,{"no-gutters":""},{default:s((()=>[i(b,{cols:"12",sm:"3",class:"media-column"},{default:s((()=>[i(v,{size:"md",videoUrl:e.investment.project.video_url,thumbnailUrl:e.investment.project.thumbnail_url,showViews:!1,showDuration:!0,class:"project-thumbnail-wrapper"},null,8,["videoUrl","thumbnailUrl"])])),_:1}),i(b,{cols:"12",sm:"6",class:"content-column pa-4"},{default:s((()=>{var t;return[i("h3",{class:"text-h6 font-weight-medium text-truncate"},m(e.investment.project.name),1),i("div",{class:"text-body-2 text-grey-darken-1 mt-1"},m(null==(t=e.investment.project.views_count)?void 0:t.toLocaleString())+" views • "+m(formatDate(e.investment.project.created_at)),1),i("div",{class:"mt-2 d-flex gap-2"},[i(V,{small:"",color:e.investment.is_creator?"primary":"grey",variant:"flat"},{default:s((()=>[l(m(e.investment.is_creator?"Creator":"Investor"),1)])),_:1},8,["color"]),i(V,{small:"",color:getStatusColor(e.investment.status),variant:"flat"},{default:s((()=>[l(m(e.investment.status),1)])),_:1},8,["color"]),i(V,{small:"",color:"success",variant:"flat"},{default:s((()=>[l(m(e.investment.share_percentage)+"% Share ",1)])),_:1})])]})),_:2},1024),i(b,{cols:"12",sm:"3",class:"actions-column pa-4"},{default:s((()=>[i(A,{to:d.value,color:"primary",variant:"tonal","prepend-icon":"mdi-information",block:""},{default:s((()=>[l(" My Earnings ")])),_:1},8,["to"]),"pending"===e.investment.status?(c(),u(A,{key:0,color:"success",variant:"tonal","prepend-icon":"mdi-check",block:"",onClick:t=>e.$emit("openApproveDialog",e.investment)},{default:s((()=>[l(" Approve ")])),_:1},8,["onClick"])):p("",!0)])),_:1})])),_:2},1024)];n(g(w,{"no-gutters":""},{default:s(((t,n,a,r)=>{if(!n)return[i(b,{cols:"12",sm:"3",class:"media-column"},{default:s((()=>[i(v,{size:"md",videoUrl:e.investment.project.video_url,thumbnailUrl:e.investment.project.thumbnail_url,showViews:!1,showDuration:!0,class:"project-thumbnail-wrapper"},null,8,["videoUrl","thumbnailUrl"])])),_:1}),i(b,{cols:"12",sm:"6",class:"content-column pa-4"},{default:s((()=>{var t;return[i("h3",{class:"text-h6 font-weight-medium text-truncate"},m(e.investment.project.name),1),i("div",{class:"text-body-2 text-grey-darken-1 mt-1"},m(null==(t=e.investment.project.views_count)?void 0:t.toLocaleString())+" views • "+m(formatDate(e.investment.project.created_at)),1),i("div",{class:"mt-2 d-flex gap-2"},[i(V,{small:"",color:e.investment.is_creator?"primary":"grey",variant:"flat"},{default:s((()=>[l(m(e.investment.is_creator?"Creator":"Investor"),1)])),_:1},8,["color"]),i(V,{small:"",color:getStatusColor(e.investment.status),variant:"flat"},{default:s((()=>[l(m(e.investment.status),1)])),_:1},8,["color"]),i(V,{small:"",color:"success",variant:"flat"},{default:s((()=>[l(m(e.investment.share_percentage)+"% Share ",1)])),_:1})])]})),_:2},1024),i(b,{cols:"12",sm:"3",class:"actions-column pa-4"},{default:s((()=>[i(A,{to:d.value,color:"primary",variant:"tonal","prepend-icon":"mdi-information",block:""},{default:s((()=>[l(" My Earnings ")])),_:1},8,["to"]),"pending"===e.investment.status?(c(),u(A,{key:0,color:"success",variant:"tonal","prepend-icon":"mdi-check",block:"",onClick:t=>e.$emit("openApproveDialog",e.investment)},{default:s((()=>[l(" Approve ")])),_:1},8,["onClick"])):p("",!0)])),_:1})];n(g(b,{cols:"12",sm:"3",class:"media-column"},{default:s(((t,n,a,r)=>{if(!n)return[i(v,{size:"md",videoUrl:e.investment.project.video_url,thumbnailUrl:e.investment.project.thumbnail_url,showViews:!1,showDuration:!0,class:"project-thumbnail-wrapper"},null,8,["videoUrl","thumbnailUrl"])];n(g(v,{size:"md",videoUrl:e.investment.project.video_url,thumbnailUrl:e.investment.project.thumbnail_url,showViews:!1,showDuration:!0,class:"project-thumbnail-wrapper"},null,a,r))})),_:1},a,r)),n(g(b,{cols:"12",sm:"6",class:"content-column pa-4"},{default:s(((t,n,a,r)=>{var o,c;if(!n)return[i("h3",{class:"text-h6 font-weight-medium text-truncate"},m(e.investment.project.name),1),i("div",{class:"text-body-2 text-grey-darken-1 mt-1"},m(null==(c=e.investment.project.views_count)?void 0:c.toLocaleString())+" views • "+m(formatDate(e.investment.project.created_at)),1),i("div",{class:"mt-2 d-flex gap-2"},[i(V,{small:"",color:e.investment.is_creator?"primary":"grey",variant:"flat"},{default:s((()=>[l(m(e.investment.is_creator?"Creator":"Investor"),1)])),_:1},8,["color"]),i(V,{small:"",color:getStatusColor(e.investment.status),variant:"flat"},{default:s((()=>[l(m(e.investment.status),1)])),_:1},8,["color"]),i(V,{small:"",color:"success",variant:"flat"},{default:s((()=>[l(m(e.investment.share_percentage)+"% Share ",1)])),_:1})])];n(`<h3 class="text-h6 font-weight-medium text-truncate" data-v-c984daf2${r}>${h(e.investment.project.name)}</h3><div class="text-body-2 text-grey-darken-1 mt-1" data-v-c984daf2${r}>${h(null==(o=e.investment.project.views_count)?void 0:o.toLocaleString())} views • ${h(formatDate(e.investment.project.created_at))}</div><div class="mt-2 d-flex gap-2" data-v-c984daf2${r}>`),n(g(V,{small:"",color:e.investment.is_creator?"primary":"grey",variant:"flat"},{default:s(((t,n,a,r)=>{if(!n)return[l(m(e.investment.is_creator?"Creator":"Investor"),1)];n(`${h(e.investment.is_creator?"Creator":"Investor")}`)})),_:1},a,r)),n(g(V,{small:"",color:getStatusColor(e.investment.status),variant:"flat"},{default:s(((t,n,a,r)=>{if(!n)return[l(m(e.investment.status),1)];n(`${h(e.investment.status)}`)})),_:1},a,r)),n(g(V,{small:"",color:"success",variant:"flat"},{default:s(((t,n,a,r)=>{if(!n)return[l(m(e.investment.share_percentage)+"% Share ",1)];n(`${h(e.investment.share_percentage)}% Share `)})),_:1},a,r)),n("</div>")})),_:1},a,r)),n(g(b,{cols:"12",sm:"3",class:"actions-column pa-4"},{default:s(((t,n,a,r)=>{if(!n)return[i(A,{to:d.value,color:"primary",variant:"tonal","prepend-icon":"mdi-information",block:""},{default:s((()=>[l(" My Earnings ")])),_:1},8,["to"]),"pending"===e.investment.status?(c(),u(A,{key:0,color:"success",variant:"tonal","prepend-icon":"mdi-check",block:"",onClick:t=>e.$emit("openApproveDialog",e.investment)},{default:s((()=>[l(" Approve ")])),_:1},8,["onClick"])):p("",!0)];n(g(A,{to:d.value,color:"primary",variant:"tonal","prepend-icon":"mdi-information",block:""},{default:s(((e,t,n,a)=>{if(!t)return[l(" My Earnings ")];t(" My Earnings ")})),_:1},a,r)),"pending"===e.investment.status?n(g(A,{color:"success",variant:"tonal","prepend-icon":"mdi-check",block:"",onClick:t=>e.$emit("openApproveDialog",e.investment)},{default:s(((e,t,n,a)=>{if(!t)return[l(" Approve ")];t(" Approve ")})),_:1},a,r)):n("\x3c!----\x3e")})),_:1},a,r))})),_:1},a,r))})),_:1},a))}}}),B=R.setup;R.setup=(e,t)=>{const a=n();return(a.modules||(a.modules=new Set)).add("components/page/PageInvestmentCard.vue"),B?B(e,t):void 0};const E=C(R,[["__scopeId","data-v-c984daf2"]]),T=a({__name:"PageInvestments",__ssrInlineRender:!0,setup(t){const n=x(),{$axios:a}=D(),r=n.params.pageSlug,m=d(!1),h=d(!0),y=d(!1),{items:k,isLoading:V,error:C,hasMore:R,refresh:B,reset:T}=P((async e=>{const t=await a.get(`/api/pages/investments/${r}`,{params:{page:e}});return 1===e&&(m.value=t.data.is_creator,h.value=!1),t.data.data}),{threshold:100,throttle:200}),refreshInfinite=async()=>{y.value=!0,T(),await B(),y.value=!1},O=d(!1),z=d(null),openApproveDialog=e=>{z.value=e,O.value=!0},onApproved=async e=>{await a.post(`/api/pages/investments/${r}/${e}/approve`),await refreshInfinite()},onRejected=async(e,t)=>{await a.post(`/api/pages/investments/${r}/${e}/reject`,{message:t}),await refreshInfinite()};return(t,n,a,r)=>{const d=e,x=E,C=U,D=S;n(g(L,o({fluid:""},r),{default:s(((e,t,n,a)=>{if(!t)return[i(d,{title:"Page Investments",subtitle:"Projects this page has invested into"},{actions:s((()=>[i(A,{color:"primary",variant:"text","prepend-icon":"mdi-refresh",loading:y.value,onClick:refreshInfinite},{default:s((()=>[l(" Refresh ")])),_:1},8,["loading"])])),_:1}),v(V)&&h.value?(c(),u(I,{key:0,indeterminate:"",class:"my-4"})):p("",!0),v(k).length?(c(),u(f,{key:1},[i(w,null,{default:s((()=>[(c(!0),u(f,null,_(v(k),(e=>(c(),u(b,{cols:"12",key:e.id},{default:s((()=>[m.value?(c(),u(x,{key:0,investment:e,onOpenApproveDialog:openApproveDialog},null,8,["investment"])):(c(),u(C,{key:1,project:e},null,8,["project"]))])),_:2},1024)))),128))])),_:1}),v(V)&&!h.value?(c(),u($,{key:0,indeterminate:"",class:"my-4"})):p("",!0),v(R)?p("",!0):(c(),u("div",{key:1,class:"text-center my-4"},[i("span",null,"No more data.")]))],64)):v(V)?p("",!0):(c(),u(M,{key:2,type:"info"},{default:s((()=>[l(" No investments found. ")])),_:1})),i(D,{modelValue:O.value,"onUpdate:modelValue":e=>O.value=e,investment:z.value,onApproved:onApproved,onRejected:onRejected},null,8,["modelValue","onUpdate:modelValue","investment"])];t(g(d,{title:"Page Investments",subtitle:"Projects this page has invested into"},{actions:s(((e,t,n,a)=>{if(!t)return[i(A,{color:"primary",variant:"text","prepend-icon":"mdi-refresh",loading:y.value,onClick:refreshInfinite},{default:s((()=>[l(" Refresh ")])),_:1},8,["loading"])];t(g(A,{color:"primary",variant:"text","prepend-icon":"mdi-refresh",loading:y.value,onClick:refreshInfinite},{default:s(((e,t,n,a)=>{if(!t)return[l(" Refresh ")];t(" Refresh ")})),_:1},n,a))})),_:1},n,a)),v(V)&&h.value?t(g(I,{indeterminate:"",class:"my-4"},null,n,a)):t("\x3c!----\x3e"),v(k).length?(t("\x3c!--[--\x3e"),t(g(w,null,{default:s(((e,t,n,a)=>{if(!t)return[(c(!0),u(f,null,_(v(k),(e=>(c(),u(b,{cols:"12",key:e.id},{default:s((()=>[m.value?(c(),u(x,{key:0,investment:e,onOpenApproveDialog:openApproveDialog},null,8,["investment"])):(c(),u(C,{key:1,project:e},null,8,["project"]))])),_:2},1024)))),128))];t("\x3c!--[--\x3e"),j(v(k),(e=>{t(g(b,{cols:"12",key:e.id},{default:s(((t,n,a,r)=>{if(!n)return[m.value?(c(),u(x,{key:0,investment:e,onOpenApproveDialog:openApproveDialog},null,8,["investment"])):(c(),u(C,{key:1,project:e},null,8,["project"]))];m.value?n(g(x,{investment:e,onOpenApproveDialog:openApproveDialog},null,a,r)):n(g(C,{project:e},null,a,r))})),_:2},n,a))})),t("\x3c!--]--\x3e")})),_:1},n,a)),v(V)&&!h.value?t(g($,{indeterminate:"",class:"my-4"},null,n,a)):t("\x3c!----\x3e"),v(R)?t("\x3c!----\x3e"):t(`<div class="text-center my-4" data-v-d3f87771${a}><span data-v-d3f87771${a}>No more data.</span></div>`),t("\x3c!--]--\x3e")):v(V)?t("\x3c!----\x3e"):t(g(M,{type:"info"},{default:s(((e,t,n,a)=>{if(!t)return[l(" No investments found. ")];t(" No investments found. ")})),_:1},n,a)),t(g(D,{modelValue:O.value,"onUpdate:modelValue":e=>O.value=e,investment:z.value,onApproved:onApproved,onRejected:onRejected},null,n,a))})),_:1},a))}}}),O=T.setup;T.setup=(e,t)=>{const a=n();return(a.modules||(a.modules=new Set)).add("components/page/profile/PageInvestments.vue"),O?O(e,t):void 0};const z=C(T,[["__scopeId","data-v-d3f87771"]]);export{z as default};
