import{_ as J}from"./DD4k1lXb.js";import{_ as K}from"./BV7m3wyX.js";import{n as C,k as Q,u as M,c as P,o as p,m as E,p as e,w as t,b as a,s as u,v as _,q as A,V as I,bH as U,_ as T,a as h,x as o,j as X,g as Z,l as ee,t as q,y as b,D as N,F as R,B as te,a5 as re}from"./CGQimWOm.js";import{V as S}from"./CS8xUUzH.js";import{a as B}from"./DsvAftJq.js";import{V as se}from"./CRY4crBU.js";import{u as ae}from"./BCoct7aH.js";import{u as ne}from"./B3G4pkyN.js";import{a as oe,V as ie}from"./BkTuXOR_.js";import{V as ce}from"./xvVMJZi9.js";import{V as le}from"./BSH7BhKc.js";import{V as ue}from"./GXZRJwQ4.js";import{_ as me}from"./DPoG3AgV.js";import{u as de}from"./De3D2xlH.js";import{s as pe}from"./rtPmyJLL.js";import{V as D}from"./BvtSni_j.js";import{V as F}from"./tTgLLTve.js";import{V as f}from"./f5lwX8SZ.js";import{V as z}from"./P_q-BwEt.js";import{V as ge}from"./BhN2__aY.js";import{u as ye}from"./istWFD0Z.js";import{u as fe}from"./D78L5r-E.js";import"./DL649WMo.js";import"./D4pNkYCe.js";import"./DJ0NdY24.js";import"./CjukEv2V.js";import"./C-GTDzx5.js";/* empty css        */import"./2hEmiBig.js";const _e={class:"summary-cards"},ve={class:"text-body-2 text-medium-emphasis"},he={class:"d-flex align-center justify-space-between"},je=C({__name:"InvestmentEarningsSummaryCards",props:{summary:{}},setup(j){const x=j,g=Q(),i=M(),m=r=>r?Number(r.replace(/,/g,"")):0,c=P(()=>i.params.access_uuid||""),s=P(()=>{var r;return((r=x.summary)==null?void 0:r.creator_id)||0}),n=async()=>{if(s.value&&c.value){const r=`/investments/earnings/projects/${c.value}/investor-details-${s.value}`;try{await U(r,{external:!1})}catch{g.push(r)}}else console.error("Missing required parameters for navigation")},l=async()=>{if(c.value)try{await U(`/project/${c.value}/earnings/investors`,{external:!1})}catch(r){console.error("Navigation error:",r),g.push(`/project/${c.value}/earnings/investors`)}else console.error("Missing access UUID for navigation")};return(r,d)=>{const w=K;return p(),E("div",_e,[e(se,null,{default:t(()=>[e(S,{cols:"12",sm:"6",md:"4"},{default:t(()=>[e(w,{title:"Viewing Earnings",amount:m(r.summary.project_total_earnings),"currency-symbol":r.summary.currency.symbol,"currency-code":r.summary.currency.code,icon:"mdi-eye",elevation:10},{footer:t(()=>[a("span",ve,[e(B,{size:"x-small",color:"primary",variant:"flat",density:"compact",class:"earnings-chip"},{default:t(()=>[u(_(r.summary.total_transactions)+" transactions ",1)]),_:1})])]),_:1},8,["amount","currency-symbol","currency-code"])]),_:1}),e(S,{cols:"12",sm:"6",md:"4"},{default:t(()=>[e(w,{title:"Creator Earnings",amount:m(r.summary.creator_total_earnings),"currency-symbol":r.summary.currency.symbol,"currency-code":r.summary.currency.code,icon:"mdi-account-star",variant:"primary",elevation:10},{footer:t(({variant:V})=>[e(A,{color:V==="primary"?"white":"primary",variant:V==="primary"?"tonal":"elevated",size:"small","prepend-icon":"mdi-bank-transfer",onClick:n,class:"earnings-btn"},{default:t(()=>d[0]||(d[0]=[u(" My Earnings ")])),_:2},1032,["color","variant"])]),_:1},8,["amount","currency-symbol","currency-code"])]),_:1}),e(S,{cols:"12",sm:"6",md:"4"},{default:t(()=>[e(w,{title:"Investors Earnings",amount:m(r.summary.investors_total_earnings),"currency-symbol":r.summary.currency.symbol,"currency-code":r.summary.currency.code,icon:"mdi-account-group",elevation:10},{footer:t(()=>[a("div",he,[e(B,{size:"x-small",color:"success",variant:"flat",density:"compact",class:"earnings-chip"},{default:t(()=>[u(_(r.summary.project_investors)+" investors ",1)]),_:1}),e(A,{color:"primary",variant:"text",size:"small",onClick:l,class:"earnings-btn"},{default:t(()=>[d[2]||(d[2]=u(" View All ")),e(I,{end:""},{default:t(()=>d[1]||(d[1]=[u("mdi-chevron-right")])),_:1})]),_:1})])]),_:1},8,["amount","currency-symbol","currency-code"])]),_:1})]),_:1})])}}}),xe=T(je,[["__scopeId","data-v-b467a811"]]),we={class:"d-flex align-center gap-4"},Ve={class:"d-flex align-center gap-3 flex-shrink-0"},be={class:"user-info"},ke={class:"text-subtitle-1 font-weight-medium"},Pe={class:"d-flex align-center gap-1 text-caption text-grey-darken-1"},$e={class:"financial-breakdown text-right"},Ee={class:"net-amount mb-2"},Ie={class:"text-h6 font-weight-bold text-success"},Ce={class:"breakdown-details"},Le={class:"d-flex justify-end align-center gap-2 text-body-2"},Se={class:"text-grey-darken-2"},De={class:"text-warning"},ze=C({__name:"ProjectEarningListItem",props:{earning:{}},setup(j){const{formatRelativeDate:x}=ae(),{currencyFormatter:g}=ne(),i=(s,n)=>{const l=typeof s=="string"?parseFloat(s):s;return g(l,n.symbol,n.code)},m=s=>{switch(s){case"project_watching":return"mdi-eye";case"tip":return"mdi-heart";default:return"mdi-cash"}},c=s=>{switch(s){case"project_watching":return"Project Watching";case"tip":return"Tip";default:return"Payment"}};return(s,n)=>(p(),h(ie,{class:"earning-item",elevation:"2",rounded:"lg"},{default:t(()=>[e(oe,{class:"pa-4"},{default:t(()=>[a("div",we,[a("div",Ve,[e(ce,{size:"48"},{default:t(()=>[e(le,{src:s.earning.user.profile_photo,alt:s.earning.user.display_name},{error:t(()=>[e(I,{size:"24",color:"grey-lighten-1"},{default:t(()=>n[0]||(n[0]=[u("mdi-account-circle")])),_:1})]),_:1},8,["src","alt"])]),_:1}),a("div",be,[a("div",ke,_(s.earning.user.display_name),1),a("div",Pe,[e(I,{size:"12"},{default:t(()=>[u(_(m(s.earning.type)),1)]),_:1}),u(" "+_(c(s.earning.type))+" ",1),n[1]||(n[1]=a("span",{class:"mx-1"},"â€¢",-1)),u(" "+_(o(x)(s.earning.created_at)),1)])])]),e(ue),a("div",$e,[a("div",Ee,[a("div",Ie,_(i(s.earning.net_amount,s.earning.currency)),1),n[2]||(n[2]=a("div",{class:"text-caption text-grey-darken-1"},"Net Earned",-1))]),a("div",Ce,[a("div",Le,[a("span",Se,_(i(s.earning.amount,s.earning.currency)),1),e(I,{size:"12",color:"grey-darken-1"},{default:t(()=>n[3]||(n[3]=[u("mdi-minus")])),_:1}),a("span",De,_(i(s.earning.app_service_fee,s.earning.currency)),1)]),n[4]||(n[4]=a("div",{class:"text-caption text-grey mt-1"}," Gross - Service Fee ",-1))])])])]),_:1})]),_:1}))}}),Ae=T(ze,[["__scopeId","data-v-6913d982"]]),Te={class:"earnings-list"},Ue={class:"d-flex flex-column",style:{gap:"4px",flex:"1"}},Ne={class:"text-right"},Re={key:4,class:"earning-item"},Be={class:"d-flex flex-column",style:{gap:"4px",flex:"1"}},Fe={class:"text-right"},Me=C({__name:"ProjectEarningsPage",props:{project:{type:Object,required:!0},accessUuid:{type:String,required:!0},isProjectLoading:{type:Boolean,default:!1}},emits:["refresh-project"],setup(j,{emit:x}){const g=j,i=x,m=X(null),{$axios:c}=Z(),s=async()=>{try{const{data:y}=await c.get(`/api/projects/${g.accessUuid}/earnings/statistics`);m.value=y}catch(y){console.error("Error fetching statistics:",y instanceof Error?y.message:"Unknown error")}},n=async y=>{const{data:v}=await c.get(`/api/projects/${g.accessUuid}/earnings`,{params:{page:y}});return v.data},{items:l,isLoading:r,error:d,hasMore:w,refresh:V}=de(n,{threshold:200,throttle:300}),k=async()=>{await Promise.all([s()])},L=async()=>{await Promise.all([s(),V(),i("refresh-project")])},H=()=>{const v=pe(()=>{L()},3e5);te(()=>clearInterval(v))};return ee(()=>{k(),H()}),q(()=>g.accessUuid,y=>{y&&k()}),(y,v)=>{const W=J,G=xe,O=Ae,Y=me;return p(),h(ge,null,{default:t(()=>[e(W,{project:j.project,loading:j.isProjectLoading,subtitle:"Earnings & Revenue Analytics"},{actions:t(()=>[e(A,{icon:"mdi-refresh",variant:"text",size:"small",loading:o(r),onClick:o(V)},null,8,["loading","onClick"])]),bottom:t(()=>[e(D,{class:"mt-4"})]),_:1},8,["project","loading"]),m.value?(p(),h(G,{key:0,summary:m.value.summary,class:"mb-5"},null,8,["summary"])):b("",!0),e(Y,{title:"Earnings History"},{content:t(()=>[a("div",Te,[o(l).length?(p(!0),E(R,{key:0},N(o(l),$=>(p(),h(O,{key:$.id,earning:$},null,8,["earning"]))),128)):b("",!0),o(r)&&!o(l).length?(p(),E(R,{key:1},N(5,$=>a("div",{key:$,class:"earning-item"},[e(F,null,{prepend:t(()=>[e(f,{type:"avatar",width:"40",height:"40"})]),append:t(()=>[a("div",Ne,[e(f,{type:"text",width:"80"}),e(f,{type:"text",width:"60"})])]),default:t(()=>[a("div",Ue,[e(f,{type:"text",width:"150"}),e(f,{type:"text",width:"100"})])]),_:1}),e(D)])),64)):b("",!0),!o(r)&&!o(d)&&o(l).length===0?(p(),h(z,{key:2,type:"info",class:"ma-4"},{default:t(()=>v[0]||(v[0]=[u(" No earnings found ")])),_:1})):b("",!0),o(d)?(p(),h(z,{key:3,type:"error",class:"ma-4"},{default:t(()=>[u(_(o(d)),1)]),_:1})):b("",!0),o(r)&&o(l).length>0?(p(),E("div",Re,[e(F,null,{prepend:t(()=>[e(f,{type:"avatar",width:"40",height:"40"})]),append:t(()=>[a("div",Fe,[e(f,{type:"text",width:"80"}),e(f,{type:"text",width:"60"})])]),default:t(()=>[a("div",Be,[e(f,{type:"text",width:"150"}),e(f,{type:"text",width:"100"})])]),_:1}),e(D)])):b("",!0),!o(r)&&!o(w)&&o(l).length>0?(p(),h(z,{key:5,type:"info",class:"ma-4"},{default:t(()=>v[1]||(v[1]=[u(" You've reached the end of the list ")])),_:1})):b("",!0)])]),_:1})]),_:1})}}}),qe=T(Me,[["__scopeId","data-v-246a0c0b"]]),ht=C({__name:"index",setup(j){const x=M(),g=ye(),{project:i,error:m,isLoading:c}=re(g),s=P(()=>x.params.access_uuid),n=P(()=>i.value?`${i.value.name} - Earnings & Revenue`:"Project Earnings"),l=P(()=>i.value?`View earnings and revenue analytics for ${i.value.name}`:"Project earnings and revenue analytics dashboard"),r=async()=>{s.value&&(await g.fetchProject(s.value),m.value&&console.error("Error fetching project:",m.value))};r();const{seo:d,updateSeo:w}=fe({title:c.value?"Loading Project Earnings...":n.value,description:l.value,keywords:"project earnings, revenue analytics, financial data, project finance",type:"website",noIndex:!0});return q([i,c],([V,k])=>{w({title:k?"Loading Project Earnings...":n.value,description:l.value})},{immediate:!0}),(V,k)=>{const L=qe;return p(),h(L,{project:o(i),"access-uuid":s.value,"is-project-loading":o(c),onRefreshProject:r},null,8,["project","access-uuid","is-project-loading"])}}});export{ht as default};
