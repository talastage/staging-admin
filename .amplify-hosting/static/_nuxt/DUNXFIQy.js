import{_ as M}from"./D5iXKOLd.js";import{u as C}from"./BCoct7aH.js";import{n as B,c as g,o as c,m as f,p as $,w as I,s as V,V as U,b as m,v as y,_ as T,a as h,G as D,y as b,q as z,j as w,t as P}from"./CGQimWOm.js";const F={class:"premiere-time-display"},E={class:"premiere-time-display__content"},L={class:"premiere-time-display__relative"},J={class:"premiere-time-display__exact"},q=B({__name:"UpcomingPremiereTimeDisplay",props:{premiereDate:{}},setup(s){const a=s,{formatRelativeDate:i}=C(),l=g(()=>{const e=i(a.premiereDate);return e.startsWith("in ")?`Premieres ${e}`:e}),d=g(()=>{const e=new Date(a.premiereDate),t=["January","February","March","April","May","June","July","August","September","October","November","December"],n=r=>r.toString().padStart(2,"0"),p=e.getDate(),u=t[e.getMonth()],_=n(e.getHours()),o=n(e.getMinutes());return`${p} ${u} at ${_}:${o}`});return(e,t)=>(c(),f("div",F,[$(U,{size:"small",class:"mr-1"},{default:I(()=>t[0]||(t[0]=[V("mdi-clock-outline")])),_:1}),m("div",E,[m("div",L,y(l.value),1),m("div",J,y(d.value),1)])]))}}),A=T(q,[["__scopeId","data-v-1b0af014"]]),O={key:0,class:"text-subtitle-2"},R=B({__name:"NotifyMeButton",props:{isNotified:{type:Boolean},loading:{type:Boolean,default:!1},compact:{type:Boolean,default:!1},isPending:{type:Boolean,default:!1},itemId:{default:""}},emits:["toggle","update:isNotified"],setup(s,{emit:a}){const i=s,l=a,d=g(()=>i.isPending?(i.isNotified,"Saving..."):i.isNotified?"Notification On":"Notify me"),e=t=>{t.stopPropagation(),l("toggle",t),l("update:isNotified",!i.isNotified)};return(t,n)=>(c(),h(z,{loading:t.loading,color:t.isNotified?"primary":"grey-darken-2","text-color":t.isNotified?"white":"black",variant:"flat",size:t.compact?"x-small":"small",class:D(["notify-me-button",{"notify-me-button--compact":t.compact,"notify-me-button--pending":t.isPending}]),onClick:e},{default:I(()=>[$(U,{icon:t.isNotified?"mdi-bell":"mdi-bell-outline",class:D(!t.compact&&"mr-2"),size:(t.compact,"small"),color:t.isNotified?"white":"black"},null,8,["icon","class","size","color"]),t.compact?b("",!0):(c(),f("span",O,y(d.value),1))]),_:1},8,["loading","color","text-color","size","class"]))}}),j=T(R,[["__scopeId","data-v-67c3f1d9"]]);function G(){const s=w({}),a=w({});return{toggleNotification:async(e,t,n)=>{const p=!t;s.value[e]=!0,a.value[e]&&delete a.value[e];try{return await n(p),p}catch(u){return a.value[e]=u,console.error(`Failed to update notification for ${e}:`,u),t}finally{delete s.value[e]}},isUpdatePending:e=>!!s.value[e],getUpdateError:e=>a.value[e],pendingRequests:s,notificationErrors:a}}const H={class:"upcoming-premiere-overlay__content"},W={key:0,class:"premiere-text"},x={class:"countdown-display"},K={key:0,class:"premiere-date"},Q=B({__name:"UpcomingPremiereNotifyMeCard",props:{premiereDate:{},showNotifyButton:{type:Boolean,default:!1},isNotified:{type:Boolean,default:!1},notifyLoading:{type:Boolean,default:!1},position:{default:"bottom"},useCountdown:{type:Boolean,default:!1},showLocalDate:{type:Boolean,default:!1},premiereId:{default:""}},emits:["notifyToggle","countdownFinished","update:isNotified"],setup(s,{emit:a}){const i=s,l=a,{formatLocalDateTime:d}=C(),{isUpdatePending:e,toggleNotification:t}=G(),n=w(i.isNotified),p=g(()=>i.premiereId?e(i.premiereId):!1);P(()=>i.isNotified,o=>{n.value=o}),P(n,o=>{l("update:isNotified",o)});const u=g(()=>i.premiereDate?d(i.premiereDate):""),_=async o=>{if(l("notifyToggle",o),i.premiereId){const r=async v=>{await new Promise(N=>setTimeout(N,1e3)),l("update:isNotified",v)};await t(i.premiereId,n.value,r)}};return(o,r)=>{const v=M,N=A,S=j;return c(),f("div",{class:D(["upcoming-premiere-overlay",{"position-bottom":o.position==="bottom","position-top-right":o.position==="top-right"}])},[m("div",H,[o.useCountdown?(c(),f("div",W,[r[2]||(r[2]=m("div",{class:"countdown"},[m("strong",null,"Premieres in")],-1)),m("div",x,[$(v,{"target-date":o.premiereDate,"short-format":!0,onFinished:r[0]||(r[0]=k=>o.$emit("countdownFinished"))},null,8,["target-date"])]),o.showLocalDate?(c(),f("div",K,y(u.value),1)):b("",!0)])):(c(),h(N,{key:1,premiereDate:o.premiereDate,class:"upcoming-premiere-overlay__time-badge"},null,8,["premiereDate"])),o.showNotifyButton?(c(),h(S,{key:2,isNotified:n.value,"onUpdate:isNotified":r[1]||(r[1]=k=>n.value=k),"is-pending":p.value,compact:o.position==="bottom",class:"upcoming-premiere-overlay__notify-button",onToggle:_},null,8,["isNotified","is-pending","compact"])):b("",!0)])],2)}}}),ee=T(Q,[["__scopeId","data-v-3a0c4152"]]);export{ee as _,j as a,G as u};
