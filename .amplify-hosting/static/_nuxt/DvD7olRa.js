import{n as ee,o as d,a as $,bL as ve,w as t,p as a,V as q,b,v as L,s as c,y as P,_ as le,j as E,c as w,t as O,q as j,m as h,F as T,D as oe,k as Ee,U as fe,z as Ce,C as De,l as Pe,g as Ae,u as Ue,i as je,I as Le,x as B,O as Fe}from"./CGQimWOm.js";import{a as Ve,V as ke}from"./tTgLLTve.js";import{B as be}from"./COhe-ksk.js";import{a as Q}from"./DsvAftJq.js";import{V as se}from"./GXZRJwQ4.js";import{V as re}from"./P_q-BwEt.js";import{V as ge}from"./BEy3SeWo.js";import{V as Be}from"./DoIi4J9g.js";import{V as ye}from"./CiXMVmI4.js";import{V as pe}from"./CRY4crBU.js";import{V as X}from"./CS8xUUzH.js";import{V as Z}from"./CMsVONS5.js";import{V as he}from"./BcH3Kywr.js";import{V as Y,b as J,a as G,c as $e}from"./BkTuXOR_.js";import{S as xe}from"./CB_jkhRS.js";import{u as Re}from"./DMLzsDc7.js";import{u as Oe}from"./BHJozufe.js";import{u as ze}from"./DMBY-Kaj.js";import{u as Me}from"./B3G4pkyN.js";import{u as Te}from"./CeETcD8a.js";import{V as we}from"./f5lwX8SZ.js";import{V as qe}from"./BRveoiXI.js";import{V as We}from"./BhN2__aY.js";import"./xvVMJZi9.js";import"./BSH7BhKc.js";import"./2hEmiBig.js";/* empty css        */import"./C-73ZGdz.js";import"./BFmCCZJK.js";import"./Dg4qVXYX.js";import"./CjukEv2V.js";import"./C-GTDzx5.js";import"./DJ0NdY24.js";import"./IpAEdaYr.js";import"./DXjoE66g.js";import"./BvtSni_j.js";import"./CW50LM9V.js";import"./Dn0bXcU5.js";const Ye=["href"],Je=ee({__name:"LinkItem",props:{icon:{},label:{},href:{}},setup(z){return(x,v)=>x.label||x.href?(d(),$(ke,{key:0,href:x.href,target:"_blank",rel:"noopener noreferrer"},ve({default:t(()=>[a(Ve,null,{default:t(()=>[b("a",{href:x.href,target:"_blank",rel:"noopener noreferrer",class:"text-body-1"},L(x.label),9,Ye)]),_:1})]),_:2},[x.icon?{name:"prepend",fn:t(()=>[a(q,{icon:x.icon,class:"mr-3"},null,8,["icon"])]),key:"0"}:void 0]),1032,["href"])):x.label?(d(),$(ke,{key:1},ve({default:t(()=>[a(Ve,{class:"text-body-1"},{default:t(()=>[c(L(x.label),1)]),_:1})]),_:2},[x.icon?{name:"prepend",fn:t(()=>[a(q,{icon:x.icon,class:"mr-3"},null,8,["icon"])]),key:"0"}:void 0]),1024)):P("",!0)}}),Ge=le(Je,[["__scopeId","data-v-e93202b6"]]),He={class:"d-flex align-center"},Ke={class:"ps-4"},ae=1e3,Qe=ee({__name:"EditDescriptionDialog",props:{modelValue:{type:Boolean},description:{},errors:{}},emits:["update:modelValue","save","close"],setup(z,{emit:x}){const v=z,S=x,C=E(!1),p=E(v.description),N=[y=>!!(y!=null&&y.trim())||"Description is required",y=>y.length<=ae||`Maximum ${ae} characters allowed`,y=>y.length>=10||"Description must be at least 10 characters"],m=w(()=>{var y;return((y=p.value)==null?void 0:y.length)??0}),D=w(()=>m.value<=ae),_=w(()=>{var y;return!!((y=p.value)!=null&&y.trim())&&p.value.length>=10&&p.value.length<=ae}),I=w(()=>{var r;const y=[];return(r=v.errors)!=null&&r.description&&y.push(...v.errors.description),y});O(()=>v.description,y=>{p.value=y});const U=()=>{p.value=v.description,S("close"),S("update:modelValue",!1)},i=async()=>{if(_.value){C.value=!0;try{await S("save",p.value.trim()),S("update:modelValue",!1)}finally{C.value=!1}}};return(y,r)=>(d(),$(be,{"model-value":y.modelValue,"onUpdate:modelValue":r[1]||(r[1]=n=>y.$emit("update:modelValue",n)),title:"Edit Description","max-width":"600px"},{title:t(()=>[b("div",He,[r[2]||(r[2]=b("span",null,"Edit Description",-1)),m.value>0?(d(),$(Q,{key:0,class:"ml-4",color:D.value?"info":"error",size:"small"},{default:t(()=>[c(L(m.value)+"/"+L(ae)+" characters ",1)]),_:1},8,["color"])):P("",!0)])]),actions:t(()=>[a(se),a(j,{color:"grey-darken-1",variant:"text",onClick:U,disabled:C.value},{default:t(()=>r[4]||(r[4]=[c(" Cancel ")])),_:1},8,["disabled"]),a(j,{color:"primary",onClick:i,loading:C.value,disabled:!_.value||C.value},{default:t(()=>r[5]||(r[5]=[c(" Save Changes ")])),_:1},8,["loading","disabled"])]),default:t(()=>[I.value.length>0?(d(),$(re,{key:0,type:"error",variant:"tonal",class:"mb-4"},{default:t(()=>[b("ul",Ke,[(d(!0),h(T,null,oe(I.value,(n,s)=>(d(),h("li",{key:s},L(n),1))),128))])]),_:1})):P("",!0),a(ge,{class:"pa-4",rounded:"",border:""},{default:t(()=>[a(Be,{modelValue:p.value,"onUpdate:modelValue":r[0]||(r[0]=n=>p.value=n),label:"Description",rows:"5","auto-grow":"",counter:"",maxlength:ae,rules:N,"error-messages":I.value,placeholder:"Enter a detailed description...","hide-details":"auto"},null,8,["modelValue","error-messages"]),r[3]||(r[3]=b("div",{class:"mt-2 text-caption text-grey"}," Provide a clear and detailed description. This will help others better understand your project. ",-1))]),_:1})]),_:1},8,["model-value"]))}}),Xe=le(Qe,[["__scopeId","data-v-f5422c98"]]),Ze={class:"d-flex align-center"},et={class:"ps-4"},tt={class:"d-flex align-center"},at=ee({__name:"EditLocationDialog",props:{modelValue:{type:Boolean},location:{},errors:{}},emits:["update:modelValue","save","close"],setup(z,{emit:x}){const v=z,S=x,C=Ee(),p=E(null),N=E(!1),m=E(!1),D=E(!1),_=E({...v.location}),I=w(()=>{const s=_.value.country;return s?typeof s=="string"?s:s.name||"":""}),U=w(()=>{const s=[];return v.errors&&Object.values(v.errors).forEach(o=>{s.push(...o)}),s});O(()=>v.location,s=>{_.value={...s}},{deep:!0}),O(()=>v.errors,s=>{s&&Object.keys(s).length>0&&(N.value=!1)});const i=()=>{_.value={...v.location},S("close"),S("update:modelValue",!1)},y=async()=>{if(!p.value)return;const{valid:s}=await p.value.validate();if(s){m.value=!0;try{await S("save",_.value),S("update:modelValue",!1)}finally{m.value=!1}}},r=()=>{D.value=!0},n=()=>{D.value=!1,S("update:modelValue",!1),C.push("/account/settings")};return(s,o)=>(d(),$(be,{"model-value":s.modelValue,"onUpdate:modelValue":o[5]||(o[5]=f=>s.$emit("update:modelValue",f)),title:"Edit Location","max-width":"600px"},{title:t(()=>[b("div",Ze,[o[7]||(o[7]=b("span",null,"Edit Location",-1)),N.value?(d(),$(Q,{key:0,class:"ml-4",color:"success",size:"small"},{default:t(()=>o[6]||(o[6]=[c(" Valid Location ")])),_:1})):P("",!0)])]),actions:t(()=>[a(se),a(j,{color:"grey-darken-1",variant:"text",onClick:i,disabled:m.value},{default:t(()=>o[10]||(o[10]=[c(" Cancel ")])),_:1},8,["disabled"]),a(j,{color:"primary",onClick:y,disabled:!N.value,loading:m.value},{default:t(()=>o[11]||(o[11]=[c(" Save Location ")])),_:1},8,["disabled","loading"])]),default:t(()=>[U.value.length>0?(d(),$(re,{key:0,type:"error",variant:"tonal",class:"mb-4"},{default:t(()=>[b("ul",et,[(d(!0),h(T,null,oe(U.value,(f,M)=>(d(),h("li",{key:M},L(f),1))),128))])]),_:1})):P("",!0),a(ge,{class:"pa-4",rounded:"",border:""},{default:t(()=>[a(ye,{ref_key:"form",ref:p,modelValue:N.value,"onUpdate:modelValue":o[2]||(o[2]=f=>N.value=f)},{default:t(()=>[a(pe,null,{default:t(()=>[a(X,{cols:"12"},{default:t(()=>[a(Z,{modelValue:_.value.address,"onUpdate:modelValue":o[0]||(o[0]=f=>_.value.address=f),label:"Street Address",rules:[f=>!!f||"Address is required"],placeholder:"Enter street address",clearable:"","hide-details":"auto",variant:"outlined",density:"comfortable"},null,8,["modelValue","rules"])]),_:1}),a(X,{cols:"12"},{default:t(()=>[b("div",tt,[a(Z,{modelValue:I.value,"onUpdate:modelValue":o[1]||(o[1]=f=>I.value=f),label:"Country",rules:[f=>!!f||"Country is required"],placeholder:"Enter country",readonly:"","hide-details":"auto",variant:"outlined",density:"comfortable",class:"flex-grow-1"},null,8,["modelValue","rules"]),a(j,{color:"primary",variant:"text",class:"ml-2","prepend-icon":"mdi-pencil",onClick:r},{default:t(()=>o[8]||(o[8]=[c(" Edit Country ")])),_:1})]),o[9]||(o[9]=b("p",{class:"text-caption text-grey mt-1"}," To change your country, please visit the account settings page. ",-1))]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}),a(he,{modelValue:D.value,"onUpdate:modelValue":o[4]||(o[4]=f=>D.value=f),"max-width":"400px"},{default:t(()=>[a(Y,null,{default:t(()=>[a(J,{class:"text-h6"},{default:t(()=>o[12]||(o[12]=[c("Leave Page?")])),_:1}),a(G,null,{default:t(()=>o[13]||(o[13]=[c(" You will be redirected to the account settings page to update your country. Any unsaved changes here will be lost. ")])),_:1}),a($e,null,{default:t(()=>[a(se),a(j,{color:"grey-darken-1",variant:"text",onClick:o[3]||(o[3]=f=>D.value=!1)},{default:t(()=>o[14]||(o[14]=[c(" Cancel ")])),_:1}),a(j,{color:"primary",onClick:n},{default:t(()=>o[15]||(o[15]=[c(" Continue ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1},8,["model-value"]))}}),lt=le(at,[["__scopeId","data-v-5cc006ea"]]),nt={class:"currency-prefix"},ot={class:"currency-suffix"},st=ee({__name:"CurrencyInput",props:{modelValue:{},label:{default:"Amount"},required:{type:Boolean,default:!1},placeholder:{default:"0.00"},hint:{default:""},errorMessages:{default:()=>[]},disabled:{type:Boolean,default:!1},loading:{type:Boolean,default:!1},rules:{default:()=>[]},currencySymbol:{default:null},currencyCode:{default:null},prefixSymbol:{type:Boolean,default:!0},min:{default:void 0},max:{default:void 0}},emits:["update:modelValue"],setup(z,{emit:x}){const v=z,S=x,C=E(null),p=E(_(v.modelValue)),N=w(()=>v.currencySymbol??v.currencyCode),m=w(()=>v.prefixSymbol?N.value:null),D=w(()=>v.prefixSymbol?null:N.value);function _(n){return n==null?"":String(n)}function I(n){const s=n.replace(/[^0-9.]/g,"");if(s.split(".").length>2||s===""||s===".")return null;const f=parseFloat(s);return isNaN(f)?null:f}O(()=>v.modelValue,n=>{const s=I(p.value);n!==s&&(p.value=_(n))},{immediate:!1});const U=w(()=>p.value),i=w(()=>v.rules.map(s=>o=>{const f=I(o);return s(f)})),y=n=>{let o=n.target.value;const f=o.split(".");f.length>2&&(o=f[0]+"."+f.slice(1).join(""));const M=o.replace(/[^0-9.]/g,"");p.value=M;const te=I(M);S("update:modelValue",te),fe(()=>{var H;(H=C.value)==null||H.validate()})},r=()=>{const n=I(p.value);p.value=_(n),S("update:modelValue",n),fe(()=>{var s;(s=C.value)==null||s.validate()})};return(n,s)=>(d(),$(Z,{ref_key:"textFieldRef",ref:C,"model-value":U.value,label:n.label,rules:i.value,required:n.required,placeholder:n.placeholder,hint:n.hint,"persistent-hint":!!n.hint,"error-messages":n.errorMessages,disabled:n.disabled,loading:n.loading,inputmode:"decimal",type:"text",onInput:y,onBlur:r,class:"currency-input"},ve({_:2},[m.value?{name:"prepend-inner",fn:t(()=>[b("span",nt,L(m.value),1)]),key:"0"}:void 0,D.value?{name:"append-inner",fn:t(()=>[b("span",ot,L(D.value),1)]),key:"1"}:void 0]),1032,["model-value","label","rules","required","placeholder","hint","persistent-hint","error-messages","disabled","loading"]))}}),rt=le(st,[["__scopeId","data-v-5d23ec85"]]),it={class:"d-flex align-center"},ut={class:"ps-4"},dt=ee({__name:"EditInvestmentDialog",props:{modelValue:{type:Boolean},settings:{},errors:{}},emits:["update:modelValue","save","close"],setup(z,{emit:x}){const v=z,S=x,C=E(null),p=E(!1),N=E(!1),m=Ce({...v.settings,max_investment_amount:v.settings.max_investment_amount?Number(v.settings.max_investment_amount):0}),D=[r=>r!=null||"Amount is required",r=>r===null||r>=0||"Amount must be zero or positive"],_=w(()=>v.errors||{}),I=w(()=>{const r=Number(m.max_investment_amount);return!isNaN(r)&&r>=0}),U=r=>{var n;return new Intl.NumberFormat("en-US",{style:"currency",currency:((n=m.currency)==null?void 0:n.code)||"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(r)};O(()=>v.settings,r=>{var n;Object.assign(m,{...r,max_investment_amount:r.max_investment_amount?Number(r.max_investment_amount):0}),(n=C.value)==null||n.resetValidation(),p.value=!1},{deep:!0}),O(()=>v.errors,r=>{var n;r&&Object.keys(r).length>0&&(p.value=!1,(n=C.value)==null||n.validate())},{deep:!0}),O(()=>v.modelValue,r=>{r||(N.value=!1)});const i=()=>{var r;S("close"),Object.assign(m,{...v.settings,max_investment_amount:v.settings.max_investment_amount?Number(v.settings.max_investment_amount):0}),(r=C.value)==null||r.resetValidation(),p.value=!1},y=async()=>{if(!C.value)return;const{valid:r}=await C.value.validate();if(p.value=r,r){N.value=!0;try{const n={max_investment_amount:String(m.max_investment_amount??"0")};S("save",n)}finally{}}};return(r,n)=>(d(),$(be,{"model-value":r.modelValue,"onUpdate:modelValue":n[2]||(n[2]=s=>r.$emit("update:modelValue",s)),title:"Investment Settings","max-width":"600px",persistent:""},{title:t(()=>[b("div",it,[n[3]||(n[3]=b("span",null,"Maximum Investment Amount",-1)),m.max_investment_amount?(d(),$(Q,{key:0,class:"ml-4",color:I.value?"success":"warning",size:"small"},{default:t(()=>[c(L(U(Number(m.max_investment_amount))),1)]),_:1},8,["color"])):P("",!0)])]),actions:t(()=>[a(se),a(j,{color:"grey-darken-1",variant:"text",onClick:i,disabled:N.value},{default:t(()=>n[6]||(n[6]=[c(" Cancel ")])),_:1},8,["disabled"]),a(j,{color:"primary",onClick:y,disabled:!p.value||N.value,loading:N.value},{default:t(()=>n[7]||(n[7]=[c(" Save Settings ")])),_:1},8,["disabled","loading"])]),default:t(()=>[Object.keys(_.value).length>0?(d(),$(re,{key:0,type:"error",variant:"tonal",class:"mb-4"},{default:t(()=>[b("ul",ut,[(d(!0),h(T,null,oe(_.value,(s,o)=>(d(),h("li",{key:o},L(Array.isArray(s)?s.join(", "):s),1))),128))])]),_:1})):P("",!0),a(ge,{class:"pa-4",rounded:"",border:""},{default:t(()=>[a(ye,{ref_key:"formRef",ref:C,modelValue:p.value,"onUpdate:modelValue":n[1]||(n[1]=s=>p.value=s),onSubmit:De(y,["prevent"])},{default:t(()=>[a(pe,null,{default:t(()=>[a(X,{cols:"12"},{default:t(()=>{var s,o;return[n[4]||(n[4]=b("div",{class:"text-subtitle-2 mb-2"},"Set Your Investment Limit",-1)),a(rt,{modelValue:m.max_investment_amount,"onUpdate:modelValue":n[0]||(n[0]=f=>m.max_investment_amount=f),label:"Maximum Project Budget","currency-symbol":(s=m.currency)==null?void 0:s.symbol,"currency-code":(o=m.currency)==null?void 0:o.code,"prefix-symbol":!0,rules:D,"error-messages":_.value.max_investment_amount,min:0,required:"","hide-details":"auto",variant:"outlined",density:"comfortable"},null,8,["modelValue","currency-symbol","currency-code","error-messages"]),n[5]||(n[5]=b("div",{class:"text-caption text-grey mt-2"}," Projects with budgets exceeding this amount won't appear in your investment opportunities. This helps match you with projects within your investment range. ",-1))]}),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model-value"]))}}),mt=le(dt,[["__scopeId","data-v-dfa17500"]]),ct={class:"d-flex align-center mb-3"},pt={key:0,class:"mt-2"},vt={class:"d-flex align-center mb-3"},ft={key:0,class:"mt-2"},bt=ee({__name:"EditContactsDialog",props:{modelValue:{type:Boolean},contacts:{},errors:{}},emits:["update:modelValue","save","close"],setup(z,{emit:x}){const v=z,S=x,C=E(null),p=E(!1),N=E(!1),m=E({...v.contacts}),D=Re(),_=E(""),I=E(""),U=E(""),i=E("");Pe(async()=>{D.isFetched||await D.fetchCountries(),y()});const y=()=>{if(m.value.phone_number){const g=r(m.value.phone_number);_.value=g.code,I.value=g.number}else _.value="250",I.value="";if(m.value.whatsapp_number){const g=r(m.value.whatsapp_number);U.value=g.code,i.value=g.number}else U.value=_.value,i.value=""},r=g=>{if(g.startsWith("+")){const u=g.match(/^\+(\d+?)(\d{9,10})$/);if(u&&u.length===3)return{code:u[1],number:u[2]}}else if(g.startsWith("0"))return{code:"250",number:g.substring(1)};return{code:"250",number:g}},n=w(()=>I.value?`+${_.value}${I.value}`:null),s=w(()=>i.value?`+${U.value}${i.value}`:null),o=w(()=>{const g=m.value.email;return g&&g.trim()!==""&&/.+@.+\..+/.test(g)}),f=[g=>!!g||"Email is required",g=>/.+@.+\..+/.test(g)||"Please enter a valid email"],M=[g=>!g||/^\d{1,15}$/.test(g)||"Please enter a valid phone number"],te=[g=>!g||/^(https?:\/\/)?([\da-z.-]+)\.([a-z.]{2,6})([/\w .-]*)*\/?$/.test(g)||"Please enter a valid URL"];O([_,I],()=>{m.value.phone_number=n.value}),O([U,i],()=>{m.value.whatsapp_number=s.value}),O(()=>v.contacts,g=>{m.value={...g},y()},{deep:!0}),O(()=>v.errors,g=>{g&&Object.keys(g).length>0&&(p.value=!1)});const H=()=>{S("close")},ie=async()=>{if(o.value){N.value=!0;try{m.value.phone_number=n.value,m.value.whatsapp_number=s.value,S("save",m.value)}finally{N.value=!1}}};return(g,u)=>(d(),$(he,{"model-value":g.modelValue,"onUpdate:modelValue":u[7]||(u[7]=A=>g.$emit("update:modelValue",A)),"max-width":"600px"},{default:t(()=>[a(Y,null,{default:t(()=>[a(J,{class:"d-flex align-center"},{default:t(()=>[a(q,{class:"mr-2",color:"primary"},{default:t(()=>u[8]||(u[8]=[c("mdi-card-account-phone")])),_:1}),u[9]||(u[9]=c(" Edit Contact Information "))]),_:1}),a(G,null,{default:t(()=>[a(re,{type:"info",variant:"tonal",class:"text-body-2 mb-4"},{default:t(()=>u[10]||(u[10]=[c(" Your contact information will be visible to project creators who may want to discuss investment opportunities with you. ")])),_:1}),a(ye,{ref_key:"form",ref:C,modelValue:p.value,"onUpdate:modelValue":u[6]||(u[6]=A=>p.value=A)},{default:t(()=>[a(Z,{modelValue:m.value.email,"onUpdate:modelValue":u[0]||(u[0]=A=>m.value.email=A),label:"Email Address",type:"email",rules:f,hint:"For formal communications and proposals","prepend-inner-icon":"mdi-email",class:"mb-4",required:""},null,8,["modelValue"]),a(Y,{variant:"outlined",class:"mb-4 pa-4"},{default:t(()=>[b("div",ct,[a(q,{class:"mr-2",color:"green"},{default:t(()=>u[11]||(u[11]=[c("mdi-whatsapp")])),_:1}),u[13]||(u[13]=b("span",{class:"text-subtitle-1 font-weight-medium"},"WhatsApp Contact",-1)),a(Q,{class:"ml-2",size:"x-small",color:"success",variant:"tonal"},{default:t(()=>u[12]||(u[12]=[c("Recommended")])),_:1})]),a(pe,{align:"center"},{default:t(()=>[a(X,{cols:"4",class:"pr-2"},{default:t(()=>[a(xe,{modelValue:U.value,"onUpdate:modelValue":u[1]||(u[1]=A=>U.value=A),label:"Country Code",hint:"e.g., +1, +250",rules:[]},null,8,["modelValue"])]),_:1}),a(X,{cols:"8",class:"pl-2"},{default:t(()=>[a(Z,{modelValue:i.value,"onUpdate:modelValue":u[2]||(u[2]=A=>i.value=A),label:"WhatsApp Number",rules:M,placeholder:"Enter your phone number",hint:"Enter number without country code","prepend-inner-icon":"mdi-whatsapp"},null,8,["modelValue"])]),_:1})]),_:1}),s.value?(d(),h("div",pt,[a(Q,{size:"small",color:"success",variant:"tonal"},{default:t(()=>[a(q,{start:""},{default:t(()=>u[14]||(u[14]=[c("mdi-check")])),_:1}),c(" Complete: "+L(s.value),1)]),_:1})])):P("",!0)]),_:1}),a(Y,{variant:"outlined",class:"mb-4 pa-4"},{default:t(()=>[b("div",vt,[a(q,{class:"mr-2",color:"blue"},{default:t(()=>u[15]||(u[15]=[c("mdi-phone")])),_:1}),u[17]||(u[17]=b("span",{class:"text-subtitle-1 font-weight-medium"},"Phone Contact",-1)),a(Q,{class:"ml-2",size:"x-small",color:"info",variant:"tonal"},{default:t(()=>u[16]||(u[16]=[c("Optional")])),_:1})]),a(pe,{align:"center"},{default:t(()=>[a(X,{cols:"4",class:"pr-2"},{default:t(()=>[a(xe,{modelValue:_.value,"onUpdate:modelValue":u[3]||(u[3]=A=>_.value=A),label:"Country Code",hint:"e.g., +1, +250",rules:[]},null,8,["modelValue"])]),_:1}),a(X,{cols:"8",class:"pl-2"},{default:t(()=>[a(Z,{modelValue:I.value,"onUpdate:modelValue":u[4]||(u[4]=A=>I.value=A),label:"Phone Number",rules:M,placeholder:"Enter your phone number",hint:"Enter number without country code","prepend-inner-icon":"mdi-phone"},null,8,["modelValue"])]),_:1})]),_:1}),n.value?(d(),h("div",ft,[a(Q,{size:"small",color:"info",variant:"tonal"},{default:t(()=>[a(q,{start:""},{default:t(()=>u[18]||(u[18]=[c("mdi-check")])),_:1}),c(" Complete: "+L(n.value),1)]),_:1})])):P("",!0)]),_:1}),a(Z,{modelValue:m.value.website_url,"onUpdate:modelValue":u[5]||(u[5]=A=>m.value.website_url=A),label:"Website URL",rules:te,"prepend-inner-icon":"mdi-web",hint:"Optional: Your business or personal website"},null,8,["modelValue"])]),_:1},8,["modelValue"])]),_:1}),a($e,null,{default:t(()=>[a(se),a(j,{color:"error",variant:"text",onClick:H},{default:t(()=>u[19]||(u[19]=[c("Cancel")])),_:1}),a(j,{color:"primary",onClick:ie,disabled:!o.value,loading:N.value},{default:t(()=>u[20]||(u[20]=[c(" Save ")])),_:1},8,["disabled","loading"])]),_:1})]),_:1})]),_:1},8,["model-value"]))}}),gt={class:"page-about-tab"},yt={key:0,class:"text-body-1"},_t={key:1,class:"text-grey"},Vt={class:"d-flex align-center"},kt={key:0,class:"text-body-1"},xt={key:1,class:"text-grey"},wt={class:"d-flex align-center"},Ct={class:"text-body-1"},ht={class:"d-flex align-center"},$t={class:"text-grey"},St={class:"d-flex align-center"},Nt={key:1,class:"text-grey"},It={key:1,class:"text-grey"},Et=ee({__name:"PageAbout",async setup(z){let x,v;const{$axios:S}=Ae(),C=Ue(),p=ze(),{currencyFormatter:N}=Me(),m=Te(),D=je(),_=w(()=>C.params.pageSlug);(async()=>{if(!m.page&&_.value)try{await m.fetchPageData(_.value)}catch(l){console.error("Failed to fetch page data for permission check:",l)}})(),(async()=>{var l;if(!((l=D.user)!=null&&l.value))try{await D.fetchUser()}catch(e){console.error("Failed to fetch user data for permission check:",e)}})();const{data:i,pending:y,error:r,refresh:n}=([x,v]=Le(async()=>Oe(`about-${_.value}`,async()=>{var l,e;if(!_.value)throw new Error("Page slug is missing.");try{const k=await S.get(`/api/pages/${_.value}/about`);if(!k.data.success)throw new Error(k.data.message||"Failed to fetch about data");return k.data.data}catch(k){throw console.error("Error fetching about data:",k),new Error(((e=(l=k.response)==null?void 0:l.data)==null?void 0:e.message)||k.message||"Network error fetching about data")}},{watch:[_]})),x=await x,v(),x);O(r,l=>{l&&p.error(`Failed to load page data: ${l.message}`)});const s=w(()=>{var k;const l=(k=D.user)==null?void 0:k.value,e=m.page;return!l||!e||!e.creator?!1:l.id===e.creator.id}),o=Ce({description:!1,location:!1,investment:!1,contacts:!1,"talent-interests":!1}),f=E({}),M=w(()=>{var l,e;return Number(C.params.id||((e=(l=i.value)==null?void 0:l.basic_info)==null?void 0:e.id)||0)}),te=w(()=>({page_id:M.value,address:"",city:"",state:"",country:"",latitude:null,longitude:null})),H=w(()=>({page_id:M.value,max_investment_amount:"0",currency_id:1})),ie=w(()=>({page_id:M.value,whatsapp_number:null,phone_number:null,email:null,website_url:null,telegram:null,facebook_url:null,instagram_url:null,linkedin_url:null,twitter_url:null}));w(()=>!y.value&&!r.value&&!!i.value);const g=w(()=>{var e;const l=(e=i.value)==null?void 0:e.contacts;return l&&["email","phone_number","whatsapp_number","telegram","website_url"].some(k=>!!l[k])}),u=w(()=>{var k;const l=(k=i.value)==null?void 0:k.contacts;return l?[{icon:"mdi-email",label:l.email,href:l.email?`mailto:${l.email}`:null},{icon:"mdi-phone",label:l.phone_number,href:l.phone_number?`tel:${l.phone_number}`:null},{icon:"mdi-whatsapp",label:l.whatsapp_number,href:l.whatsapp_number?`https://wa.me/${l.whatsapp_number.replace(/[^0-9+]/g,"")}`:null},{icon:"mdi-telegram",label:l.telegram,href:l.telegram?`https://t.me/${l.telegram.replace(/^@/,"")}`:null},{icon:"mdi-web",label:l.website_url,href:l.website_url}].filter(R=>R.label):[]}),A=l=>{if(!l)return"N/A";let e="";return l.country&&(typeof l.country=="object"?e=l.country.name||"":e=l.country),l.address&&e?`${l.address}, ${e}`:l.address?l.address:e||"N/A"},Se=l=>{var R,W,K;if(!l)return"N/A";const e=((R=l.currency)==null?void 0:R.symbol)??((W=l.currency)==null?void 0:W.code)??"",k=parseFloat(String(l.max_investment_amount)||"0");return isNaN(k)?"N/A":N(k,e,(K=l.currency)==null?void 0:K.code)},ne=l=>{o[l]=!1,f.value={}},ue=async(l,e)=>{var K,de,V,me,_e;if(!i.value){p.error("Cannot save changes: data not loaded.");return}if(!s.value){p.error("You do not have permission to edit this page."),ne(l);return}let k=null;try{k=JSON.parse(JSON.stringify(i.value))}catch(F){console.error("Failed to clone original data:",F)}let R,W=e;if(l==="description"){if(typeof e!="string"){p.error("Invalid data format for description.");return}R={description:e}}else if(l==="talent-interests"){if(!Array.isArray(e)){p.error("Invalid data format for talent interests.");return}R={talent_interest_ids:e.map(F=>F.id)},W=e}else if(typeof e=="object"&&e!==null)R=e;else{console.error(`Invalid payload type for section ${l}:`,e),p.error(`Invalid data format for ${l}.`);return}Ne(l,W),f.value={},o[l]=!1;try{const F=await S.put(`/api/pages/${_.value}/about/${l}`,R);if(!F.data.success)throw{response:{data:F.data}};p.success(`${l.charAt(0).toUpperCase()+l.slice(1)} updated successfully`),f.value={},await fe(),await n()}catch(F){console.error(`Error saving ${l}:`,((K=F.response)==null?void 0:K.data)||F);const ce=(V=(de=F==null?void 0:F.response)==null?void 0:de.data)==null?void 0:V.errors,Ie=((_e=(me=F==null?void 0:F.response)==null?void 0:me.data)==null?void 0:_e.message)||`Failed to update ${l}`;if(p.error(Ie),k&&i.value)switch(l){case"description":i.value.basic_info=k.basic_info;break;case"location":i.value.location=k.location;break;case"investment":i.value.investment_settings=k.investment_settings;break;case"contacts":i.value.contacts=k.contacts;break;case"talent-interests":i.value.talent_interests=k.talent_interests;break}else await n();ce&&typeof ce=="object"&&Object.keys(ce).length>0?(f.value=ce,o[l]=!0):o[l]=!1}};function Ne(l,e){if(i.value)switch(l){case"description":i.value.basic_info&&typeof e=="string"&&(i.value.basic_info.description=e);break;case"location":const k=e;i.value.location?Object.assign(i.value.location,k):i.value.location={...te.value,...k};break;case"investment":const R=e;i.value.investment_settings?i.value.investment_settings.max_investment_amount=R.max_investment_amount:i.value.investment_settings={...H.value,max_investment_amount:R.max_investment_amount};break;case"contacts":const W=e;i.value.contacts?Object.assign(i.value.contacts,W):i.value.contacts={...ie.value,...W};break;case"talent-interests":Array.isArray(e)&&(i.value.talent_interests=[...e]);break}}return(l,e)=>{const k=Ge,R=Xe,W=lt,K=mt,de=bt;return d(),h("div",gt,[a(We,null,{default:t(()=>[B(y)?(d(),h(T,{key:0},oe(4,V=>a(Y,{key:`skel-${V}`,elevation:"10",class:"mb-4"},{default:t(()=>[a(J,null,{default:t(()=>[a(we,{type:"text",width:120+V*30},null,8,["width"])]),_:2},1024),a(G,null,{default:t(()=>[a(we,{type:"paragraph"})]),_:1})]),_:2},1024)),64)):B(r)?(d(),$(re,{key:1,type:"error",title:"Error Loading Data",prominent:"",class:"mb-4"},{default:t(()=>[e[17]||(e[17]=c(" Could not load the page information. Please try refreshing. ")),e[18]||(e[18]=b("br",null,null,-1)),b("small",null,L(B(r).message),1)]),_:1})):B(i)?(d(),h(T,{key:2},[a(Y,{elevation:"10",class:"mb-4"},{default:t(()=>[a(J,{class:"d-flex justify-space-between align-center"},{default:t(()=>[e[19]||(e[19]=b("span",null,"About",-1)),s.value?(d(),$(j,{key:0,icon:"mdi-pencil",variant:"text",onClick:e[0]||(e[0]=V=>o.description=!0),"aria-label":"Edit Description"})):P("",!0)]),_:1}),a(G,null,{default:t(()=>[B(i).basic_info.description?(d(),h("p",yt,L(B(i).basic_info.description),1)):(d(),h("p",_t,[e[20]||(e[20]=c(" No description available. ")),s.value?(d(),h(T,{key:0},[c(" Click the pencil icon to add one.")],64)):P("",!0)]))]),_:1})]),_:1}),a(Y,{elevation:"10",class:"mb-4"},{default:t(()=>[a(J,{class:"d-flex justify-space-between align-center"},{default:t(()=>[b("div",Vt,[a(q,{start:"",class:"mr-2"},{default:t(()=>e[21]||(e[21]=[c("mdi-map-marker")])),_:1}),e[22]||(e[22]=b("span",null,"Location",-1))]),s.value?(d(),$(j,{key:0,icon:"mdi-pencil",variant:"text",onClick:e[1]||(e[1]=V=>o.location=!0),"aria-label":"Edit Location"})):P("",!0)]),_:1}),a(G,null,{default:t(()=>[B(i).location?(d(),h("div",kt,[b("p",null,L(A(B(i).location)),1)])):(d(),h("p",xt,[e[23]||(e[23]=c(" No location information available. ")),s.value?(d(),h(T,{key:0},[c(" Click the pencil icon to add one.")],64)):P("",!0)]))]),_:1})]),_:1}),B(i).investment_settings?(d(),$(Y,{key:0,elevation:"10",class:"mb-4"},{default:t(()=>[a(J,{class:"d-flex justify-space-between align-center"},{default:t(()=>[b("div",wt,[a(q,{start:"",class:"mr-2"},{default:t(()=>e[24]||(e[24]=[c("mdi-cash")])),_:1}),e[25]||(e[25]=b("span",null,"Maximum Project Budget",-1))]),s.value?(d(),$(j,{key:0,icon:"mdi-pencil",variant:"text",onClick:e[2]||(e[2]=V=>o.investment=!0),"aria-label":"Edit Investment Settings"})):P("",!0)]),_:1}),a(G,null,{default:t(()=>[b("div",Ct,[e[26]||(e[26]=c(" This investor can fund projects with budgets up to ")),b("strong",null,L(Se(B(i).investment_settings)),1),e[27]||(e[27]=c(". "))])]),_:1})]),_:1})):(d(),$(Y,{key:1,elevation:"10",class:"mb-4"},{default:t(()=>[a(J,{class:"d-flex justify-space-between align-center"},{default:t(()=>[b("div",ht,[a(q,{start:"",class:"mr-2"},{default:t(()=>e[28]||(e[28]=[c("mdi-cash")])),_:1}),e[29]||(e[29]=b("span",null,"Maximum Project Budget",-1))]),s.value?(d(),$(j,{key:0,icon:"mdi-pencil",variant:"text",onClick:e[3]||(e[3]=V=>o.investment=!0),"aria-label":"Edit Investment Settings"})):P("",!0)]),_:1}),a(G,null,{default:t(()=>[b("p",$t,[e[30]||(e[30]=c(" Investment settings not configured. ")),s.value?(d(),h(T,{key:0},[c(" Click the pencil icon to set them up.")],64)):P("",!0)])]),_:1})]),_:1})),a(Y,{elevation:"10",class:"mb-4"},{default:t(()=>[a(J,{class:"d-flex justify-space-between align-center"},{default:t(()=>[b("div",St,[a(q,{start:"",class:"mr-2"},{default:t(()=>e[31]||(e[31]=[c("mdi-card-account-phone")])),_:1}),e[32]||(e[32]=b("span",null,"Contact Information",-1))]),s.value?(d(),$(j,{key:0,icon:"mdi-pencil",variant:"text",onClick:e[4]||(e[4]=V=>o.contacts=!0),"aria-label":"Edit Contact Information"})):P("",!0)]),_:1}),a(G,null,{default:t(()=>[B(i).contacts?(d(),h(T,{key:0},[g.value?(d(),$(qe,{key:0,lines:"one",class:"pa-0"},{default:t(()=>[(d(!0),h(T,null,oe(u.value,(V,me)=>(d(),$(k,Fe({key:`basic-${me}-${V.label}`,ref_for:!0},V),null,16))),128))]),_:1})):(d(),h("p",Nt,"No contact information provided."))],64)):(d(),h("p",It,[e[33]||(e[33]=c(" No contact information available. ")),s.value?(d(),h(T,{key:0},[c(" Click the pencil icon to add it.")],64)):P("",!0)]))]),_:1})]),_:1}),a(R,{modelValue:o.description,"onUpdate:modelValue":e[5]||(e[5]=V=>o.description=V),description:B(i).basic_info.description??"",errors:f.value,onSave:e[6]||(e[6]=V=>ue("description",V)),onClose:e[7]||(e[7]=V=>ne("description"))},null,8,["modelValue","description","errors"]),a(W,{modelValue:o.location,"onUpdate:modelValue":e[8]||(e[8]=V=>o.location=V),location:B(i).location??te.value,errors:f.value,onSave:e[9]||(e[9]=V=>ue("location",V)),onClose:e[10]||(e[10]=V=>ne("location"))},null,8,["modelValue","location","errors"]),a(K,{modelValue:o.investment,"onUpdate:modelValue":e[11]||(e[11]=V=>o.investment=V),settings:B(i).investment_settings??H.value,errors:f.value,onSave:e[12]||(e[12]=V=>ue("investment",V)),onClose:e[13]||(e[13]=V=>ne("investment"))},null,8,["modelValue","settings","errors"]),a(de,{modelValue:o.contacts,"onUpdate:modelValue":e[14]||(e[14]=V=>o.contacts=V),contacts:B(i).contacts??ie.value,errors:f.value,onSave:e[15]||(e[15]=V=>ue("contacts",V)),onClose:e[16]||(e[16]=V=>ne("contacts"))},null,8,["modelValue","contacts","errors"])],64)):P("",!0)]),_:1})])}}}),fa=le(Et,[["__scopeId","data-v-923d5a41"]]);export{fa as default};
