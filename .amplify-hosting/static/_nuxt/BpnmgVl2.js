import{_ as C}from"./3SmzOII5.js";import{_ as V}from"./DUNXFIQy.js";import{_ as A}from"./BeQTM7t9.js";import{u as S}from"./DMBY-Kaj.js";import{n as z,dM as E,g as N,c as d,l as M,o as p,a as h,w as T,b as t,p as m,y as u,V as v,m as y,v as w,bH as D,_ as I}from"./CGQimWOm.js";import{V as L}from"./BkTuXOR_.js";const x={class:"upcoming-premiere-card__thumbnail-container"},q={class:"upcoming-premiere-card__play-overlay"},F={class:"upcoming-premiere-card__wrapper"},H={key:0,class:"upcoming-premiere-card__avatar-container"},Y={class:"upcoming-premiere-card__info-container"},j={class:"upcoming-premiere-card__title-container"},G={class:"upcoming-premiere-card__title"},J={class:"upcoming-premiere-card__creator-container"},K={class:"upcoming-premiere-card__creator-name"},O={key:0,class:"upcoming-premiere-card__premiere-badge"},Q=z({__name:"UpcomingPremiereCard",props:{premiere:{},loading:{type:Boolean,default:!1},showPremiereBadge:{type:Boolean,default:!0}},setup(n){const r=n,l=S(),i=E(),{$protectedAction:o}=N(),P=d(()=>i.isNotified(r.premiere.id)),b=d(()=>i.isLoading(r.premiere.id)),U=d(()=>{var e,a,s,c;return!!((a=(e=r.premiere)==null?void 0:e.premiering)!=null&&a.is_future&&((s=r.premiere)==null?void 0:s.status)==="published"&&((c=r.premiere)==null?void 0:c.payment_status)==="completed")});M(()=>{r.premiere.is_notified&&i.setNotificationStatus(r.premiere.id,!0)});const B=async e=>{await o(async()=>{try{await i.toggleNotification(r.premiere),l.success(i.isNotified(r.premiere.id)?"You will be notified when this premiere starts":"Notification removed successfully")}catch(a){l.error("Failed to update notification settings"),console.error("Notification toggle error:",a)}},{requiresAuth:!0})},k=()=>{D(`/watch/${r.premiere.access_uuid}`)};return(e,a)=>{const s=C,c=V,$=A;return p(),h(L,{class:"upcoming-premiere-card",elevation:2,loading:e.loading,onClick:k},{default:T(()=>{var _,g,f;return[t("div",x,[m(s,{thumbnailUrl:e.premiere.thumbnail_url,videoUrl:e.premiere.video_url,showViews:!1,showDuration:!0,size:"2xl",class:"upcoming-premiere-card__thumbnail"},null,8,["thumbnailUrl","videoUrl"]),e.showPremiereBadge?(p(),h(c,{key:0,premiereDate:e.premiere.premiering.localized,showNotifyButton:U.value,isNotified:P.value,notifyLoading:b.value,position:"bottom",useCountdown:!1,onNotifyToggle:B},null,8,["premiereDate","showNotifyButton","isNotified","notifyLoading"])):u("",!0),t("div",q,[m(v,{icon:"mdi-play-circle",size:"x-large",color:"white"})])]),t("div",F,[e.premiere.creator?(p(),y("div",H,[m($,{username:e.premiere.creator.username,profile_photo:e.premiere.creator.profile_photo,size:40,class:"upcoming-premiere-card__avatar"},null,8,["username","profile_photo"])])):u("",!0),t("div",Y,[t("div",j,[t("h3",G,w(e.premiere.name),1)]),t("div",J,[t("span",K,w((_=e.premiere.creator)==null?void 0:_.display_name),1),(f=(g=e.premiere)==null?void 0:g.premiering)!=null&&f.is_future?(p(),y("div",O,[m(v,{icon:"mdi-clock-outline",size:"x-small",class:"mr-1"}),a[0]||(a[0]=t("span",null,"Premiering soon",-1))])):u("",!0)])])])]}),_:1},8,["loading"])}}}),ie=I(Q,[["__scopeId","data-v-8a7f4cda"]]);function oe(){const n=N();return{fetchUpcomingPremieres:async i=>{if(!n.$api)throw new Error("API plugin not available");try{return await n.$api.get("/api/upcoming/premieres",{params:{page:i,per_page:12}})}catch(o){throw console.error("Error fetching premieres:",o),o}},fetchNotifiedUpcomingPremieres:async i=>{if(!n.$api)throw new Error("API plugin not available");try{return await n.$api.get("/api/upcoming/premieres/notified",{params:{page:i,per_page:12}})}catch(o){throw console.error("Error fetching notified premieres:",o),o}}}}export{ie as _,oe as u};
