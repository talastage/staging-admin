import{_ as I}from"./Bem91KZK.js";import{u as M}from"./BCoct7aH.js";import{_ as B,j as w,c as p,o as f,m as g,p as T,w as k,V as $,b as d,v as b,s as D,G as W,f as L,g as R,n as j,k as U,t as P,l as q,a as A,y as V,F,D as G,A as O}from"./CGQimWOm.js";import{V as H}from"./xvVMJZi9.js";import{a as J}from"./DsvAftJq.js";import{_ as K}from"./DPoG3AgV.js";import{u as Q,i as X}from"./CiN8dqd8.js";import{c as Y}from"./CDtnx0aA.js";const Z={class:"flex-grow-1"},tt={class:"d-flex align-center justify-space-between"},et={class:"text-h6 font-weight-medium"},at={class:"text-caption text-medium-emphasis mt-1 d-flex align-center"},st={class:"text-end"},nt={__name:"WalletTransactionItem",props:{transaction:{type:Object,required:!0}},setup(o){const e=o,c=w(!1),{formatRelativeDate:C}=M(),_=p(()=>{const t={withdrawal:"mdi-cash-minus",deposit:"mdi-cash-plus",transfer:"mdi-bank-transfer",default:"mdi-cash"};return t[e.transaction.transaction_type]||t.default}),y=p(()=>{const t={withdrawal:"error",deposit:"success",transfer:"primary",default:"grey"};return t[e.transaction.transaction_type]||t.default}),i=p(()=>e.transaction.transaction_type.charAt(0).toUpperCase()+e.transaction.transaction_type.slice(1)),a=p(()=>{const t=parseFloat(e.transaction.amount);return`${e.transaction.currency_symbol} ${t.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})}`}),s=p(()=>e.transaction.transaction_type==="withdrawal"?"text-error":"text-success"),r=p(()=>C(e.transaction.created_at)),l=p(()=>{const t={completed:"success",pending:"warning",failed:"error",default:"info"};return t[e.transaction.status]||t.default}),h=p(()=>e.transaction.status==="completed"?"flat":"outlined");return(t,m)=>(f(),g("div",{class:W(["transaction-item d-flex align-center py-4",{"hover-state":c.value}]),onMouseenter:m[0]||(m[0]=v=>c.value=!0),onMouseleave:m[1]||(m[1]=v=>c.value=!1)},[T(H,{color:y.value,size:"42",class:"mr-4"},{default:k(()=>[T($,{icon:_.value,color:"white",size:"20"},null,8,["icon"])]),_:1},8,["color"]),d("div",Z,[d("div",tt,[d("div",null,[d("div",et,b(i.value),1),d("div",at,[T($,{size:"14",icon:"mdi-clock-outline",class:"mr-1"}),D(" "+b(r.value),1)])]),d("div",st,[d("div",{class:W(["text-h6 font-weight-medium",s.value])},b(a.value),3),T(J,{color:l.value,size:"small",class:"mt-1",variant:h.value,density:"comfortable"},{default:k(()=>[D(b(o.transaction.status),1)]),_:1},8,["color","variant"])])])])],34))}},rt=B(nt,[["__scopeId","data-v-c7b69ce6"]]),ot=L("wallet-transactions",()=>{const{$axios:o}=R(),e=Q(),c=a=>{var r,l,h,t,m;if(X(a)){const v=a;throw{message:((l=(r=v.response)==null?void 0:r.data)==null?void 0:l.message)||v.message,status:(h=v.response)==null?void 0:h.status,code:(m=(t=v.response)==null?void 0:t.data)==null?void 0:m.code}}throw{message:a instanceof Error?a.message:"An unexpected error occurred"}};return{transferFunds:async a=>{try{const{data:s}=await o.post("/api/wallet/transfer",a);return await e.fetchWallet(),s}catch(s){return c(s)}},processTransaction:async(a,s)=>{try{const{data:r}=await o.post(`/api/wallet/transactions/${a}`,s);return await e.fetchWallet(),r}catch(r){return c(r)}},fetchTransactions:async(a={})=>{const{type:s="all",page:r=1,limit:l=10,recent:h=!1}=a;try{const{data:t}=await o.get("/api/wallet/transactions",{params:{type:s,page:r,limit:l,recent:h}});return t}catch(t){return c(t)}},fetchWalletStatistics:async()=>{try{const{data:a}=await o.get("/api/wallet/transactions/statistics");return a}catch(a){return c(a)}}}}),ct={key:0,class:"d-flex justify-center py-4"},it={key:1,class:"text-center py-4 text-caption text-medium-emphasis"},lt={key:1,class:"empty-state"},ut={class:"text-body-2 text-medium-emphasis"},dt=j({__name:"WalletTransactions",props:{transactionType:{type:String,default:"all"},limit:{type:Number,default:10},showViewAll:{type:Boolean,default:!0}},setup(o){const e=o,c=U(),C=ot(),_=w([]),y=w(1),i=w(!1),a=w(null),s=w(!0),r=p(()=>{switch(e.transactionType){case"deposit":return"Deposit Transactions";case"withdrawal":return"Withdrawal Transactions";case"transfer":return"Transfer Transactions";default:return"Recent Transactions"}}),l=async(n=y.value)=>{if(!(i.value||!s.value)){i.value=!0;try{const u=await C.fetchTransactions({type:e.transactionType,page:n,limit:e.limit}),x=u.data.map(h);_.value=n===1?x:[..._.value,...x],u.meta?(y.value=u.meta.current_page,s.value=u.meta.current_page<u.meta.last_page):s.value=x.length===e.limit}catch(u){console.error("Error fetching transactions:",u)}finally{i.value=!1}}},h=n=>({...n,title:t(n),subtitle:m(n)}),t=n=>n.transaction_type.charAt(0).toUpperCase()+n.transaction_type.slice(1),m=n=>n.status.charAt(0).toUpperCase()+n.status.slice(1),v=()=>{c.push("/wallet/transactions")};return Y(a,()=>{s.value&&!i.value&&l(y.value+1)},{distance:10,throttle:500}),P(()=>e.transactionType,()=>{y.value=1,_.value=[],s.value=!0,l()}),q(l),(n,u)=>{const x=I,N=rt,z=K;return f(),A(z,{title:r.value},{action:k(()=>[o.showViewAll?(f(),A(x,{key:0,title:"View All",action:v,disabled:i.value,prependIcon:"mdi-eye",color:"primary",variant:"tonal"},null,8,["disabled"])):V("",!0)]),content:k(()=>[d("div",{class:"transactions-list",ref_key:"transactionListRef",ref:a},[_.value.length?(f(),g(F,{key:0},[(f(!0),g(F,null,G(_.value,S=>(f(),A(N,{key:S.id,transaction:S},null,8,["transaction"]))),128)),i.value?(f(),g("div",ct,[T(O,{indeterminate:"",color:"primary",size:"24"})])):V("",!0),s.value?V("",!0):(f(),g("div",it," No more transactions to load "))],64)):i.value?V("",!0):(f(),g("div",lt,[T($,{icon:"mdi-cash-multiple-off",size:"64",color:"grey-lighten-1",class:"mb-4"}),u[0]||(u[0]=d("h3",{class:"text-h6 mb-2"},"No Transactions Found",-1)),d("p",ut," There are no "+b(o.transactionType)+" transactions to display. ",1)]))],512)]),_:1},8,["title"])}}}),gt=B(dt,[["__scopeId","data-v-4b56f2f3"]]);export{gt as _};
