import{_ as R}from"./FspEDv8o.js";import{S as U,_ as F}from"./CWJ7n7p-.js";import{u as O,b as q}from"./CDtnx0aA.js";import{_ as Z}from"./3SmzOII5.js";import{n as E,a6 as ee,c as d,o as i,a as V,w as P,b as z,p as B,V as te,m as p,y as $,v as T,M as D,G as ae,_ as A,j as m,l as I,t as N,F as H,D as X,x as G,s as K,q as W,g as ne,k as Y,B as oe,a0 as le,a1 as se}from"./CGQimWOm.js";import{V as ie}from"./xvVMJZi9.js";import{V as re}from"./BSH7BhKc.js";import{V as ue}from"./BkTuXOR_.js";import{V as J}from"./P_q-BwEt.js";import{_ as ce}from"./Cw5ECwNl.js";import{_ as de,u as me}from"./BpnmgVl2.js";const fe={class:"card-content"},ve={class:"play-button-overlay"},he={key:0,class:"content-overlay"},ge={class:"d-flex align-center overlay-content"},pe={class:"text-content"},we={class:"video-title"},ye={key:0,class:"creator-info"},ke={class:"creator-name"},xe={key:1,class:"meta-info"},be={key:0,class:"views"},Be={key:1,class:"date"},Ce="https://via.placeholder.com/450x253",Me=E({__name:"TrendingProjectCard",props:{media:{type:Object,required:!0},size:{type:String,default:"md",validator:e=>["xs","sm","md","lg","xl","2xl"].includes(e)},label:{type:String,default:"Trending"},labelVariant:{type:String,default:"error"},showViews:{type:Boolean,default:!0},showDuration:{type:Boolean,default:!1},showCreator:{type:Boolean,default:!0},showOverlay:{type:Boolean,default:!0},showMeta:{type:Boolean,default:!1},hasElevation:{type:Boolean,default:!0},customHeight:{type:[Number,String],default:null}},emits:["click"],setup(e,{emit:M}){const{mobile:t,smAndDown:f,mdAndDown:k}=ee(),s={xs:{thumbnailSize:"xs",avatarSize:20,titleClass:"text-caption",maxTitleLength:35,titleLines:1},sm:{thumbnailSize:"sm",avatarSize:22,titleClass:"text-body-2",maxTitleLength:45,titleLines:1},md:{thumbnailSize:"md",avatarSize:24,titleClass:"text-subtitle-2",maxTitleLength:55,titleLines:1},lg:{thumbnailSize:"lg",avatarSize:26,titleClass:"text-subtitle-1",maxTitleLength:65,titleLines:1},xl:{thumbnailSize:"xl",avatarSize:28,titleClass:"text-h6",maxTitleLength:75,titleLines:1},"2xl":{thumbnailSize:"2xl",avatarSize:30,titleClass:"text-h5",maxTitleLength:85,titleLines:1}},o=e,r=M,u=d(()=>s[o.size]),x=d(()=>f.value&&o.size==="md"?"sm":f.value&&o.size==="lg"?"md":u.value.thumbnailSize);d(()=>f.value?Math.max(24,u.value.avatarSize-8):u.value.avatarSize),d(()=>u.value.titleClass),d(()=>`lines-${u.value.titleLines}`);const b=d(()=>{if(!o.media.name)return"";const a=o.media.name.trim(),c=u.value.maxTitleLength;return a.length<=c?a:`${a.slice(0,c)}...`}),w=a=>a>=1e6?`${(a/1e6).toFixed(1)}M`:a>=1e3?`${(a/1e3).toFixed(1)}K`:a.toString(),v=a=>{if(!a)return"";const c=new Date(a),C=Math.abs(new Date().getTime()-c.getTime()),g=Math.ceil(C/(1e3*60*60*24));return g<1?"Today":g===1?"Yesterday":g<7?`${g} days ago`:g<30?`${Math.floor(g/7)} weeks ago`:g<365?`${Math.floor(g/30)} months ago`:`${Math.floor(g/365)} years ago`},h=()=>{r("click",o.media)};return(a,c)=>(i(),V(ue,{class:ae(["trending-project-card",[`size-${e.size}`,{"no-elevation":!e.hasElevation}]]),elevation:e.hasElevation?2:0,onClick:h},{default:P(()=>[z("div",fe,[B(Z,{thumbnailUrl:e.media.thumbnail_url||Ce,videoUrl:e.media.video_url,size:x.value,viewsCount:e.media.views_count,showViews:e.showViews,showDuration:e.showDuration,label:e.label,"label-variant":e.labelVariant,onClick:h},null,8,["thumbnailUrl","videoUrl","size","viewsCount","showViews","showDuration","label","label-variant"]),z("div",ve,[B(te,{icon:"mdi-play-circle-outline",size:"x-large"})]),e.showOverlay?(i(),p("div",he,[z("div",ge,[e.showCreator&&e.media.creator?(i(),V(ie,{key:0,size:32,class:"mr-2 creator-avatar"},{default:P(()=>[B(re,{src:e.media.creator.profile_photo,alt:e.media.creator.display_name},null,8,["src","alt"])]),_:1})):$("",!0),z("div",pe,[z("h3",we,T(b.value),1),e.showCreator&&e.media.creator?(i(),p("div",ye,[z("span",ke,T(e.media.creator.display_name),1)])):$("",!0),e.showMeta?(i(),p("div",xe,[D(a.$slots,"meta",{},()=>[e.media.views_count&&!e.showViews?(i(),p("span",be,T(w(e.media.views_count))+" views ",1)):$("",!0),e.media.created_at?(i(),p("span",Be," Â· "+T(v(e.media.created_at)),1)):$("",!0)],!0)])):$("",!0)])])])):$("",!0)]),D(a.$slots,"actions",{},void 0,!0)]),_:3},8,["class","elevation"]))}}),Se=A(Me,[["__scopeId","data-v-6365550c"]]),$e={class:"trending-projects-carousel"},Ve={key:0,class:"d-flex justify-center mt-4"},Pe={key:1,class:"d-flex justify-center mt-4"},je=E({__name:"TrendingProjectsCarousel",props:{projects:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},loadingMore:{type:Boolean,default:!1},error:{type:Boolean,default:!1},errorMessage:{type:String,default:""},navigation:{type:Boolean,default:!0},pagination:{type:Boolean,default:!1},loop:{type:Boolean,default:!1},spaceBetween:{type:Number,default:20},projectLabel:{type:String,default:"Trending"},projectLabelVariant:{type:String,default:"error"},showViews:{type:Boolean,default:!0},showDuration:{type:Boolean,default:!1},showCreator:{type:Boolean,default:!0},preloadThresholdMultiplier:{type:Number,default:2},showMoreButton:{type:Boolean,default:!1},loadMoreText:{type:String,default:"Load More"},hasMore:{type:Boolean,default:!0},customBreakpoints:{type:Object,default:null},skeletonCount:{type:Number,default:0}},emits:["reachEnd","projectClick","loadMore"],setup(e,{emit:M}){const t=e,f=M,k=m(null),{width:s}=O(),o=m(null),r=q({xs:0,sm:600,md:960,lg:1280,xl:1920}),u=r.smaller("sm"),x=r.between("sm","md"),b=r.between("md","lg");r.between("lg","xl"),r.greaterOrEqual("xl");const w=d(()=>s.value<600?1:s.value<960?2:s.value<1280?3:4),v=d(()=>({0:{slidesPerView:1,spaceBetween:16},600:{slidesPerView:2,spaceBetween:20},960:{slidesPerView:3,spaceBetween:24},1280:{slidesPerView:4,spaceBetween:24}})),h=d(()=>t.customBreakpoints||v.value),a=d(()=>u.value?"sm":x.value?"md":b.value?"lg":"xl"),c=d(()=>t.skeletonCount>0?t.skeletonCount:w.value+1),S=d(()=>{if(t.loading&&t.projects.length===0)return Array(c.value).fill(null);const n=[...t.projects];return t.loadingMore&&n.push(...Array(Math.min(c.value,2)).fill(null)),n}),C=n=>{o.value=n},g=n=>{if(!n||t.projects.length===0)return;const y=t.projects.length,j=n.activeIndex,l=w.value*t.preloadThresholdMultiplier;y-j<=l&&!t.loadingMore&&t.hasMore&&f("reachEnd")};return I(()=>{setTimeout(()=>{var n;(n=o.value)==null||n.update()},100)}),N([()=>t.projects,s],()=>{setTimeout(()=>{var n;(n=o.value)==null||n.update()},100)}),(n,y)=>{const j=R,_=F;return i(),p("div",$e,[B(_,{ref_key:"carouselRef",ref:k,navigation:e.navigation,pagination:e.pagination,loop:e.loop,spaceBetween:e.spaceBetween,"slides-per-view":w.value,breakpoints:h.value,loading:e.loading,onSwiper:C,onSlideChange:g,onReachEnd:y[0]||(y[0]=l=>n.$emit("reachEnd"))},{default:P(()=>[(i(!0),p(H,null,X(S.value,(l,L)=>(i(),V(G(U),{key:(l==null?void 0:l.id)||`skeleton-${L}`},{default:P(()=>[l!=null&&l.id?(i(),V(Se,{key:0,media:l,size:a.value,label:e.projectLabel,"label-variant":e.projectLabelVariant,"show-views":e.showViews,"show-duration":e.showDuration,"show-creator":e.showCreator,onClick:Q=>n.$emit("projectClick",l)},null,8,["media","size","label","label-variant","show-views","show-duration","show-creator","onClick"])):(i(),V(j,{key:1,size:a.value},null,8,["size"]))]),_:2},1024))),128))]),_:1},8,["navigation","pagination","loop","spaceBetween","slides-per-view","breakpoints","loading"]),e.error?(i(),p("div",Ve,[B(J,{type:"error",text:e.errorMessage||"Failed to load projects. Please try again later."},null,8,["text"])])):$("",!0),e.showMoreButton&&e.hasMore?(i(),p("div",Pe,[B(W,{color:"primary",disabled:e.loadingMore,loading:e.loadingMore,onClick:y[1]||(y[1]=l=>n.$emit("loadMore"))},{default:P(()=>[K(T(e.loadMoreText),1)]),_:1},8,["disabled","loading"])])):$("",!0),D(n.$slots,"footer",{},void 0,!0)])}}}),ze=A(je,[["__scopeId","data-v-8c3c6d26"]]),Ke=E({__name:"HomeTrendingProjectsCarousel",setup(e){const M=ne(),t=Y(),f=m([]),k=m(!0),s=m(!1),o=m(1),r=m(1),u=m(!1),x=async(v=1)=>{if(!M.$api){console.warn("API plugin not available - skipping fetch"),u.value=!0,k.value=!1;return}if(!((k.value||s.value)&&v!==1))try{u.value=!1,v===1?k.value=!0:s.value=!0;const h=await M.$api.get("/api/trending/projects",{params:{page:v}});if(v===1)f.value=h.data;else{const c=h.data.filter(S=>!f.value.some(C=>C.id===S.id));f.value=[...f.value,...c]}const a=h.meta.meta;r.value=a.last_page,o.value=a.current_page}catch(h){console.error("Failed to fetch trending projects:",h),u.value=!0}finally{k.value=!1,s.value=!1}},b=async()=>{o.value<r.value&&!s.value&&!u.value&&await x(o.value+1)},w=v=>{t.push(`/watch/${v.access_uuid}`)};return I(()=>{x()}),oe(()=>{}),(v,h)=>{const a=ze;return i(),p("div",null,[B(a,{projects:f.value,loading:k.value,loadingMore:s.value,error:u.value,onReachEnd:b,onProjectClick:w},null,8,["projects","loading","loadingMore","error"])])}}}),Te={class:"upcoming-projects-carousel"},_e={key:0,class:"d-flex justify-center mt-4"},Le={key:1,class:"d-flex justify-center mt-4"},Ee=E({__name:"UpcomingProjectsCarousel",props:{projects:{type:Array,default:()=>[]},loading:{type:Boolean,default:!1},loadingMore:{type:Boolean,default:!1},error:{type:Boolean,default:!1},errorMessage:{type:String,default:""},navigation:{type:Boolean,default:!0},pagination:{type:Boolean,default:!1},loop:{type:Boolean,default:!1},spaceBetween:{type:Number,default:20},preloadThresholdMultiplier:{type:Number,default:2},showMoreButton:{type:Boolean,default:!1},loadMoreText:{type:String,default:"Load More"},hasMore:{type:Boolean,default:!0},customBreakpoints:{type:Object,default:null},skeletonCount:{type:Number,default:0}},emits:["reachEnd","projectClick","loadMore"],setup(e,{emit:M}){const t=e,f=M,k=m(null),{width:s}=O(),o=m(null),r=q({xs:0,sm:600,md:960,lg:1280,xl:1920}),u=r.smaller("sm"),x=r.between("sm","md"),b=r.between("md","lg");r.between("lg","xl"),r.greaterOrEqual("xl");const w=d(()=>u.value?1:x.value?2:3),v=d(()=>({0:{slidesPerView:1,spaceBetween:10},600:{slidesPerView:2,spaceBetween:15},960:{slidesPerView:3,spaceBetween:20}})),h=d(()=>t.customBreakpoints||v.value),a=d(()=>u.value?"sm":x.value?"md":b.value?"lg":"xl"),c=d(()=>t.skeletonCount>0?t.skeletonCount:w.value+1),S=d(()=>{if(t.loading&&t.projects.length===0)return Array(c.value).fill(null);const n=[...t.projects];return t.loadingMore&&n.push(...Array(Math.min(c.value,2)).fill(null)),n}),C=n=>{o.value=n},g=n=>{if(!n||t.projects.length===0)return;const y=t.projects.length,j=n.activeIndex,l=w.value*t.preloadThresholdMultiplier;y-j<=l&&!t.loadingMore&&t.hasMore&&f("reachEnd")};return I(()=>{setTimeout(()=>{var n;(n=o.value)==null||n.update()},100)}),N([()=>t.projects,s],()=>{setTimeout(()=>{var n;(n=o.value)==null||n.update()},100)}),(n,y)=>{const j=R,_=F;return i(),p("div",Te,[B(_,{ref_key:"carouselRef",ref:k,navigation:e.navigation,pagination:e.pagination,loop:e.loop,spaceBetween:e.spaceBetween,"slides-per-view":w.value,breakpoints:h.value,loading:e.loading,onSwiper:C,onSlideChange:g,onReachEnd:y[0]||(y[0]=l=>n.$emit("reachEnd"))},{default:P(()=>[(i(!0),p(H,null,X(S.value,(l,L)=>(i(),V(G(U),{key:(l==null?void 0:l.id)||`skeleton-${L}`},{default:P(()=>[l!=null&&l.id?(i(),V(de,{key:0,premiere:l,loading:!1,showPremiereBadge:!0,onClick:Q=>n.$emit("projectClick",l)},null,8,["premiere","onClick"])):(i(),V(j,{key:1,size:a.value},null,8,["size"]))]),_:2},1024))),128))]),_:1},8,["navigation","pagination","loop","spaceBetween","slides-per-view","breakpoints","loading"]),e.error?(i(),p("div",_e,[B(J,{type:"error",text:e.errorMessage||"Failed to load projects. Please try again later."},null,8,["text"])])):$("",!0),e.showMoreButton&&e.hasMore?(i(),p("div",Le,[B(W,{color:"primary",disabled:e.loadingMore,loading:e.loadingMore,onClick:y[1]||(y[1]=l=>n.$emit("loadMore"))},{default:P(()=>[K(T(e.loadMoreText),1)]),_:1},8,["disabled","loading"])])):$("",!0),D(n.$slots,"footer",{},void 0,!0)])}}}),De=A(Ee,[["__scopeId","data-v-48e763a7"]]),We=E({__name:"HomeUpcomingProjectsCarousel",emits:["has-data","loading"],setup(e,{emit:M}){const t=M,f=Y(),{fetchUpcomingPremieres:k}=me(),s=m([]),o=m(!0),r=m(!1),u=m(1),x=m(1),b=m(!1);N(s,a=>{t("has-data",a.length>0)}),N(o,a=>{t("loading",a)});const w=async(a=1)=>{if(!((o.value||r.value)&&a!==1))try{b.value=!1,a===1?(o.value=!0,t("loading",!0)):r.value=!0;const c=await k(a);if(a===1)s.value=c.data;else{const S=c.data.filter(C=>!s.value.some(g=>g.id===C.id));s.value=[...s.value,...S]}x.value=c.meta.last_page,u.value=c.meta.current_page,t("has-data",s.value.length>0)}catch(c){console.error("Failed to fetch upcoming premieres:",c),b.value=!0,t("has-data",!1)}finally{o.value=!1,r.value=!1,t("loading",!1)}},v=async()=>{u.value<x.value&&!r.value&&!b.value&&await w(u.value+1)},h=a=>{f.push(`/watch/${a.access_uuid}`)};return I(()=>{w()}),(a,c)=>{const S=ce,C=De;return le((i(),p("div",null,[B(S,{title:"Upcoming Premieres"}),B(C,{projects:s.value,loading:o.value,loadingMore:r.value,error:b.value,onReachEnd:v,onProjectClick:h},null,8,["projects","loading","loadingMore","error"])],512)),[[se,!o.value||s.value.length>0]])}}});export{Ke as _,We as a};
