import{d as te,b as J,V as T,a as ae,c as me}from"./BkTuXOR_.js";import{n as se,o as y,m as R,p as t,w as s,s as I,b as i,J as je,v as j,cF as Ve,V as K,_ as Z,a as C,M as xe,y as Q,g as G,j as V,t as oe,x as H,O as ne,q as F,f as Se,c as q,l as $e,F as ie,D as ue,A as we}from"./CGQimWOm.js";import{V as U}from"./CS8xUUzH.js";import{V as X}from"./xvVMJZi9.js";import{V as B}from"./CRY4crBU.js";import{_ as ke}from"./Cw5ECwNl.js";import{_ as Ce}from"./Cxb8uY_z.js";import{_ as Pe}from"./CMYBLF1p.js";import{_ as Ae}from"./BeQTM7t9.js";import{_ as Ee}from"./3ysVR2RL.js";import{_ as Le}from"./DL649WMo.js";import{u as De}from"./Bz9a9m5j.js";import{V as Ne}from"./C9TGCd7W.js";import{V as de,a as Me}from"./tTgLLTve.js";import{V as fe}from"./BSH7BhKc.js";import{a as Ue}from"./DsvAftJq.js";import{V as _e}from"./BcH3Kywr.js";import{V as ge}from"./GXZRJwQ4.js";import{V as qe}from"./6HtF_owb.js";import{V as he}from"./P_q-BwEt.js";import{V as ce}from"./BvtSni_j.js";import{V as Te,a as ve}from"./D9lJKT5N.js";import{V as Fe}from"./CMsVONS5.js";import{_ as ze}from"./DM0UXmJz.js";import{u as Be}from"./DMBY-Kaj.js";import{u as Re}from"./De3D2xlH.js";import{V as We}from"./f5lwX8SZ.js";import{V as pe}from"./D4pNkYCe.js";import{V as Oe}from"./BhN2__aY.js";const He={class:"mt-4"},Je={class:"progress-container"},Qe={class:"text-h5 mt-2"},Ye={class:"text-h5 mt-2"},Ge={class:"text-h5 mt-2"},Ke=se({__name:"ProjectInvestorSharePercentageTracker",props:{stats:{}},setup(v){return(u,e)=>(y(),R("div",null,[t(T,{elevation:"10",class:"mb-4"},{default:s(()=>[t(te,null,{default:s(()=>[t(J,{class:"text-h6"},{default:s(()=>e[0]||(e[0]=[I(" Project Investors Share Distribution ")])),_:1}),i("div",He,[e[1]||(e[1]=i("div",{class:"d-flex justify-space-between mb-1"},[i("span",{class:"text-caption"},"Creator Share"),i("span",{class:"text-caption"},"Investor Share")],-1)),i("div",Je,[t(je,{"model-value":u.stats.creator_shares,height:"24",color:"primary",rounded:""},{default:s(()=>[i("strong",null,j(u.stats.creator_shares)+"%",1)]),_:1},8,["model-value"]),i("div",{class:"investor-share-overlay",style:Ve({width:`${u.stats.investor_shares}%`})},[i("strong",null,j(u.stats.investor_shares)+"%",1)],4)])])]),_:1})]),_:1}),t(B,null,{default:s(()=>[t(U,{cols:"12",sm:"4"},{default:s(()=>[t(T,{elevation:"10",class:"stat-card"},{default:s(()=>[t(te,null,{prepend:s(()=>[t(X,{color:"primary",variant:"tonal"},{default:s(()=>[t(K,{icon:"mdi-account-star"})]),_:1})]),default:s(()=>[t(J,null,{default:s(()=>[e[2]||(e[2]=I(" Creator Shares ")),i("div",Qe,j(u.stats.creator_shares)+"%",1)]),_:1})]),_:1})]),_:1})]),_:1}),t(U,{cols:"12",sm:"4"},{default:s(()=>[t(T,{elevation:"10",class:"stat-card"},{default:s(()=>[t(te,null,{prepend:s(()=>[t(X,{color:"success",variant:"tonal"},{default:s(()=>[t(K,{icon:"mdi-account-group"})]),_:1})]),default:s(()=>[t(J,null,{default:s(()=>[e[3]||(e[3]=I(" Investor Shares ")),i("div",Ye,j(u.stats.investor_shares)+"%",1)]),_:1})]),_:1})]),_:1})]),_:1}),t(U,{cols:"12",sm:"4"},{default:s(()=>[t(T,{elevation:"10",class:"stat-card"},{default:s(()=>[t(te,null,{prepend:s(()=>[t(X,{color:"info",variant:"tonal"},{default:s(()=>[t(K,{icon:"mdi-account-multiple"})]),_:1})]),default:s(()=>[t(J,null,{default:s(()=>[e[4]||(e[4]=I(" Total Investors ")),i("div",Ge,j(u.stats.total_investors),1)]),_:1})]),_:1})]),_:1})]),_:1})]),_:1})]))}}),Xe=Z(Ke,[["__scopeId","data-v-99942dd1"]]),Ze={class:"project-investor-card__content"},et={class:"project-investor-card__profile"},tt={key:2,class:"missing-investorable"},st={class:"project-investor-card__info"},rt={class:"text-h6 font-weight-medium mb-1"},at={class:"text-subtitle-2 text-medium-emphasis d-flex align-center"},ot={class:"project-investor-card__details"},nt={class:"project-investor-card__share"},lt={class:"share-percentage"},it={class:"text-h5 font-weight-bold"},ut={class:"project-investor-card__actions"},dt=se({__name:"ProjectInvestorCard",props:{investor:{}},setup(v){const u=e=>e.toFixed(2);return(e,r)=>{const x=Pe,p=Ae,o=Ee,m=Le;return e.investor?(y(),C(m,{key:0,class:"project-investor-card"},{default:s(()=>{var f,$,_,P;return[i("div",Ze,[i("div",et,[e.investor.investorable_type.endsWith("Page")&&e.investor.investorable!==null?(y(),C(x,{key:0,page:e.investor.investorable,size:"lg",class:"project-investor-card__avatar"},null,8,["page"])):e.investor.investorable_type.endsWith("User")&&e.investor.investorable!==null?(y(),C(p,{key:1,username:e.investor.investorable.username||"",profile_photo:e.investor.investorable.profile_photo||"",size:"lg",class:"project-investor-card__avatar"},null,8,["username","profile_photo"])):(y(),R("div",tt,r[0]||(r[0]=[i("p",null,"Unknown or missing investor data",-1)]))),i("div",st,[i("h3",rt,j(((f=e.investor.investorable)==null?void 0:f.display_name)||(($=e.investor.investorable)==null?void 0:$.name)||"N/A"),1),i("span",at,[t(K,{size:"small",class:"mr-1"},{default:s(()=>r[1]||(r[1]=[I("mdi-at")])),_:1}),I(" "+j(((_=e.investor.investorable)==null?void 0:_.username)||((P=e.investor.investorable)==null?void 0:P.slug)||"N/A"),1)])])]),i("div",ot,[i("div",nt,[i("div",lt,[i("span",it,j(u(e.investor.share_percentage)),1),r[2]||(r[2]=i("span",{class:"text-subtitle-1 text-medium-emphasis"},"%",-1))]),r[3]||(r[3]=i("span",{class:"text-caption text-medium-emphasis"}," Share Percentage ",-1))]),t(o,{status:e.investor.status,class:"project-investor-card__status"},null,8,["status"])]),i("div",ut,[xe(e.$slots,"actions",{},void 0,!0)])])]}),_:3})):Q("",!0)}}}),ct=Z(dt,[["__scopeId","data-v-a90a04d4"]]),vt={__name:"InvestorSearch",props:{placeholder:{type:String,default:"Search for investors by name"},minSearchLength:{type:Number,default:2},debounceMs:{type:Number,default:300},filterType:{type:String,default:null,validator:v=>v===null||["user","page"].includes(v)}},emits:["user-selected","page-selected","item-selected"],setup(v,{emit:u}){const e=v,r=u,{$axios:x}=G(),{debounce:p}=De(),o=V(""),m=V([]),f=V(null),$=V(!1),_=V(!1),P=V(!1),A=V(""),L=V(!1),z=p(async c=>{var g,h;if(o.value=c,!c||c.trim().length<e.minSearchLength){m.value=[],L.value=!1;return}try{$.value=!0,L.value=!0;const l=await x.get("/api/search/investors",{params:{query:c.trim(),limit:10,type:e.filterType}});m.value=l.data.data||[],L.value&&m.value.length===0&&c.trim().length>=e.minSearchLength&&!_.value?_.value=!0:m.value.length>0&&(_.value=!1)}catch(l){console.error("Search error:",l),A.value=((h=(g=l.response)==null?void 0:g.data)==null?void 0:h.message)||"An error occurred while searching",P.value=!0,m.value=[]}finally{$.value=!1}},e.debounceMs,"search"),D=c=>{c&&(c.type==="user"?r("user-selected",c):r("page-selected",c),r("item-selected",c),setTimeout(()=>{f.value=null,o.value="",L.value=!1},100))},Y=()=>{o.value="",m.value=[],f.value=null,L.value=!1,_.value=!1},W=c=>c.type==="user"?c.profile_photo||"/default-avatar.png":c.avatar_url||"/default-avatar.png",M=c=>c.type==="user"?c.name||c.display_name||c.username:c.name||c.display_name||"",O=c=>c.type==="user"?`@${c.username}`:`@${c.slug}`;return oe(o,c=>{(!c||c.trim()==="")&&(m.value=[],_.value=!1)}),(c,g)=>(y(),C(T,{class:"investor-search",flat:""},{default:s(()=>[t(ae,null,{default:s(()=>[t(Ne,{modelValue:f.value,"onUpdate:modelValue":[g[0]||(g[0]=h=>f.value=h),D],loading:$.value,items:m.value,"search-input":o.value,"onUpdate:search":H(z),placeholder:v.placeholder,"prepend-inner-icon":"mdi-magnify","item-title":"name","item-value":"id","return-object":"","hide-details":"",variant:"outlined",density:"comfortable",clearable:"","no-filter":"","onClick:clear":Y},{"no-data":s(()=>[t(de,null,{default:s(()=>[t(Me,null,{default:s(()=>[I(j(v.minSearchLength?`Type at least ${v.minSearchLength} characters to search`:"Start typing to search"),1)]),_:1})]),_:1})]),item:s(({item:h,props:l})=>[t(de,ne(l,{title:M(h.raw),subtitle:O(h.raw)}),{prepend:s(()=>[t(X,{size:"36",color:"grey-lighten-3"},{default:s(()=>[t(fe,{src:W(h.raw),alt:M(h.raw)},null,8,["src","alt"])]),_:2},1024)]),append:s(()=>[t(Ue,{size:"small",color:h.raw.type==="user"?"primary":"secondary","text-color":"white",class:"ml-2"},{default:s(()=>[I(j(h.raw.type==="user"?"User":"Page"),1)]),_:2},1032,["color"])]),_:2},1040,["title","subtitle"])]),_:1},8,["modelValue","loading","items","search-input","onUpdate:search","placeholder"])]),_:1}),t(_e,{modelValue:_.value,"onUpdate:modelValue":g[2]||(g[2]=h=>_.value=h),"max-width":"300"},{default:s(()=>[t(T,null,{default:s(()=>[t(J,{class:"text-h6"},{default:s(()=>g[4]||(g[4]=[I("No Results Found")])),_:1}),t(ae,null,{default:s(()=>g[5]||(g[5]=[I(" No investors found matching your search criteria. ")])),_:1}),t(me,null,{default:s(()=>[t(ge),t(F,{color:"primary",onClick:g[1]||(g[1]=h=>_.value=!1)},{default:s(()=>g[6]||(g[6]=[I(" Close ")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"]),t(qe,{modelValue:P.value,"onUpdate:modelValue":g[3]||(g[3]=h=>P.value=h),color:"error",timeout:3e3},{default:s(()=>[I(j(A.value),1)]),_:1},8,["modelValue"])]),_:1}))}},pt=Z(vt,[["__scopeId","data-v-ad070cbe"]]),ye=Se("projectInvestors",{state:()=>({projectInvestors:[],stats:null,meta:null,isLoading:!1,error:null}),getters:{hasMore:v=>v.meta?v.meta.current_page<v.meta.last_page:!1},actions:{async fetchProjectInvestors(v,u=1,e=15){var r,x;this.isLoading=u===1,this.error=null;try{const{$axios:p}=G(),o=await p.get(`/api/projects/${v}/project_investors`,{params:{page:u,per_page:e}});u===1?this.projectInvestors=o.data.data:this.projectInvestors=[...this.projectInvestors,...o.data.data];const m=((r=o.data.meta)==null?void 0:r.total)??0,f=((x=o.data.meta)==null?void 0:x.pages)??1;this.meta={total:m,pages:f,current_page:u,last_page:f},o.data.stats&&(this.stats=o.data.stats)}catch(p){throw this.error=this.extractErrorMessage(p),console.error(p),p}finally{this.isLoading=!1}},async createProjectInvestor(v,u){this.isLoading=!0,this.error=null;try{const{$axios:e}=G(),r=await e.post(`/api/projects/${v}/project_investors`,u),x=r.data.data;return this.projectInvestors.push(x),this.meta&&typeof this.meta.total=="number"&&this.meta.total++,r.data.stats&&(this.stats=r.data.stats),r.data}catch(e){throw console.error("Error creating project investor:",e),this.error=this.extractErrorMessage(e),e}finally{this.isLoading=!1}},async updateProjectInvestor(v,u,e){this.isLoading=!0,this.error=null;try{const{$axios:r}=G(),x=await r.put(`/api/projects/${v}/project_investors/${u}`,e),p=x.data.data,o=this.projectInvestors.findIndex(m=>m.id===u);return o!==-1&&(this.projectInvestors[o]={...this.projectInvestors[o],...p}),x.data.stats&&(this.stats=x.data.stats),x.data}catch(r){throw console.error("Error updating project investor:",r),this.error=this.extractErrorMessage(r),r}finally{this.isLoading=!1}},async deleteProjectInvestor(v,u){this.isLoading=!0,this.error=null;try{if(!v||!u)throw new Error("Missing required parameters");const{$axios:e}=G();await e.delete(`/api/projects/${v}/project_investors/${u}`),this.projectInvestors=this.projectInvestors.filter(r=>r.id!==u),this.meta&&typeof this.meta.total=="number"&&this.meta.total--;try{const r=await e.get(`/api/projects/${v}/project_investors/stats`);r.data.stats&&(this.stats=r.data.stats)}catch(r){console.warn("Could not fetch updated stats",r)}}catch(e){throw console.error("Error deleting project investor:",e),this.error=this.extractErrorMessage(e),e}finally{this.isLoading=!1}},extractErrorMessage(v){let u="Failed to complete the operation. Please try again.";if(!v.response)return u;const e=v.response.data;if(e.message)return e.message;if(e.errors&&typeof e.errors=="object"){const r=Object.keys(e.errors)[0];if(r&&Array.isArray(e.errors[r])&&e.errors[r][0])return e.errors[r][0]}return u},resetState(){this.projectInvestors=[],this.stats=null,this.meta=null,this.isLoading=!1,this.error=null}}}),mt={class:"text-h5 mb-1"},ft={class:"text-body-2 text-grey mb-0"},_t={class:"d-flex align-center"},gt={key:1,class:"text-h6 white--text"},ht={class:"text-subtitle-1 font-weight-medium"},yt={class:"text-caption text-grey"},bt={class:"text-caption text-primary"},It=se({__name:"AddProjectInvestorDialog",props:{modelValue:{type:Boolean},accessUuid:{},editingInvestor:{}},emits:["update:modelValue","investor-added","investor-updated"],setup(v,{emit:u}){const e=v,r=u,x=ye(),p=V(1),o=V(null),m=V(0),f=V(!1),$=V(""),_=V(""),P=q({get:()=>e.modelValue,set:l=>r("update:modelValue",l)}),A=q(()=>!!e.editingInvestor),L=q(()=>{var n,w;if(!o.value)return!1;const l=Number(m.value);if(isNaN(l)||l<=0||l>100)return!1;if(A.value&&e.editingInvestor){const a=parseFloat(l.toFixed(2)),d=parseFloat(e.editingInvestor.share_percentage.toFixed(2));return a!==d||((n=o.value)==null?void 0:n.id)!==((w=e.editingInvestor.investorable)==null?void 0:w.id)}return!0}),z=[l=>l!==""||"Equity percentage is required",l=>{const n=typeof l=="string"?parseFloat(l):l;return isNaN(n)?"Please enter a valid number":n>0&&n<=100||"Equity must be between 0.01 and 100%"}];oe(()=>e.modelValue,l=>{if(l&&e.editingInvestor){const n=e.editingInvestor.investorable_type.toLowerCase().includes("user")?"user":"page";o.value={...e.editingInvestor.investorable,type:n},m.value=Number(e.editingInvestor.share_percentage),p.value=2}else l||h()}),oe(()=>e.editingInvestor,l=>{if(l){const n=l.investorable_type.toLowerCase().includes("user")?"user":"page";o.value={...l.investorable,type:n},m.value=Number(l.share_percentage),p.value=2}},{immediate:!0});function D(){return o.value?o.value.type==="user"?o.value.name||o.value.display_name||"":o.value.name||"":""}function Y(l){return l?l.split(" ").map(n=>n[0]).join("").toUpperCase().slice(0,2):""}function W(l){o.value={...l},p.value=2}function M(){_.value="",$.value=""}function O(l){var a;M();let n="An error occurred. Please try again.";const w=(a=l.response)==null?void 0:a.data;if(w)if(w.errors){const d=w.errors,b=[];d.share_percentage&&($.value=d.share_percentage[0],b.push(`Equity: ${d.share_percentage[0]}`)),d.investorable_id&&b.push(d.investorable_id[0]),d.investorable_type&&b.push(d.investorable_type[0]);const S=Object.entries(d).filter(([k])=>!["share_percentage","investorable_id","investorable_type"].includes(k)).map(([k,E])=>`${k}: ${E[0]}`);S.length>0&&b.push(...S),b.length>0&&(_.value=b.join(". "))}else w.message&&(_.value=w.message);!_.value&&!$.value&&(_.value=n)}async function c(){var l;if(!(!L.value||!o.value)){f.value=!0,M();try{const n=Number(m.value),w=o.value.type==="user"?"App\\Models\\User":"App\\Models\\Page",a=parseFloat(n.toFixed(2));if(isNaN(a)||a<=0||a>100){$.value="Please enter a valid equity percentage between 0.01 and 100";return}A.value&&e.editingInvestor?(await x.updateProjectInvestor(e.accessUuid,e.editingInvestor.id,{share_percentage:a,...o.value.id!==((l=e.editingInvestor.investorable)==null?void 0:l.id)?{investorable_type:w,investorable_id:o.value.id}:{}}),r("investor-updated")):(await x.createProjectInvestor(e.accessUuid,{investorable_type:w,investorable_id:o.value.id,share_percentage:a}),r("investor-added")),g()}catch(n){O(n)}finally{f.value=!1}}}function g(){P.value=!1,h()}function h(){p.value=1,o.value=null,m.value=0,M(),f.value=!1}return(l,n)=>{const w=pt;return y(),C(_e,{modelValue:P.value,"onUpdate:modelValue":n[5]||(n[5]=a=>P.value=a),"max-width":"600px",persistent:""},{default:s(()=>[t(T,null,{default:s(()=>[t(J,{class:"d-flex justify-space-between align-center pa-4"},{default:s(()=>[i("div",null,[i("h2",mt,j(A.value?"Edit Investor":"Add Investor"),1),i("p",ft,j(A.value?"Modify this investor's share in your project":"Add a new investor to your project"),1)]),t(F,{icon:"",variant:"text",onClick:g},{default:s(()=>[t(K,null,{default:s(()=>n[6]||(n[6]=[I("mdi-close")])),_:1})]),_:1})]),_:1}),_.value?(y(),C(he,{key:0,type:"error",variant:"tonal",closable:"",class:"mx-4 mt-2","onClick:close":n[0]||(n[0]=a=>_.value="")},{default:s(()=>[I(j(_.value),1)]),_:1})):Q("",!0),t(ce),t(ae,{class:"pa-4"},{default:s(()=>[t(Te,{modelValue:p.value,"onUpdate:modelValue":n[3]||(n[3]=a=>p.value=a)},{default:s(()=>[t(ve,{value:1},{default:s(()=>[n[7]||(n[7]=i("div",{class:"mb-4"},[i("h3",{class:"text-h6 mb-2"},"Search Investor"),i("p",{class:"text-body-2 text-grey-darken-1"}," Search for an investor to add to your project. ")],-1)),t(w,{"min-search-length":2,"debounce-ms":300,onUserSelected:W,onPageSelected:W})]),_:1}),t(ve,{value:2},{default:s(()=>[n[10]||(n[10]=i("div",{class:"mb-6"},[i("h3",{class:"text-h6 mb-2"},"Set Investor Equity"),i("p",{class:"text-body-2 text-grey-darken-1"}," Define the equity percentage for this investor. They will receive this percentage of project earnings. ")],-1)),t(T,{variant:"outlined",class:"mb-6 pa-3"},{default:s(()=>{var a,d,b;return[i("div",_t,[t(X,{size:"40",color:"primary",class:"mr-3"},{default:s(()=>{var S,k,E,ee;return[(S=o.value)!=null&&S.avatar_url||(k=o.value)!=null&&k.profile_photo?(y(),C(fe,{key:0,src:((E=o.value)==null?void 0:E.avatar_url)||((ee=o.value)==null?void 0:ee.profile_photo),alt:D()},null,8,["src","alt"])):(y(),R("span",gt,j(Y(D())),1))]}),_:1}),i("div",null,[i("div",ht,j(D()),1),i("div",yt," @"+j(((a=o.value)==null?void 0:a.slug)||((d=o.value)==null?void 0:d.username)),1),i("div",bt,j(((b=o.value)==null?void 0:b.type)==="user"?"User":"Page"),1)]),t(F,{variant:"text",color:"primary",class:"ml-auto",onClick:n[1]||(n[1]=S=>p.value=1)},{default:s(()=>n[8]||(n[8]=[I(" Change ")])),_:1})])]}),_:1}),t(Fe,{modelValue:m.value,"onUpdate:modelValue":[n[2]||(n[2]=a=>m.value=a),M],modelModifiers:{number:!0},label:"Equity Percentage",type:"number",min:"0",max:"100",step:"0.01",rules:z,required:"",variant:"outlined","error-messages":$.value,hint:"Enter the percentage of project earnings this investor will receive","persistent-hint":"",class:"mb-2"},{append:s(()=>n[9]||(n[9]=[i("span",{class:"text-grey"},"%",-1)])),_:1},8,["modelValue","error-messages"])]),_:1})]),_:1},8,["modelValue"])]),_:1}),t(ce),t(me,{class:"pa-4"},{default:s(()=>[p.value===2?(y(),C(F,{key:0,variant:"outlined",onClick:n[4]||(n[4]=a=>p.value=1),class:"mr-2"},{default:s(()=>n[11]||(n[11]=[I(" Back ")])),_:1})):Q("",!0),t(ge),p.value===2?(y(),C(F,{key:1,color:"primary",loading:f.value,disabled:!L.value||f.value,onClick:c},{default:s(()=>[I(j(A.value?"Update Investor":"Add Investor"),1)]),_:1},8,["loading","disabled"])):Q("",!0)]),_:1})]),_:1})]),_:1},8,["modelValue"])}}}),jt=Z(It,[["__scopeId","data-v-b2c15a68"]]),Vt={class:"project-investors-page"},xt={key:2},St=se({__name:"AddProjectInvestors",props:{project:{}},setup(v){const u=v,e=ye(),r=Be(),x=q(()=>e.stats||{creator_shares:100,investor_shares:0,total_investors:0}),p=V(!1),o=V(!1),m=V(null),f=V(null),$=V(!1);async function _(a){var S;if(!((S=u.project)!=null&&S.access_uuid))return[];const d=e.projectInvestors.length;return await e.fetchProjectInvestors(u.project.access_uuid,a,10),e.projectInvestors.slice(d)}const{items:P,isLoading:A,hasMore:L,refresh:z}=Re(_,{initialLoadDelay:0}),D=q(()=>P.value),Y=q(()=>D.value.length===0&&!A.value),W=q(()=>{var S,k,E;const a=(S=f.value)==null?void 0:S.investorable;if(!a)return"Remove Investor";const d=((E=(k=f.value)==null?void 0:k.investorable_type)==null?void 0:E.toLowerCase())||"";let b;return d.includes("user")?b=a.name||a.display_name||a.username||"Investor":b=a.display_name||a.name||a.slug||"Investor",`Remove ${b}`}),M=q(()=>{var S,k,E;const a=(S=f.value)==null?void 0:S.investorable;if(!a)return"Are you sure you want to remove this investor from the project?";const d=((E=(k=f.value)==null?void 0:k.investorable_type)==null?void 0:E.toLowerCase())||"";let b;return d.includes("user")?b=a.name||a.display_name||a.username||"this investor":b=a.display_name||a.name||a.slug||"this investor",`Are you sure you want to remove ${b} from the project?`});$e(()=>{e.resetState()});function O(){m.value=null,p.value=!0}function c(a){m.value=a,p.value=!0}function g(a){f.value=a,o.value=!0}function h(){o.value=!1,f.value=null}function l(){r.success("Project investor added successfully."),e.resetState(),z()}function n(){r.success("Project investor updated successfully."),e.resetState(),z()}async function w(){var a;if(!(!f.value||!((a=u.project)!=null&&a.access_uuid))){$.value=!0;try{const d=f.value.id;if(!d){r.error("Invalid investor information. Please try again.");return}await e.deleteProjectInvestor(u.project.access_uuid,d),r.success("Project investor removed successfully."),e.resetState(),z()}catch(d){console.error("Error deleting investor:",d),r.error("Failed to remove project investor. Please try again.")}finally{$.value=!1,h()}}}return(a,d)=>{var le;const b=Xe,S=ke,k=Ce,E=ct,ee=jt,be=ze;return y(),R("div",Vt,[t(B,{class:"mb-4"},{default:s(()=>[t(U,{cols:"12"},{default:s(()=>[t(b,{stats:x.value},null,8,["stats"])]),_:1})]),_:1}),t(S,{title:"Investors"},{subtitle:s(()=>d[2]||(d[2]=[I(" Manage project investors and their equity shares. When your project earns revenue, profits are automatically distributed based on each investor's percentage allocation. ")])),actionable:s(()=>[t(F,{color:"primary","prepend-icon":"mdi-account-plus",onClick:O,disabled:H(e).isLoading},{default:s(()=>d[3]||(d[3]=[I(" Add Investor ")])),_:1},8,["disabled"])]),_:1}),t(Oe,null,{default:s(()=>[H(A)&&D.value.length===0?(y(),C(B,{key:0},{default:s(()=>[t(U,{cols:"12"},{default:s(()=>[(y(),R(ie,null,ue(3,N=>t(We,{key:N,type:"card",class:"mb-4"})),64))]),_:1})]),_:1})):Y.value?(y(),C(B,{key:1},{default:s(()=>[t(U,{cols:"12"},{default:s(()=>[t(k,{icon:"mdi-account-group","icon-size":"64","icon-color":"grey-lighten-1",title:"No Investors Yet",message:"This project doesn't have any investors at the moment.","button-text":"Add an Investor","button-color":"primary",onActionClick:O})]),_:1})]),_:1})):(y(),R("div",xt,[t(B,null,{default:s(()=>[(y(!0),R(ie,null,ue(D.value,N=>(y(),C(U,{cols:"12",key:N.id},{default:s(()=>[t(E,{investor:N},{actions:s(()=>[t(pe,{text:"Edit Investor",location:"top"},{activator:s(({props:re})=>[t(F,ne({ref_for:!0},re,{icon:"mdi-pencil",variant:"tonal",color:"primary",size:"small",onClick:Ie=>c(N)}),null,16,["onClick"])]),_:2},1024),t(pe,{text:"Remove Investor",location:"top"},{activator:s(({props:re})=>[t(F,ne({ref_for:!0},re,{icon:"mdi-delete",variant:"tonal",color:"error",size:"small",onClick:Ie=>g(N)}),null,16,["onClick"])]),_:2},1024)]),_:2},1032,["investor"])]),_:2},1024))),128))]),_:1}),H(A)&&H(L)?(y(),C(B,{key:0},{default:s(()=>[t(U,{cols:"12",class:"text-center py-4"},{default:s(()=>[t(we,{indeterminate:"",color:"primary",size:"24"})]),_:1})]),_:1})):Q("",!0),!H(L)&&D.value.length>0?(y(),C(B,{key:1},{default:s(()=>[t(U,{cols:"12",class:"text-center py-4"},{default:s(()=>[t(he,{type:"info",variant:"tonal",class:"ma-0"},{default:s(()=>d[4]||(d[4]=[I(" No more investors to load. ")])),_:1})]),_:1})]),_:1})):Q("",!0)]))]),_:1}),t(ee,{modelValue:p.value,"onUpdate:modelValue":d[0]||(d[0]=N=>p.value=N),"access-uuid":(le=a.project)==null?void 0:le.access_uuid,"editing-investor":m.value,onInvestorAdded:l,onInvestorUpdated:n},null,8,["modelValue","access-uuid","editing-investor"]),t(be,{modelValue:o.value,"onUpdate:modelValue":d[1]||(d[1]=N=>o.value=N),title:W.value,message:M.value,loading:$.value,onConfirm:w,onCancel:h},null,8,["modelValue","title","message","loading"])])}}}),ts=Z(St,[["__scopeId","data-v-64aa1cb8"]]);export{ts as _};
