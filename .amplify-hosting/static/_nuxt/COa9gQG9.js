import{n as b,u as V,k as w,i as S,j as u,l as A,g as C,o as a,m as N,p,w as d,a as i,b as f,v as h,s as P,q as R,y as q,A as B,V as _,_ as E}from"./CGQimWOm.js";import{u as T}from"./Cnu3A9hV.js";import{V as z}from"./BkTuXOR_.js";import{V as I}from"./BhN2__aY.js";import"./xvVMJZi9.js";import"./BSH7BhKc.js";/* empty css        */const $={class:"social-callback-page"},j={class:"text-h6 mb-2"},D={class:"text-body-2 text-medium-emphasis mb-4"},L=b({__name:"callback",setup(M){const o=V(),n=w(),g=S(),v=T(),l=u(!0),r=u(!1),c=u("Processing your authentication..."),y=()=>{n.push("/login")};return A(async()=>{try{const s=o.params.provider,t=o.query.code,k=o.query.state,m=o.query.error;if(m)throw new Error(`Authentication failed: ${m}`);if(!t)throw new Error("No authorization code received");const{$axios:x}=C(),e=(await x.get(`/auth/social/${s}/callback`,{params:{code:t,state:k}})).data;if(e.requires_personal_info)c.value="Please complete your profile information",v.setSocialRegistration({userId:e.user_id,socialData:e.social_data,isSocial:!0}),setTimeout(()=>{n.push("/register")},2e3);else if(e.user&&e.token)c.value="Login successful! Redirecting...",await g.handleRegistrationSuccess({user:e.user,token:e.token}),setTimeout(()=>{n.push("/")},2e3);else throw new Error("Unexpected response from server")}catch(s){console.error("Social auth callback error:",s),r.value=!0,c.value=s.message||"Authentication failed. Please try again."}finally{l.value=!1}}),(s,t)=>(a(),N("div",$,[p(I,{class:"d-flex justify-center align-center min-vh-100"},{default:d(()=>[p(z,{class:"pa-8 text-center","max-width":"400",elevation:"2"},{default:d(()=>[l.value?(a(),i(B,{key:0,indeterminate:"",color:"primary",size:"64",class:"mb-4"})):r.value?(a(),i(_,{key:1,icon:"mdi-alert-circle",color:"error",size:"64",class:"mb-4"})):(a(),i(_,{key:2,icon:"mdi-check-circle",color:"success",size:"64",class:"mb-4"})),f("h2",j,h(l.value?"Processing...":r.value?"Authentication Failed":"Success!"),1),f("p",D,h(c.value),1),r.value?(a(),i(R,{key:3,color:"primary",variant:"outlined",onClick:y},{default:d(()=>t[0]||(t[0]=[P(" Try Again ")])),_:1})):q("",!0)]),_:1})]),_:1})]))}}),W=E(L,[["__scopeId","data-v-d23a57b1"]]);export{W as default};
