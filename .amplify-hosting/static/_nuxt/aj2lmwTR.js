import{_ as O}from"./BAyAF6JK.js";import{u as Y}from"./CiN8dqd8.js";import{V as U}from"./f5lwX8SZ.js";import{n as L,j as g,c as i,o as c,m as p,b as h,v as x,y as T,x as $,p as o,w as d,s as w,V as P,_ as M,a5 as R,dX as j,t as z,l as E,a as I,G as X,F as N,D as J,q as K,u as Q,L as Z,I as ee,$ as te}from"./CGQimWOm.js";import{u as ae}from"./B3G4pkyN.js";import{V as se,b as re,a as oe,c as ne}from"./BkTuXOR_.js";import{V as le}from"./P_q-BwEt.js";import{V as ce}from"./GXZRJwQ4.js";import{V as ue}from"./BcH3Kywr.js";import{V as ie}from"./CS8xUUzH.js";import{V as me}from"./CRY4crBU.js";import{u as de}from"./BW5EWlXk.js";import{u as pe}from"./M9aAkXy6.js";import"./Bem91KZK.js";import"./BCoct7aH.js";import"./xvVMJZi9.js";import"./BSH7BhKc.js";import"./DsvAftJq.js";import"./2hEmiBig.js";import"./DPoG3AgV.js";import"./BvtSni_j.js";import"./CDtnx0aA.js";import"./DyYnZ78z.js";/* empty css        */import"./DJ0NdY24.js";import"./CjukEv2V.js";import"./C-GTDzx5.js";import"./IpAEdaYr.js";import"./rtPmyJLL.js";const fe={class:"wallet-balance"},ye={class:"mt-3"},_e={key:0,class:"balance-container"},ge={class:"d-flex align-baseline"},ve={class:"balance-amount font-weight-bold"},he={class:"text-subtitle-1 ml-2 text-grey-darken-2 font-weight-medium"},we={key:0,class:"balance-chart-container mt-2"},be={key:1,class:"mt-3"},xe={key:2,class:"text-subtitle-1 mt-3 text-error font-weight-medium"},Ve={key:3,class:"text-subtitle-1 mt-3 text-grey font-weight-medium"},$e=L({__name:"WalletBalance",setup(V){const u=Y(),t=g(!1),f=i(()=>u.wallet),y=i(()=>{var r;if(!((r=f.value)!=null&&r.data))return null;const{balance:e,currency:a}=f.value.data;if(e&&a&&a.code){const n=parseFloat(e);if(!isNaN(n))return new Intl.NumberFormat("en-US",{minimumFractionDigits:2,maximumFractionDigits:2}).format(n)}return null});return(e,a)=>{var r,n,_;return c(),p("div",fe,[h("div",ye,[a[4]||(a[4]=h("div",{class:"text-subtitle-2 text-grey-darken-1 font-weight-medium mb-1"}," Available Balance ",-1)),y.value?(c(),p("div",_e,[h("div",ge,[h("span",ve,x(y.value),1),h("span",he,x((_=(n=(r=f.value)==null?void 0:r.data)==null?void 0:n.currency)==null?void 0:_.code),1)]),t.value?(c(),p("div",we,a[0]||(a[0]=[h("div",{class:"balance-chart-placeholder"},null,-1)]))):T("",!0)])):$(u).isFetching?(c(),p("div",be,[o(U,{type:"text",width:"300",height:"50"})])):$(u).error?(c(),p("div",xe,[o(P,{start:"",color:"error",class:"mr-1"},{default:d(()=>a[1]||(a[1]=[w("mdi-alert-circle")])),_:1}),w(" "+x($(u).error.message),1)])):(c(),p("div",Ve,[o(P,{start:"",color:"grey",class:"mr-1"},{default:d(()=>a[2]||(a[2]=[w("mdi-information-outline")])),_:1}),a[3]||(a[3]=w(" Balance information unavailable "))]))])])}}}),Ce=M($e,[["__scopeId","data-v-77230f32"]]),Se={class:"text-body-1"},Te={__name:"TransactionStatusDialog",props:{modelValue:Boolean,status:{type:String,default:"success"},message:{type:String,default:""},transactionType:{type:String,required:!0},amount:{type:Number,required:!0},currency:{type:Object,required:!0}},emits:["update:modelValue"],setup(V,{emit:u}){const t=V,f=u,y=Y(),{wallet:e}=R(y),a=j(),{currencyFormatter:r}=ae(),n=i({get:()=>t.modelValue,set:s=>f("update:modelValue",s)}),_=g(!0),m=g(null),C=i(()=>{switch(t.status){case"success":return`${A(t.transactionType)} Successful`;case"error":return`${A(t.transactionType)} Failed`;case"processing":return`${A(t.transactionType)} Processing`;default:return"Transaction Status"}}),B=i(()=>{const s=r(t.amount,t.currency.symbol,t.currency.code);switch(t.status){case"success":switch(t.transactionType){case"deposit":return`You have successfully deposited ${s} into your wallet.`;case"withdrawal":return`You have successfully withdrawn ${s} from your wallet.`;case"transfer":return`You have successfully transferred ${s}.`;default:return`Your ${t.transactionType} of ${s} was successful.`}case"error":return`Your ${t.transactionType} of ${s} has failed. Please try again or contact support if the issue persists.`;case"processing":return`Your ${t.transactionType} of ${s} is being processed. We'll notify you once it's complete.`;default:return t.message||`There's an update on your ${t.transactionType} of ${s}.`}}),v=i(()=>{switch(t.status){case"success":return"text-h5 bg-success text-white";case"error":return"text-h5 bg-error text-white";case"processing":return"text-h5 bg-info text-white";default:return"text-h5 bg-primary text-white"}}),b=i(()=>{switch(t.status){case"success":return"success";case"error":return"error";case"processing":return"info";default:return"primary"}}),k=i(()=>t.status==="success"||t.status==="processing"),F=i(()=>{if(!e.value||m.value===null)return!1;const l=parseFloat(e.value.data.balance)-m.value;return t.status==="success"&&l!==0}),W=i(()=>{if(!e.value||m.value===null)return"";const l=parseFloat(e.value.data.balance)-m.value;if(l===0)return"";const S=r(Math.abs(l),t.currency.symbol,t.currency.code);if(l>0)return`Your wallet balance has increased by ${S}.`;if(l<0)return`Your wallet balance has decreased by ${S}.`}),G=i(()=>{if(!e.value||m.value===null)return"mdi-information";const l=parseFloat(e.value.data.balance)-m.value;return l>0?"mdi-arrow-up-bold":l<0?"mdi-arrow-down-bold":"mdi-equal"}),H=()=>{n.value=!1},D=async()=>{_.value=!0;try{e.value&&(m.value=parseFloat(e.value.data.balance)),await y.fetchWallet()}catch(s){console.error("Error fetching wallet information:",s),a.error("Unable to load wallet information. Please try again later.")}finally{_.value=!1}},A=s=>s.charAt(0).toUpperCase()+s.slice(1);return z(n,async s=>{s?await D():m.value=null}),E(async()=>{n.value&&await D()}),(s,l)=>{const S=Ce;return c(),I(ue,{modelValue:n.value,"onUpdate:modelValue":l[0]||(l[0]=q=>n.value=q),"max-width":"500px"},{default:d(()=>[o(se,null,{default:d(()=>[o(re,{class:X(v.value)},{default:d(()=>[w(x(C.value),1)]),_:1},8,["class"]),o(oe,{class:"pt-4"},{default:d(()=>[h("p",Se,x(B.value),1),_.value?(c(),p(N,{key:0},J(1,q=>o(U,{key:q,type:"article",class:"mb-4"})),64)):$(e)?(c(),p(N,{key:1},[k.value?(c(),I(S,{key:0,walletData:$(e).data,class:"mt-4"},null,8,["walletData"])):T("",!0),F.value?(c(),I(le,{key:1,type:V.status==="success"?"success":"info",class:"mt-4",border:"left",elevation:"2",icon:G.value},{default:d(()=>[w(x(W.value),1)]),_:1},8,["type","icon"])):T("",!0)],64)):T("",!0)]),_:1}),o(ne,null,{default:d(()=>[o(ce),o(K,{color:b.value,onClick:H},{default:d(()=>l[1]||(l[1]=[w("Close")])),_:1},8,["color"])]),_:1})]),_:1})]),_:1},8,["modelValue"])}}},Be={__name:"WalletPage",setup(V){const u=Y(),{wallet:t,isFetching:f}=R(u),y=j(),e=Q(),a=g(!1),r=g(""),n=g(""),_=g(""),m=g(0),C=g({code:"",symbol:""}),B=()=>{const v=e.query.status,b=e.query.message;_.value=e.query.transaction_type||e.query.type||"",m.value=parseFloat(e.query.amount)||0,C.value={code:e.query.currency_code||"",symbol:e.query.currency_symbol||""},v&&(r.value=v==="successful"?"success":v,n.value=decodeURIComponent(b||""),a.value=!0)};return E(async()=>{try{await u.fetchWallet(),console.log("Wallet data:",t.value),B()}catch(v){console.error("Failed to fetch wallet:",v),y.error("Failed to load wallet information. Please try again.")}}),(v,b)=>{const k=O,F=Te;return c(),p(N,null,[o(me,null,{default:d(()=>[o(ie,{cols:"12"},{default:d(()=>[o(k,{"transaction-type":"all",limit:10,"show-view-all":!1,"show-pagination":!1,"enable-infinite-scroll":!1,recent:!0})]),_:1})]),_:1}),o(F,{modelValue:a.value,"onUpdate:modelValue":b[0]||(b[0]=W=>a.value=W),status:r.value,message:n.value,"transaction-type":_.value,amount:m.value,currency:C.value},null,8,["modelValue","status","message","transaction-type","amount","currency"])],64)}}},ke=M(Be,[["__scopeId","data-v-800904d6"]]),Fe=L({__name:"index",async setup(V){let u,t;pe(),Z();const f=de();[u,t]=ee(()=>f.fetchTalaStageApp()),await u,t();const y=i(()=>f.talastageApp);return z(()=>y.value,e=>{if(e){const a=`My Wallet - ${e.name||"TalaStage"}`,r="Manage your wallet, check balances, and track transactions securely.";te({title:a,meta:[{name:"description",content:r},{property:"og:title",content:a},{property:"og:description",content:r},{property:"og:image",content:e.logo_url||"/default-social-image.png"},{property:"og:type",content:"website"},{property:"og:url",content:`${e.canonical_url||"https://talastage.com"}/wallet`},{name:"twitter:title",content:a},{name:"twitter:description",content:r},{name:"twitter:image",content:e.logo_url||"/default-social-image.png"},{name:"twitter:card",content:"summary_large_image"}],link:[{rel:"icon",type:"image/png",href:e.favicon_url||"/favicon.png"},{rel:"canonical",href:`${e.canonical_url||"https://talastage.com"}/wallet`}]})}},{immediate:!0}),(e,a)=>{const r=ke;return c(),p("div",null,[o(r)])}}}),nt=M(Fe,[["__scopeId","data-v-211811f6"]]);export{nt as default};
