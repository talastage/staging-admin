import{a7 as ee,a8 as ae,ag as te,a9 as le,aq as ne,aa as re,at as oe,aw as se,ae as ie,p as o,aN as ue,dX as de,u as ce,k as me,g as pe,j as w,c as p,t as I,l as Y,o as i,a as T,w as s,b as r,q as C,s as u,m as _,A as fe,v as m,V as ve,F as we,D as ge,y as S,O as ye,J as he,n as _e,_ as be}from"./CGQimWOm.js";import{V as Ve}from"./CRY4crBU.js";import{V as xe}from"./CS8xUUzH.js";import{V as U,b as E,a as L,c as ke}from"./BkTuXOR_.js";import{V as Ce,a as R}from"./bFKGpjcd.js";import{V as Te}from"./P_q-BwEt.js";import{V as Ae}from"./xvVMJZi9.js";import{V as Pe}from"./BSH7BhKc.js";import{a as Re}from"./DsvAftJq.js";import{V as Se}from"./D4pNkYCe.js";import{V as De}from"./BEZsNnc4.js";import{V as $e}from"./BcH3Kywr.js";import{V as Me}from"./GXZRJwQ4.js";import{V as We}from"./BhN2__aY.js";import{q as je}from"./_WrfyJOJ.js";import{u as Ne}from"./BW5EWlXk.js";import{u as Be}from"./D78L5r-E.js";/* empty css        */import"./CjukEv2V.js";import"./2hEmiBig.js";import"./DJ0NdY24.js";import"./C-GTDzx5.js";import"./IpAEdaYr.js";const Fe=ee({fixedHeader:Boolean,fixedFooter:Boolean,height:[Number,String],hover:Boolean,...ae(),...te(),...le(),...ne()},"VTable"),Ie=re()({name:"VTable",props:Fe(),setup(c,x){let{slots:l,emit:n}=x;const{themeClasses:f}=oe(c),{densityClasses:d}=se(c);return ie(()=>o(c.tag,{class:["v-table",{"v-table--fixed-height":!!c.height,"v-table--fixed-header":c.fixedHeader,"v-table--fixed-footer":c.fixedFooter,"v-table--has-top":!!l.top,"v-table--has-bottom":!!l.bottom,"v-table--hover":c.hover},f.value,d.value,c.class],style:c.style},{default:()=>{var y,v,g;return[(y=l.top)==null?void 0:y.call(l),l.default?o("div",{class:"v-table__wrapper",style:{height:ue(c.height)}},[o("table",null,[l.default()])]):(v=l.wrapper)==null?void 0:v.call(l),(g=l.bottom)==null?void 0:g.call(l)]}})),{}}}),Ue={key:0,class:"d-flex justify-center my-5"},Ee={key:1,class:"text-center my-5"},Le={key:2,class:"text-center my-5"},Ye={class:"text-body-2 text-grey"},qe={class:"d-flex flex-column"},ze={class:"d-flex align-center"},He={class:"d-flex flex-column"},Ge={class:"text-grey"},Je={key:0,class:"d-flex flex-column"},Ke={key:1,class:"text-success"},Oe={key:2,class:"text-error"},Xe={key:3},Qe={class:"d-flex"},Ze={__name:"WithdrawalRequestPage",setup(c){const x=de(),l=ce(),n=me(),{$axios:f}=pe(),d=w([]),y=w(!0),v=w(null),g=w(1),M=w(10),W=w(0),b=w("all"),q=w(!1),A=w(!1),D=w(null),$=w(!1),j=p(()=>Math.ceil(W.value/M.value)),P=async()=>{var t,e;y.value=!0,v.value=null;try{const a=b.value!=="all"?b.value:null,k={page:g.value,per_page:M.value,status:a},h=await f.get("/api/withdrawal-requests",{params:k});h.data.success?(d.value=h.data.data.data,W.value=h.data.data.total,n.push({query:{...l.query,page:g.value,tab:b.value}})):v.value=h.data.message||"Failed to fetch withdrawal requests"}catch(a){v.value=((e=(t=a.response)==null?void 0:t.data)==null?void 0:e.message)||"An error occurred while fetching withdrawal requests",console.error("Error fetching withdrawal requests:",a)}finally{y.value=!1}},z=t=>t?je(new Date(t),"MMM d, yyyy h:mm a"):"-",H=(t,e="USD")=>t==null?"-":new Intl.NumberFormat("en-US",{style:"currency",currency:e||"USD"}).format(t),G=t=>({pending:"warning",processing:"info",completed:"success",rejected:"error",cancelled:"grey",failed:"error"})[t]||"grey",N=t=>({pending:"Pending",processing:"Processing",completed:"Completed",rejected:"Rejected",cancelled:"Cancelled",failed:"Failed"})[t]||t,J=t=>{var e;if(!t)return"-";if((e=t.payment_method)!=null&&e.name)return t.payment_method.name;if(t.paymentable_type&&t.paymentable){if(t.paymentable_type.includes("MobileMoneyProvider"))return t.paymentable.name||"Mobile Money";if(t.paymentable_type.includes("Bank"))return t.paymentable.name||"Bank Transfer"}return"Unknown"},B=t=>{var e,a;return t?(e=t.payment_method)!=null&&e.logo_url?t.payment_method.logo_url:t.paymentable_type&&((a=t.paymentable)!=null&&a.logo_url)?t.paymentable.logo_url:null:null},K=t=>{if(!t.timeline||!t.created_at||!t.timeline.estimated_hours)return 0;const e=new Date(t.created_at),a=new Date(t.timeline.utc_completion_time),k=new Date;if(k>=a)return 100;const h=a-e,V=k-e;return Math.min(100,Math.round(V/h*100))},O=()=>{switch(b.value){case"pending":return"You don't have any pending withdrawal requests.";case"completed":return"You don't have any completed withdrawal requests.";case"rejected":return"You don't have any rejected withdrawal requests.";case"cancelled":return"You don't have any cancelled withdrawal requests.";default:return"You haven't made any withdrawal requests yet."}},X=t=>{n.push(`/wallet/transactions/withdrawal-requests/withdrawal-${t.reference_number}`)},Q=t=>{D.value=t,A.value=!0,q.value=!1},Z=async()=>{var t,e;if(D.value){$.value=!0;try{const a=await f.delete(`/api/withdrawal-requests/${D.value.id}`);if(a.data.success)x.success("Withdrawal request cancelled successfully"),A.value=!1,P();else throw new Error(a.data.message||"Failed to cancel withdrawal request")}catch(a){x.error(((e=(t=a.response)==null?void 0:t.data)==null?void 0:e.message)||"An error occurred while cancelling the withdrawal request"),console.error("Error cancelling withdrawal request:",a)}finally{$.value=!1}}};return I(g,()=>{P()}),I(b,()=>{g.value=1,P()}),Y(()=>{l.query.page&&(g.value=parseInt(l.query.page)||1),l.query.tab&&["all","pending","completed","rejected","cancelled"].includes(l.query.tab)&&(b.value=l.query.tab),P()}),(t,e)=>(i(),T(We,null,{default:s(()=>[o(Ve,null,{default:s(()=>[o(xe,{cols:"12"},{default:s(()=>[o(U,{elevation:"10"},{default:s(()=>[o(E,{class:"d-flex align-center justify-space-between"},{default:s(()=>[e[5]||(e[5]=r("span",null,"Withdrawal Requests",-1)),o(C,{color:"primary","prepend-icon":"mdi-cash-multiple",to:"/wallet/withdraw",variant:"flat"},{default:s(()=>e[4]||(e[4]=[u(" New Withdrawal ")])),_:1})]),_:1}),o(L,null,{default:s(()=>[o(Ce,{modelValue:b.value,"onUpdate:modelValue":e[0]||(e[0]=a=>b.value=a),"bg-color":"transparent"},{default:s(()=>[o(R,{value:"all"},{default:s(()=>e[6]||(e[6]=[u("All")])),_:1}),o(R,{value:"pending"},{default:s(()=>e[7]||(e[7]=[u("Pending")])),_:1}),o(R,{value:"completed"},{default:s(()=>e[8]||(e[8]=[u("Completed")])),_:1}),o(R,{value:"rejected"},{default:s(()=>e[9]||(e[9]=[u("Rejected")])),_:1}),o(R,{value:"cancelled"},{default:s(()=>e[10]||(e[10]=[u("Cancelled")])),_:1})]),_:1},8,["modelValue"]),y.value?(i(),_("div",Ue,[o(fe,{indeterminate:"",color:"primary"})])):v.value?(i(),_("div",Ee,[o(Te,{type:"error",variant:"tonal"},{default:s(()=>[u(m(v.value),1)]),_:1}),o(C,{color:"primary",class:"mt-4",onClick:P},{default:s(()=>e[11]||(e[11]=[u(" Try Again ")])),_:1})])):d.value.length?(i(),T(Ie,{key:3},{default:s(()=>[e[14]||(e[14]=r("thead",null,[r("tr",null,[r("th",null,"Reference"),r("th",null,"Date"),r("th",null,"Amount"),r("th",null,"Method"),r("th",null,"Account"),r("th",null,"Status"),r("th",null,"Approval Status"),r("th",null,"Actions")])],-1)),r("tbody",null,[(i(!0),_(we,null,ge(d.value,a=>{var k,h;return i(),_("tr",{key:a.id},[r("td",null,m(a.reference_number),1),r("td",null,m(z(a.created_at)),1),r("td",null,[r("div",qe,[r("span",null,m(H(a.amount,(k=a.currency)==null?void 0:k.code)),1)])]),r("td",null,[r("div",ze,[B(a)?(i(),T(Ae,{key:0,size:"24",class:"mr-2"},{default:s(()=>[o(Pe,{src:B(a)},null,8,["src"])]),_:2},1024)):S("",!0),u(" "+m(J(a)),1)])]),r("td",null,[r("div",He,[r("span",null,m(a.account_number),1),r("small",Ge,m(a.account_holder_name),1)])]),r("td",null,[o(Re,{color:G(a.status),size:"small",text:N(a.status)},null,8,["color","text"])]),r("td",null,[a.timeline&&a.status==="pending"?(i(),_("div",Je,[r("span",null,m(a.timeline.formatted_local_time),1),o(Se,{location:"bottom"},{activator:s(({props:V})=>{var F;return[r("small",ye({class:["text-caption",(F=a.timeline.remaining)!=null&&F.is_overdue?"text-error":"text-primary"],ref_for:!0},V),m(a.timeline.formatted_remaining),17)]}),default:s(()=>{var V;return[r("span",null,m((V=a.timeline.remaining)!=null&&V.is_overdue?"Approval is taking longer than expected":"Estimated approval time remaining"),1)]}),_:2},1024),(h=a.timeline.remaining)!=null&&h.is_overdue?S("",!0):(i(),T(he,{key:0,"model-value":K(a),color:"primary",height:"4",class:"mt-1"},null,8,["model-value"]))])):a.status==="completed"?(i(),_("span",Ke,"Approved & Processed")):["rejected","cancelled"].includes(a.status)?(i(),_("span",Oe,m(a.status==="rejected"?"Rejected by Admin":N(a.status)),1)):(i(),_("span",Xe,"Awaiting Review"))]),r("td",null,[r("div",Qe,[o(C,{icon:"mdi-eye",variant:"text",size:"small",color:"primary",onClick:V=>X(a)},null,8,["onClick"]),a.status==="pending"?(i(),T(C,{key:0,icon:"mdi-close",variant:"text",size:"small",color:"error",onClick:V=>Q(a)},null,8,["onClick"])):S("",!0)])])])}),128))])]),_:1})):(i(),_("div",Le,[o(ve,{size:"64",color:"grey",icon:"mdi-cash-remove"}),e[13]||(e[13]=r("div",{class:"text-h6 mt-2"},"No withdrawal requests found",-1)),r("div",Ye,m(O()),1),o(C,{color:"primary",class:"mt-4",to:"/wallet/withdraw",variant:"flat"},{default:s(()=>e[12]||(e[12]=[u(" Make a Withdrawal ")])),_:1})])),j.value>1?(i(),T(De,{key:4,modelValue:g.value,"onUpdate:modelValue":e[1]||(e[1]=a=>g.value=a),length:j.value,rounded:"circle",class:"mt-5"},null,8,["modelValue","length"])):S("",!0)]),_:1})]),_:1})]),_:1})]),_:1}),o($e,{modelValue:A.value,"onUpdate:modelValue":e[3]||(e[3]=a=>A.value=a),"max-width":"400"},{default:s(()=>[o(U,null,{default:s(()=>[o(E,null,{default:s(()=>e[15]||(e[15]=[u("Cancel Withdrawal Request?")])),_:1}),o(L,null,{default:s(()=>e[16]||(e[16]=[u(" Are you sure you want to cancel this withdrawal request? The funds will be returned to your wallet. ")])),_:1}),o(ke,null,{default:s(()=>[o(Me),o(C,{color:"grey",variant:"text",onClick:e[2]||(e[2]=a=>A.value=!1)},{default:s(()=>e[17]||(e[17]=[u("No, Keep It")])),_:1}),o(C,{color:"error",loading:$.value,onClick:Z},{default:s(()=>e[18]||(e[18]=[u(" Yes, Cancel ")])),_:1},8,["loading"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1}))}},ea=_e({__name:"index",setup(c){const x=Ne();Y(async()=>{await x.fetchTalaStageApp()});const l=p(()=>x.talastageApp);return Be({title:p(()=>{var n;return`Withdrawal Requests - Wallet - ${((n=l.value)==null?void 0:n.name)||"TalaStage"}`}),description:p(()=>{var n;return`Request a withdrawal of funds from your wallet to the admin on ${(n=l.value)==null?void 0:n.name}. Submit your withdrawal request here.`}),keywords:p(()=>{var n;return`wallet, withdrawal request, withdraw funds, send withdrawal, admin, funds, ${((n=l.value)==null?void 0:n.name)||"TalaStage"}`}),image:p(()=>{var n;return((n=l.value)==null?void 0:n.logo_url)||"/default-social-image.png"}),type:"website",siteName:p(()=>{var n;return((n=l.value)==null?void 0:n.name)||"TalaStage"}),url:p(()=>{var n;return`${((n=l.value)==null?void 0:n.canonical_url)||"https://talastage.com"}/wallet/transactions/withdrawal-requests`}),canonical:p(()=>{var n;return`${((n=l.value)==null?void 0:n.canonical_url)||"https://talastage.com"}/wallet/transactions/withdrawal-requests`}),noIndex:!0,openGraph:p(()=>{var n,f,d,y,v;return{title:`Withdrawal Requests - Wallet - ${((n=l.value)==null?void 0:n.name)||"TalaStage"}`,description:`Request a withdrawal of funds from your wallet to the admin on ${(f=l.value)==null?void 0:f.name}. Submit your withdrawal request here.`,url:`${((d=l.value)==null?void 0:d.canonical_url)||"https://talastage.com"}/wallet/transactions/withdrawal-requests`,image:((y=l.value)==null?void 0:y.logo_url)||"/default-social-image.png",siteName:((v=l.value)==null?void 0:v.name)||"TalaStage",type:"website"}}),twitter:p(()=>{var n,f,d;return{card:"summary_large_image",title:`Withdrawal Requests - Wallet - ${((n=l.value)==null?void 0:n.name)||"TalaStage"}`,description:`Request a withdrawal of funds from your wallet to the admin on ${(f=l.value)==null?void 0:f.name}. Submit your withdrawal request here.`,image:((d=l.value)==null?void 0:d.logo_url)||"/default-social-image.png"}}),link:p(()=>{var n;return[{rel:"icon",href:((n=l.value)==null?void 0:n.favicon_url)||"/favicon.ico"}]})}),(n,f)=>{const d=Ze;return i(),T(d)}}}),ka=be(ea,[["__scopeId","data-v-9de6859b"]]);export{ka as default};
