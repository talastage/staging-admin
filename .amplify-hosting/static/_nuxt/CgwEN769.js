import{_ as ne}from"./BWXQ7vJw.js";import{_ as re}from"./3SmzOII5.js";import{u as le}from"./BCoct7aH.js";import{a as ue}from"./DsvAftJq.js";import{n as U,c as b,o as d,a as g,w as t,b as u,p as e,v as j,V as S,s as y,y as G,m as F,F as H,_ as O,f as ie,g as K,a5 as Y,j as q,l as X,t as ce,x as C,D as me,q as Z,A as de,dN as pe,k as ee,i as fe}from"./CGQimWOm.js";import{V as _e}from"./BvtSni_j.js";import{V as te}from"./BkTuXOR_.js";import{_ as ye}from"./jRUxZAus.js";import{V as w}from"./CS8xUUzH.js";import{V as P}from"./CRY4crBU.js";import{V as oe}from"./P_q-BwEt.js";import{V as ve}from"./CMsVONS5.js";import{_ as ae}from"./Bem91KZK.js";import{B as ge}from"./COhe-ksk.js";import{u as he}from"./DMBY-Kaj.js";import{u as be}from"./Bp2sYpJN.js";import{u as Ve}from"./B3G4pkyN.js";import{V as xe}from"./BhN2__aY.js";const ke={class:"d-flex flex-sm-row flex-column pa-4 gap-4"},Ce={class:"project-thumbnail-wrapper"},je={class:"project-content flex-grow-1"},Se={class:"d-flex align-center justify-space-between mb-2"},Ae=["title"],Ne={class:"d-flex flex-wrap gap-2"},$e={class:"d-flex align-center"},we={class:"text-body-2 text-medium-emphasis"},De={class:"d-flex align-center"},Be={class:"text-body-2 text-medium-emphasis"},Te=U({__name:"ProjectHeader",props:{project:{}},emits:["click","thumbnailClick"],setup(i){const r=i,{formatRelativeDate:a}=le(),p=b(()=>a(r.project.created_at)),V=b(()=>r.project.status?{draft:"mdi-pencil-outline",published:"mdi-check-circle-outline",pending:"mdi-clock-outline"}[r.project.status]||"mdi-help-circle-outline":""),c=b(()=>r.project.status?{draft:"grey",published:"success",pending:"warning"}[r.project.status]||"grey":""),x=o=>o?o.charAt(0).toUpperCase()+o.slice(1):"";return(o,N)=>{const m=re;return d(),g(te,{class:"project-header",elevation:"2"},{default:t(()=>[u("div",ke,[u("div",Ce,[e(m,{thumbnailUrl:o.project.thumbnail_url,videoUrl:o.project.video_url,showViews:!1,showDuration:!0,size:"xs",class:"project-card__thumbnail"},null,8,["thumbnailUrl","videoUrl"])]),u("div",je,[u("div",Se,[u("h2",{class:"text-h6 font-weight-bold text-truncate",title:o.project.name},j(o.project.name),9,Ae),o.project.status?(d(),g(ue,{key:0,color:c.value,size:"small",class:"status-chip",variant:"tonal"},{default:t(()=>[e(S,{icon:V.value,size:"small",start:"",class:"mr-1"},null,8,["icon"]),y(" "+j(x(o.project.status)),1)]),_:1},8,["color"])):G("",!0)]),u("div",Ne,[u("div",$e,[e(S,{icon:"mdi-calendar-outline",size:"small",class:"mr-1",color:"primary"}),u("span",we,j(p.value),1)]),o.project.creator_share_percentage!==null&&o.project.creator_share_percentage!==void 0?(d(),F(H,{key:0},[e(_e,{vertical:"",class:"mx-2"}),u("div",De,[e(S,{icon:"mdi-account-cash-outline",size:"small",class:"mr-1",color:"success"}),u("span",Be," Creator Share: "+j(o.project.creator_share_percentage)+"% ",1)])],64)):G("",!0)])])])]),_:1})}}}),Pe=O(Te,[["__scopeId","data-v-2ddbcfd9"]]),Fe=ie("defaultAmount",{state:()=>({amounts:[],currency:null,loading:!1,error:null}),actions:{async fetchDefaultAmounts(){const{$axios:i}=K();this.loading=!0,this.error=null;try{const r=await i.get("/api/default-amounts");this.amounts=r.data.amounts,this.currency=r.data.currency}catch(r){this.error="Failed to load default amounts. Please try again.",console.error("Error fetching default amounts:",r)}finally{this.loading=!1}}}}),Ue={class:"default-amount-selector"},ze={class:"preset-amounts mb-4"},Le={class:"preset-amounts-label mb-2"},Ie={class:"custom-amount-section"},Re={class:"custom-amount-label mb-2"},Ee=U({__name:"DefaultAmountSelector",props:{modelValue:{},maxAmount:{},currency:{}},emits:["update:modelValue"],setup(i,{emit:r}){const a=i,p=r,V=Fe(),{amounts:c,currency:x,loading:o,error:N}=Y(V),m=q(""),k=b(()=>{var s;return a.currency&&a.currency.symbol?a.currency.symbol:(s=x.value)!=null&&s.symbol?x.value.symbol:""}),_=b({get:()=>a.modelValue.toString(),set:s=>{const l=parseFloat(s);isNaN(l)||p("update:modelValue",l)}});function z(s){return Number(a.modelValue)===Number(s)}function $(s){m.value="",p("update:modelValue",Number(s))}function W(){m.value&&(m.value="")}function L(){const s=parseFloat(_.value);if(isNaN(s)||s<=0){m.value="Please enter a valid positive amount",p("update:modelValue",0);return}if(s>a.maxAmount){m.value=`Maximum amount is ${k.value}${a.maxAmount}`,p("update:modelValue",a.maxAmount);return}m.value=""}return X(()=>{c.value.length===0&&!o.value&&V.fetchDefaultAmounts()}),ce(()=>c.value,s=>{if(s.length>0){const l=Number(a.modelValue);(l===0||!s.some(v=>Number(v.amount)===l))&&p("update:modelValue",Number(s[0].amount))}},{immediate:!0}),(s,l)=>(d(),F("div",Ue,[u("div",ze,[u("div",Le,[e(S,{size:"small",color:"primary",class:"mr-1"},{default:t(()=>l[1]||(l[1]=[y("mdi-lightning-bolt")])),_:1}),l[2]||(l[2]=u("span",null,"Quick amounts",-1))]),!C(o)&&!C(N)?(d(),g(P,{key:0,dense:""},{default:t(()=>[(d(!0),F(H,null,me(C(c),v=>(d(),g(w,{key:v.id,cols:"6",sm:"4"},{default:t(()=>[e(Z,{block:"",color:z(v.amount)?"primary":"",variant:z(v.amount)?"elevated":"outlined",onClick:J=>$(v.amount),class:"mb-2 preset-btn",elevation:"2"},{default:t(()=>[y(j(v.formatted),1)]),_:2},1032,["color","variant","onClick"])]),_:2},1024))),128))]),_:1})):C(o)?(d(),g(de,{key:1,indeterminate:"",color:"primary",class:"mt-4"})):C(N)?(d(),g(oe,{key:2,type:"error",class:"mt-4"},{default:t(()=>[y(j(C(N)),1)]),_:1})):G("",!0)]),u("div",Ie,[u("div",Re,[e(S,{size:"small",color:"primary",class:"mr-1"},{default:t(()=>l[3]||(l[3]=[y("mdi-pencil")])),_:1}),l[4]||(l[4]=u("span",null,"Enter custom amount",-1))]),e(ve,{modelValue:_.value,"onUpdate:modelValue":l[0]||(l[0]=v=>_.value=v),label:`Amount in ${k.value}`,prefix:k.value,type:"number",min:.01,max:s.maxAmount,"error-messages":m.value,onBlur:L,onInput:W,variant:"outlined",density:"comfortable",class:"custom-amount-input",hint:"Enter any amount you wish to give","persistent-hint":""},null,8,["modelValue","label","prefix","max","error-messages"])])]))}}),Me=O(Ee,[["__scopeId","data-v-260bd9ea"]]),qe=U({__name:"LoginButton",emits:["login-click"],setup(i,{emit:r}){const a=pe(),p=r,V=()=>{a.show(),p("login-click")};return(c,x)=>{const o=ae;return d(),g(o,{title:"Login",action:V,color:"primary",variant:"flat",fullWidth:!0,customClass:"login-button",elevation:0})}}}),Ge=O(qe,[["__scopeId","data-v-d00730cf"]]),He=U({__name:"RegisterButton",props:{label:{type:String,default:"Register"}},setup(i){const r=ee(),a=()=>{r.push("/register")};return(p,V)=>{const c=ae;return d(),g(c,{title:i.label,action:a,color:"primary",variant:"outlined",fullWidth:!0,customClass:"register-button",elevation:0},null,8,["title"])}}}),Oe={class:"amount-section-header mb-2"},We={class:"text-center mt-2 text-caption text-grey"},Qe=U({__name:"TipDialog",props:{modelValue:Boolean,entity:{type:Object,required:!0},entityType:{type:String,required:!0,validator:i=>["user","project"].includes(i)},defaultAmount:{type:Number,default:0}},emits:["update:modelValue","transactionComplete"],setup(i,{emit:r}){const a=i,p=r,V=ee(),c=he(),x=fe(),{isLoggedIn:o}=Y(x),{currencyFormatter:N}=Ve(),m=be(),{selectedCurrency:k}=Y(m),_=q(a.defaultAmount),z=q(1e5);b(()=>a.entityType==="user"?"mdi-account":"mdi-folder-open"),X(async()=>{m.isFetched||(o.value?await m.fetchCurrencies():await m.fetchGuestCurrencies())});const $=b({get:()=>a.modelValue,set:f=>p("update:modelValue",f)}),W=b(()=>{if(!k.value)return`${Number(_.value).toFixed(2)}`;const{symbol:f,code:n}=k.value,A=f||"";return N(Number(_.value),A,n)||`${A}${Number(_.value).toFixed(2)}`}),L=b(()=>{const f=Number(_.value);return!isNaN(f)&&f>0&&f<=z.value}),s=b(()=>a.entityType==="user"?"User":"Project");function l(f){$.value=f}function v(){x.fetchUser(),m.fetchCurrencies()}function J(){x.fetchUser(),m.fetchCurrencies()}const D=q(!1);async function se(){var f,n,A,B,I,R,E,M;if(!o.value){c.error("Please log in to continue.");return}if(!L.value){c.error("Please enter a valid amount.");return}try{D.value=!0;const h={paying_amount:Number(_.value),currency_id:(f=k.value)==null?void 0:f.id,payment_type:a.entityType==="user"?"tip":"project_tip",payable_type:"App\\Models\\"+s.value,payable_id:a.entity.id},{$axios:T}=K(),Q=await T.post("/api/cart/items",h);if((n=Q.data)!=null&&n.success)$.value=!1,c.success(Q.data.message||"Support added to cart successfully!"),p("transactionComplete",Number(_.value)),V.push("/checkout");else throw new Error(((A=Q.data)==null?void 0:A.message)||"Transaction failed")}catch(h){((B=h.response)==null?void 0:B.status)===422?c.error(h.response.data.message||"Invalid transaction data"):((I=h.response)==null?void 0:I.status)===403?c.error("You are not authorized to perform this transaction"):((R=h.response)==null?void 0:R.status)===429?c.error("Too many attempts. Please try again later"):c.error(((M=(E=h.response)==null?void 0:E.data)==null?void 0:M.message)||h.message||"Failed to process support. Please try again.")}finally{D.value=!1}}return(f,n)=>{const A=ne,B=Pe,I=ye,R=Me,E=Ge,M=He,h=ge;return d(),g(h,{modelValue:$.value,"onUpdate:modelValue":[n[1]||(n[1]=T=>$.value=T),l],title:`Support ${s.value}`,"max-width":"500px"},{default:t(()=>[e(xe,{class:"pa-0"},{default:t(()=>[e(P,{"no-gutters":"",class:"mb-4"},{default:t(()=>[e(w,{cols:"12"},{default:t(()=>[i.entityType==="user"?(d(),g(A,{key:0,user:i.entity,layout:"compact",class:"entity-card"},null,8,["user"])):i.entityType==="project"?(d(),g(B,{key:1,project:i.entity,compact:"",class:"entity-card"},null,8,["project"])):G("",!0)]),_:1})]),_:1}),C(o)?(d(),F(H,{key:0},[e(P,{"no-gutters":"",class:"mb-4"},{default:t(()=>[e(w,{cols:"12"},{default:t(()=>[u("div",Oe,[e(I,{size:"h5",class:"support-amount-title text-center"},{default:t(()=>n[2]||(n[2]=[y(" Choose your support amount ")])),_:1})]),e(te,{variant:"outlined",class:"pa-4 amount-selector-card"},{default:t(()=>[e(R,{modelValue:_.value,"onUpdate:modelValue":n[0]||(n[0]=T=>_.value=T),currency:C(k),maxAmount:1e5},null,8,["modelValue","currency"])]),_:1})]),_:1})]),_:1}),e(P,{"no-gutters":""},{default:t(()=>[e(w,{cols:"12"},{default:t(()=>[e(Z,{color:"primary",block:"",class:"give-tip-button",onClick:se,disabled:!L.value||D.value,loading:D.value,size:"large",elevation:"3"},{default:t(()=>[e(S,{start:""},{default:t(()=>n[3]||(n[3]=[y("mdi-gift")])),_:1}),y(" "+j(D.value?"Processing...":`Send ${W.value} Support`),1)]),_:1},8,["disabled","loading"]),u("div",We,[e(S,{size:"x-small",class:"mr-1"},{default:t(()=>n[4]||(n[4]=[y("mdi-shield-check")])),_:1}),n[5]||(n[5]=y(" Secure payment processing "))])]),_:1})]),_:1})],64)):(d(),F(H,{key:1},[e(oe,{type:"info",class:"mb-4",variant:"tonal",border:"start",density:"comfortable"},{prepend:t(()=>[e(S,null,{default:t(()=>n[6]||(n[6]=[y("mdi-information")])),_:1})]),default:t(()=>[y(" Please log in or register to support this "+j(s.value.toLowerCase())+". ",1)]),_:1}),e(P,null,{default:t(()=>[e(w,{cols:"6"},{default:t(()=>[e(E,{useDialog:"",onLoginSuccess:v})]),_:1}),e(w,{cols:"6"},{default:t(()=>[e(M,{onRegisterSuccess:J})]),_:1})]),_:1})],64))]),_:1})]),_:1},8,["modelValue","title"])}}}),pt=O(Qe,[["__scopeId","data-v-3890112f"]]);export{pt as _,Pe as a};
