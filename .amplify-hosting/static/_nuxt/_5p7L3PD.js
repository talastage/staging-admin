import{_ as Q}from"./D5iXKOLd.js";import{_ as G,L as X,i as Z,j as m,c as r,o as w,a as _,w as s,p as l,V as P,b as i,s as n,C as k,x as o,q as N,v as T,m as ee,y as F,n as te,l as ae}from"./CGQimWOm.js";import{u as le}from"./M9aAkXy6.js";import{m as se}from"./_H440M90.js";import{a as D}from"./2hEmiBig.js";import{V as oe,d as re,b as ie,e as ne,a as ue}from"./BkTuXOR_.js";import{V as de,a as E}from"./D9lJKT5N.js";import{V as L}from"./CiXMVmI4.js";import{V as me}from"./CMsVONS5.js";import{V as $}from"./DX-6Wr-O.js";import{a as pe}from"./DsvAftJq.js";import{V as Y}from"./P_q-BwEt.js";import{V as ce}from"./BhN2__aY.js";import{u as fe}from"./BW5EWlXk.js";import{u as ve}from"./D78L5r-E.js";import"./QtD4Idd3.js";import"./rtPmyJLL.js";import"./xvVMJZi9.js";import"./BSH7BhKc.js";import"./DJ0NdY24.js";import"./CjukEv2V.js";import"./Dn0bXcU5.js";import"./Dg4qVXYX.js";import"./C-GTDzx5.js";import"./C-73ZGdz.js";import"./BFmCCZJK.js";/* empty css        */const ge={class:"d-flex justify-center"},ye={class:"text-body-1 text-center mb-6"},be={class:"text-center mb-4"},we={class:"d-flex justify-center"},Ve={class:"text-center mt-6"},xe={key:0,class:"text-error text-center mb-4"},Pe={class:"d-flex justify-center"},Ne={__name:"WalletResetPinPage",setup(K){var U,M;const C=X(),t=le(),a=Z(),f=m(null),y=m(null),I=m(null),V=m(1),c=m(""),v=m(""),b=m(""),x=m(""),W=m(0),S=m(!1),g=m(""),h=m("info"),A=r(()=>v.value.length===6),q=r(()=>b.value.length===6&&x.value.length===6),B=r(()=>b.value&&x.value&&b.value!==x.value),O=r(()=>se(c.value||"")),p=(u,e="info")=>{g.value=u,h.value=e,e==="success"&&setTimeout(()=>{g.value===u&&(g.value="")},5e3)},j=async()=>{t.authError="",g.value="";const u=c.value.trim().toLowerCase();if(!u){p("Email address is required","error");return}if(!/^[^\s@]+@[^\s@]+\.[^\s@]+$/.test(u)){p("Please enter a valid email address","error");return}try{await t.requestPinReset(u),c.value=u,V.value=2,W.value++,S.value=!0,v.value="",p("Reset code sent to your email","success")}catch(R){p(R.message||"Failed to send reset code","error")}},z=async()=>{if(A.value)try{await t.verifyResetCode(c.value,v.value),V.value=3,p("Code verified successfully. Please set a new PIN.","success")}catch(u){v.value="",p(u.message||"Invalid reset code","error")}},H=async()=>{if(q.value){if(B.value){p("PINs do not match. Please try again.","error");return}try{await t.resetPin(c.value,v.value,b.value),p("Your PIN has been reset successfully","success"),setTimeout(()=>{C.push("/wallet")},2e3)}catch(u){p(u.message||"Failed to reset PIN","error")}}},J=()=>{S.value=!1,p("Reset code has expired. Please request a new one.","warning")};return(M=(U=a.user)==null?void 0:U.value)!=null&&M.email&&(c.value=a.user.value.email),(u,e)=>{const R=Q;return w(),_(ce,{class:"d-flex align-center justify-center",style:{"min-height":"80vh"}},{default:s(()=>[l(oe,{class:"mx-auto wallet-reset-card",elevation:"10","max-width":"500"},{default:s(()=>[l(re,null,{default:s(()=>[l(ie,{class:"text-h4 font-weight-bold text-center mb-2"},{default:s(()=>[l(P,{icon:"mdi-lock-reset",size:"36",color:"primary",class:"mb-2"}),e[8]||(e[8]=i("div",null,"Reset Wallet PIN",-1))]),_:1}),l(ne,{class:"text-center mb-6"},{default:s(()=>e[9]||(e[9]=[n(" Follow the steps to reset your wallet security PIN ")])),_:1})]),_:1}),l(ue,null,{default:s(()=>[l(de,{modelValue:V.value,"onUpdate:modelValue":e[5]||(e[5]=d=>V.value=d),touch:!1},{default:s(()=>[l(E,{value:1},{default:s(()=>[l(L,{onSubmit:k(j,["prevent"]),ref_key:"resetForm",ref:f},{default:s(()=>[e[12]||(e[12]=i("p",{class:"text-h6 text-center mb-4"},"Request Reset Code",-1)),e[13]||(e[13]=i("p",{class:"text-body-1 text-center mb-6"}," Enter your email address to receive a PIN reset code ",-1)),l(me,{modelValue:c.value,"onUpdate:modelValue":e[0]||(e[0]=d=>c.value=d),label:"Email Address",type:"email",required:"",variant:"outlined","prepend-inner-icon":"mdi-email",placeholder:"Enter your email",class:"mb-4",disabled:o(t).isLoading},null,8,["modelValue","disabled"]),i("div",ge,[l(N,{color:"primary",type:"submit",loading:o(t).isLoading,disabled:!c.value||o(t).isLoading,size:"large",class:"px-8"},{default:s(()=>[l(P,{start:""},{default:s(()=>e[10]||(e[10]=[n("mdi-email-outline")])),_:1}),e[11]||(e[11]=n(" Send Reset Code "))]),_:1},8,["loading","disabled"])])]),_:1},512)]),_:1}),l(E,{value:2},{default:s(()=>[l(L,{onSubmit:k(z,["prevent"]),ref_key:"codeForm",ref:y},{default:s(()=>[e[20]||(e[20]=i("p",{class:"text-h6 text-center mb-4"},"Enter Reset Code",-1)),i("p",ye," We've sent a 6-digit code to your email ("+T(O.value)+") ",1),l($,{modelValue:v.value,"onUpdate:modelValue":e[1]||(e[1]=d=>v.value=d),length:6,type:"number",onFinish:z,class:"mb-4","aria-label":"Reset code input",disabled:o(t).isLoading,autofocus:""},null,8,["modelValue","disabled"]),i("div",be,[l(pe,{color:"info",variant:"outlined"},{default:s(()=>[l(P,{start:""},{default:s(()=>e[14]||(e[14]=[n("mdi-clock-outline")])),_:1}),e[15]||(e[15]=n(" Code expires in ")),(w(),_(R,{key:W.value,seconds:180,onFinished:J}))]),_:1})]),i("div",we,[l(N,{color:"primary",type:"submit",loading:o(t).isLoading,disabled:!A.value||o(t).isLoading,size:"large",class:"px-8"},{default:s(()=>[l(P,{start:""},{default:s(()=>e[16]||(e[16]=[n("mdi-check-circle")])),_:1}),e[17]||(e[17]=n(" Verify Code "))]),_:1},8,["loading","disabled"])]),i("div",Ve,[l(N,{variant:"text",onClick:e[2]||(e[2]=d=>V.value=1),disabled:o(t).isLoading||S.value},{default:s(()=>e[18]||(e[18]=[n(" Back ")])),_:1},8,["disabled"]),l(N,{variant:"text",onClick:j,disabled:o(t).isLoading||S.value,class:"ms-4"},{default:s(()=>e[19]||(e[19]=[n(" Resend Code ")])),_:1},8,["disabled"])])]),_:1},512)]),_:1}),l(E,{value:3},{default:s(()=>[l(L,{onSubmit:k(H,["prevent"]),ref_key:"newPinForm",ref:I},{default:s(()=>[e[23]||(e[23]=i("p",{class:"text-h6 text-center mb-4"},"Set New PIN",-1)),e[24]||(e[24]=i("p",{class:"text-body-1 text-center mb-6"}," Enter a new 6-digit security PIN for your wallet ",-1)),e[25]||(e[25]=i("p",{class:"text-subtitle-2 mb-2"},"New PIN",-1)),l($,{modelValue:b.value,"onUpdate:modelValue":e[3]||(e[3]=d=>b.value=d),length:6,type:"number",class:"mb-4","aria-label":"New PIN input",disabled:o(t).isLoading,autofocus:""},null,8,["modelValue","disabled"]),e[26]||(e[26]=i("p",{class:"text-subtitle-2 mb-2"},"Confirm New PIN",-1)),l($,{modelValue:x.value,"onUpdate:modelValue":e[4]||(e[4]=d=>x.value=d),length:6,type:"number",class:"mb-6","aria-label":"Confirm PIN input",disabled:o(t).isLoading},null,8,["modelValue","disabled"]),B.value?(w(),ee("div",xe," PINs do not match. Please try again. ")):F("",!0),i("div",Pe,[l(N,{color:"primary",type:"submit",loading:o(t).isLoading,disabled:!q.value||o(t).isLoading,size:"large",class:"px-8"},{default:s(()=>[l(P,{start:""},{default:s(()=>e[21]||(e[21]=[n("mdi-lock-reset")])),_:1}),e[22]||(e[22]=n(" Reset PIN "))]),_:1},8,["loading","disabled"])])]),_:1},512)]),_:1})]),_:1},8,["modelValue"]),l(D,null,{default:s(()=>[o(t).authError?(w(),_(Y,{key:0,type:"error",variant:"tonal",class:"mt-4",density:"comfortable",border:"start",closable:"","onClick:close":e[6]||(e[6]=d=>o(t).authError="")},{default:s(()=>[n(T(o(t).authError),1)]),_:1})):F("",!0)]),_:1}),l(D,null,{default:s(()=>[g.value?(w(),_(Y,{key:0,type:h.value,variant:"tonal",class:"mt-4",density:"comfortable",border:"start",closable:"","onClick:close":e[7]||(e[7]=d=>g.value="")},{default:s(()=>[n(T(g.value),1)]),_:1},8,["type"])):F("",!0)]),_:1})]),_:1})]),_:1})]),_:1})}}},_e=G(Ne,[["__scopeId","data-v-5fcd8cf4"]]),Ce=te({__name:"reset-pin",setup(K){const C=fe();ae(async()=>{await C.fetchTalaStageApp()});const t=r(()=>C.talastageApp);return ve({title:r(()=>{var a;return`Reset Wallet PIN - ${((a=t.value)==null?void 0:a.name)||"TalaStage"}`}),description:r(()=>"Reset your TalaStage wallet PIN securely. Follow the steps to create a new PIN for your wallet."),keywords:r(()=>{var a;return`wallet, reset pin, new pin, security, change pin, ${((a=t.value)==null?void 0:a.name)||"TalaStage"}`}),image:r(()=>{var a;return((a=t.value)==null?void 0:a.logo_url)||"/default-social-image.png"}),type:"website",siteName:r(()=>{var a;return((a=t.value)==null?void 0:a.name)||"TalaStage"}),url:r(()=>{var a;return`${((a=t.value)==null?void 0:a.canonical_url)||"https://talastage.com"}/wallet/reset-pin`}),canonical:r(()=>{var a;return`${((a=t.value)==null?void 0:a.canonical_url)||"https://talastage.com"}/wallet/reset-pin`}),noIndex:!0,openGraph:r(()=>{var a,f,y,I;return{title:`Reset Wallet PIN - ${((a=t.value)==null?void 0:a.name)||"TalaStage"}`,description:"Reset your TalaStage wallet PIN securely. Follow the steps to create a new PIN for your wallet.",url:`${((f=t.value)==null?void 0:f.canonical_url)||"https://talastage.com"}/wallet/reset-pin`,image:((y=t.value)==null?void 0:y.logo_url)||"/default-social-image.png",siteName:((I=t.value)==null?void 0:I.name)||"TalaStage",type:"website"}}),twitter:r(()=>{var a,f;return{card:"summary_large_image",title:`Reset Wallet PIN - ${((a=t.value)==null?void 0:a.name)||"TalaStage"}`,description:"Reset your TalaStage wallet PIN securely. Follow the steps to create a new PIN for your wallet.",image:((f=t.value)==null?void 0:f.logo_url)||"/default-social-image.png"}}),link:r(()=>{var a;return[{rel:"icon",href:((a=t.value)==null?void 0:a.favicon_url)||"/favicon.ico"}]})}),(a,f)=>{const y=_e;return w(),_(y)}}}),Ze=G(Ce,[["__scopeId","data-v-2c564123"]]);export{Ze as default};
