import{_ as q}from"./Cw5ECwNl.js";import{_ as H}from"./3SmzOII5.js";import{_ as J}from"./CkOuN04m.js";import{n as S,i as O,c as k,o,a as u,w as t,p as s,b as h,v as l,s as p,q as x,y as g,_ as B,g as Y,j as V,x as c,J as G,m as $,F as N,D as K,A as Q}from"./CGQimWOm.js";import{V as W}from"./CRY4crBU.js";import{V as C}from"./CS8xUUzH.js";import{a as I}from"./DsvAftJq.js";import{V as X}from"./BkTuXOR_.js";import{_ as Z}from"./Cxb8uY_z.js";import{_ as ee}from"./CAn9t2Ej.js";import{_ as te}from"./DL649WMo.js";import{u as se}from"./De3D2xlH.js";import"./DcSlHAeh.js";import"./BSH7BhKc.js";/* empty css        */import"./2hEmiBig.js";import"./xvVMJZi9.js";import"./COhe-ksk.js";import"./BcH3Kywr.js";import"./DJ0NdY24.js";import"./CjukEv2V.js";import"./C-GTDzx5.js";import"./IpAEdaYr.js";import"./DMBY-Kaj.js";import"./GXZRJwQ4.js";import"./BhN2__aY.js";import"./tTgLLTve.js";import"./DoIi4J9g.js";import"./C-73ZGdz.js";import"./BFmCCZJK.js";import"./Dg4qVXYX.js";const ne={class:"text-h6 font-weight-medium text-truncate"},oe={class:"text-body-2 text-grey-darken-1 mt-1"},re={class:"mt-2 d-flex gap-2"},ae=S({__name:"UserInvestmentCard",props:{investment:{}},emits:["openApproveDialog"],setup(D){const i=D,d=O(),v=k(()=>{var e;return((e=d.user)==null?void 0:e.id)||""}),j=k(()=>`/watch/${i.investment.project.access_uuid}`),y=k(()=>`/investments/earnings/projects/${i.investment.project.access_uuid}/investor-details-${v.value}`);k(()=>`/project/${i.investment.project.access_uuid}/earnings/`);const _=e=>e?`${Math.floor((Date.now()-new Date(e).getTime())/(1e3*60*60*24*30))} months ago`:"",A=e=>({approved:"success",pending:"warning",rejected:"error"})[e]||"grey";return(e,n)=>{const b=H,f=J;return o(),u(X,{elevation:"2",class:"investment-card mb-4"},{default:t(()=>[s(W,{"no-gutters":""},{default:t(()=>[s(C,{cols:"12",sm:"3",class:"media-column"},{default:t(()=>[s(f,{to:j.value,class:"media-link"},{default:t(()=>[s(b,{size:"md",videoUrl:e.investment.project.video_url,thumbnailUrl:e.investment.project.thumbnail_url,showViews:!1,showDuration:!0,class:"project-thumbnail-wrapper"},null,8,["videoUrl","thumbnailUrl"])]),_:1},8,["to"])]),_:1}),s(C,{cols:"12",sm:"6",class:"content-column pa-4"},{default:t(()=>{var m;return[h("h3",ne,l(e.investment.project.name),1),h("div",oe,l((m=e.investment.project.views_count)==null?void 0:m.toLocaleString())+" views â€¢ "+l(_(e.investment.project.created_at)),1),h("div",re,[s(I,{small:"",color:e.investment.is_creator?"primary":"grey",variant:"flat"},{default:t(()=>[p(l(e.investment.is_creator?"Creator":"Investor"),1)]),_:1},8,["color"]),s(I,{small:"",color:A(e.investment.status),variant:"flat"},{default:t(()=>[p(l(e.investment.status),1)]),_:1},8,["color"]),s(I,{small:"",color:"success",variant:"flat"},{default:t(()=>[p(l(e.investment.share_percentage)+"% Share ",1)]),_:1})])]}),_:1}),s(C,{cols:"12",sm:"3",class:"actions-column pa-4"},{default:t(()=>[s(x,{to:y.value,color:"primary",variant:"tonal","prepend-icon":"mdi-information",block:"",class:"mb-2"},{default:t(()=>n[1]||(n[1]=[p(" My Earnings ")])),_:1},8,["to"]),e.investment.status==="pending"&&e.investment.can_approve?(o(),u(x,{key:0,color:"success",variant:"tonal","prepend-icon":"mdi-check",block:"",onClick:n[0]||(n[0]=m=>e.$emit("openApproveDialog",e.investment))},{default:t(()=>n[2]||(n[2]=[p(" Approve ")])),_:1})):g("",!0)]),_:1})]),_:1})]),_:1})}}}),ie=B(ae,[["__scopeId","data-v-b1130182"]]),me={class:"investments-container"},le={class:"investments-grid"},ce={key:0,class:"text-center py-4"},pe={key:1,class:"text-center py-4 text-body-2 text-medium-emphasis"},ue=S({__name:"UserInvestments",setup(D){const{$axios:i}=Y(),d=V(!0),v=V(!1),j=async r=>{const a=await i.get("/api/user/investments",{params:{page:r}});return r===1&&(d.value=!1),a.data.data},{items:y,isLoading:_,error:A,hasMore:e,refresh:n,reset:b}=se(j,{threshold:100,throttle:200}),f=async()=>{v.value=!0,b(),await n(),v.value=!1},m=V(!1),U=V(null),M=r=>{U.value=r,m.value=!0},L=async r=>{await i.post(`/api/user/investments/${r}/approve`),await f()},R=async(r,a)=>{await i.post(`/api/user/investments/${r}/reject`,{message:a}),await f()};return(r,a)=>{const z=q,E=ie,P=Z,T=ee,F=te;return o(),u(F,null,{default:t(()=>[s(z,{title:"My Investments",subtitle:"Projects you have invested into"},{actions:t(()=>[s(x,{color:"primary",variant:"text","prepend-icon":"mdi-refresh",loading:v.value,onClick:f,size:"small"},{default:t(()=>a[1]||(a[1]=[p(" Refresh ")])),_:1},8,["loading"])]),_:1}),h("div",me,[c(_)&&d.value?(o(),u(G,{key:0,indeterminate:"",class:"mb-4"})):g("",!0),c(y).length?(o(),$(N,{key:1},[h("div",le,[(o(!0),$(N,null,K(c(y),w=>(o(),u(E,{key:w.id,investment:w,onOpenApproveDialog:M},null,8,["investment"]))),128))]),c(_)&&!d.value?(o(),$("div",ce,[s(Q,{indeterminate:"",size:"24"})])):g("",!0),c(e)?g("",!0):(o(),$("div",pe," No more investments to load "))],64)):c(_)?g("",!0):(o(),u(P,{key:2,title:"No Investments",message:"You haven't made any investments yet."}))]),s(T,{modelValue:m.value,"onUpdate:modelValue":a[0]||(a[0]=w=>m.value=w),investment:U.value,onApproved:L,onRejected:R},null,8,["modelValue","investment"])]),_:1})}}}),He=B(ue,[["__scopeId","data-v-e41da06f"]]);export{He as default};
