import{_ as ye}from"./DD4k1lXb.js";import{_ as ge}from"./BeQTM7t9.js";import{_ as be}from"./CMYBLF1p.js";import{_ as xe}from"./BV7m3wyX.js";import{_ as he}from"./1tiNUlE7.js";import{u as K}from"./BCoct7aH.js";import{f as Ve,j as m,g as Q,n as Y,c as S,o as r,a as f,w as e,p as a,m as w,b as i,v as y,V as B,s as b,O as ke,y as $,q as X,x as I,F as R,_ as q,a4 as se,l as Z,D as M,G as re,A as ne,u as we,a5 as $e,t as Ie}from"./CGQimWOm.js";import{V as ee}from"./f5lwX8SZ.js";import{V as ae}from"./P_q-BwEt.js";import{V as G}from"./BvtSni_j.js";import{V as te}from"./xvVMJZi9.js";import{V as je}from"./D4pNkYCe.js";import{V as le}from"./CRY4crBU.js";import{V as P}from"./CS8xUUzH.js";import{d as Te,V as O,b as ie,a as A}from"./BkTuXOR_.js";import{u as Ue}from"./B3G4pkyN.js";import{u as ce}from"./CgCCmWi5.js";import{V as ue}from"./GXZRJwQ4.js";import{a as W}from"./DsvAftJq.js";import{V as de}from"./BEy3SeWo.js";import{V as me}from"./BRveoiXI.js";import{V as pe,a as fe,b as H}from"./tTgLLTve.js";import{V as ve}from"./6HtF_owb.js";import{u as Ce}from"./istWFD0Z.js";import{V as Le,a as Se}from"./bFKGpjcd.js";import{V as Be,a as oe}from"./D9lJKT5N.js";import{V as De}from"./BhN2__aY.js";import"./BSH7BhKc.js";import"./DL649WMo.js";import"./CMsVONS5.js";import"./C-73ZGdz.js";import"./2hEmiBig.js";import"./BFmCCZJK.js";import"./Dg4qVXYX.js";import"./CjukEv2V.js";import"./C-GTDzx5.js";import"./COhe-ksk.js";import"./BcH3Kywr.js";import"./DJ0NdY24.js";import"./IpAEdaYr.js";import"./CiN8dqd8.js";import"./DMBY-Kaj.js";import"./CiXMVmI4.js";/* empty css        */import"./CDtnx0aA.js";import"./DyYnZ78z.js";import"./Dn0bXcU5.js";const _e=Ve("projectInvestorBalance",()=>{const D=m(null),p=m(!1),V=m(null),v=m(null),j=m(null),{$axios:T}=Q();async function _(u,c){p.value=!0,V.value=null,v.value=u,j.value=c;try{const g=await T.get(`/api/projects/${u}/earnings/investors/${c}/balance`);D.value=g.data}catch(g){console.error("Error fetching project investor balance:",g),V.value=g instanceof Error?g.message:"Failed to fetch balance"}finally{p.value=!1}}async function x(){if(!v.value||!j.value){console.warn("Cannot update balance: accessUuid or investorId is missing");return}await _(v.value,j.value)}return{balance:D,isLoading:p,error:V,fetchBalance:_,updateBalanceAfterTransfer:x}}),Ee={class:"mb-4"},ze={class:"text-h5 font-weight-bold mb-2"},Ne={class:"d-flex align-center justify-space-between mb-4"},Pe={class:"d-flex align-center"},Ae={class:"mr-4"},Re={class:"text-h6 font-weight-medium"},Fe={key:0,class:"share-percentage-container"},He={class:"d-flex align-center"},We={class:"text-h6 font-weight-medium"},Me={class:"text-medium-emphasis"},Ge=Y({__name:"ProjectInvestorBalanceCard",props:{balance:{},loading:{type:Boolean},accessUuid:{}},setup(D){const p=D,{formatRelativeDate:V}=K(),v=m(!1),j=_e(),T=S(()=>!p.balance||!p.balance.data||!p.balance.data.investor_type?"Investor Earnings":p.balance.data.investor_type.type==="creator"?"Project Creator Earnings":"Investor Earnings"),_=s=>s?Number(s).toFixed(2):"0.00",x=S(()=>{var s,n,l;return((l=(n=(s=p.balance)==null?void 0:s.data)==null?void 0:n.investor_type)==null?void 0:l.is_user)??!1}),u=S(()=>{var s,n;return((n=(s=p.balance)==null?void 0:s.data)==null?void 0:n.project_investor)??null}),c=S(()=>{var s,n;return((n=(s=p.balance)==null?void 0:s.data)==null?void 0:n.currency)??{symbol:"$",code:"USD"}}),g=S(()=>{if(!u.value)return"Unknown Investor";if(x.value){const n=u.value;return n.display_name||n.username||"Anonymous User"}return u.value.name||"Unnamed Page"}),k=S(()=>{var s,n;return(n=(s=p.balance)==null?void 0:s.data)!=null&&n.project_investor?`/api/projects/${p.accessUuid}/earnings/investors/${p.balance.data.project_investor.id}/transfer-to-wallet`:""});function E(){v.value=!0}function U(){v.value=!1,j.updateBalanceAfterTransfer()}return(s,n)=>{const l=ge,z=be,C=xe,N=he;return r(),f(O,{elevation:"10"},{default:e(()=>[a(Te,null,{default:e(()=>[s.loading?(r(),f(ee,{key:0,type:"list-item-three-line"})):!s.balance||!s.balance.data?(r(),f(ae,{key:1,type:"info",text:"No balance information available",variant:"tonal"})):(r(),w(R,{key:2},[i("div",Ee,[i("h1",ze,y(T.value),1),a(G,{class:"mb-4"})]),i("div",Ne,[i("div",Pe,[i("div",Ae,[x.value&&u.value?(r(),f(l,{key:0,username:u.value.username||"",profile_photo:u.value.profile_photo||"",size:"xl"},null,8,["username","profile_photo"])):u.value?(r(),f(z,{key:1,page:u.value,size:"xl"},null,8,["page"])):(r(),f(te,{key:2,size:"xl",color:"grey lighten-2"},{default:e(()=>[a(B,null,{default:e(()=>n[1]||(n[1]=[b("mdi-account")])),_:1})]),_:1}))]),i("div",null,[i("h2",Re,y(g.value),1),n[2]||(n[2]=i("span",{class:"text-body-2 text-medium-emphasis"},"Project Investor",-1))])]),s.balance.data.share_percentage!==void 0?(r(),w("div",Fe,[a(je,{location:"top",text:"Your share percentage in this project"},{activator:e(({props:L})=>[i("div",ke({class:"share-percentage d-flex flex-column align-center"},L),[i("div",He,[a(B,{icon:"mdi-chart-pie",class:"mr-2",color:"primary"}),i("span",We,y(_(s.balance.data.share_percentage))+"% ",1)]),n[3]||(n[3]=i("span",{class:"text-caption text-medium-emphasis"},"Your Share Percentage",-1))],16)]),_:1})])):$("",!0)]),c.value?(r(),f(le,{key:0},{default:e(()=>[a(P,{cols:"12",sm:"6",md:"4"},{default:e(()=>[a(C,{title:"Available Balance",amount:Number(s.balance.data.balance||0),"currency-symbol":c.value.symbol,"currency-code":c.value.code,icon:"mdi-wallet",variant:"primary"},{footer:e(({variant:L})=>[a(X,{variant:"tonal",color:L==="primary"?"white":"primary",size:"small",onClick:E,disabled:!Number(s.balance.data.balance)},{default:e(()=>n[4]||(n[4]=[b(" Transfer to Wallet ")])),_:2},1032,["color","disabled"])]),_:1},8,["amount","currency-symbol","currency-code"])]),_:1}),a(P,{cols:"12",sm:"6",md:"4"},{default:e(()=>[a(C,{title:"Total Earned",amount:Number(s.balance.data.total_earned||0),"currency-symbol":c.value.symbol,"currency-code":c.value.code,icon:"mdi-cash-multiple",tooltip:"Total amount received from earnings"},{footer:e(()=>[i("span",Me," Last earning: "+y(s.balance.data.last_earning_at?I(V)(s.balance.data.last_earning_at):"Never"),1)]),_:1},8,["amount","currency-symbol","currency-code"])]),_:1}),a(P,{cols:"12",sm:"6",md:"4"},{default:e(()=>[a(C,{title:"Total Withdrawn",amount:Number(s.balance.data.total_withdrawn||0),"currency-symbol":c.value.symbol,"currency-code":c.value.code,icon:"mdi-cash-remove"},null,8,["amount","currency-symbol","currency-code"])]),_:1})]),_:1})):$("",!0),c.value?(r(),f(N,{key:1,modelValue:v.value,"onUpdate:modelValue":n[0]||(n[0]=L=>v.value=L),"transfer-endpoint":k.value,"available-balance":Number(s.balance.data.balance||0),"currency-symbol":c.value.symbol,"currency-code":c.value.code,onTransferSuccess:U},null,8,["modelValue","transfer-endpoint","available-balance","currency-symbol","currency-code"])):$("",!0)],64))]),_:1})]),_:1})}}}),Ye=q(Ge,[["__scopeId","data-v-731094ae"]]),qe={class:"font-weight-medium"},Oe={class:"font-weight-medium"},Je={class:"font-weight-medium"},Ke={key:0},Qe={class:"font-weight-medium"},Xe={key:1},Ze={class:"font-weight-medium"},ea={key:0,class:"text-center py-4"},aa={key:0,class:"pa-4 text-center"},ta=Y({__name:"ProjectInvestorTransactions",props:{accessUuid:{},investorId:{}},emits:["update:transactions","update:loading","update:total"],setup(D,{emit:p}){const V=D,v=p,{$axios:j}=Q(),{currencyFormatter:T}=Ue(),{formatLocalDateTime:_,formatRelativeDate:x}=K(),u=m([]),c=m(0),g=m(!0),k=m(null),E=m(!1),U=m(!0),s=S(()=>`/api/projects/${V.accessUuid}/earnings/investors/${V.investorId}/transactions`),n=async h=>{try{const{data:t}=await j.get(s.value,{params:{page:h}});return h===1?u.value=t.data:u.value=[...u.value,...t.data],c.value=t.meta.total[0],U.value=t.meta.current_page[0]<t.meta.last_page[0],v("update:transactions",u.value),v("update:total",c.value),t.data}catch(t){throw k.value=t instanceof Error?t:new Error("Failed to load transactions"),E.value=!0,console.error("Error fetching transactions:",t),k.value}finally{g.value=!1}},{sentinelRef:l,isLoading:z,initLoader:C,page:N}=ce(n,U,{immediate:!1});se(()=>{v("update:loading",z.value)});function L(h){return{processed:"success",pending:"warning",cancelled:"error"}[h]||"grey"}function d(){U.value=!0,k.value=null,g.value=!0,C()}return Z(()=>{C()}),(h,t)=>(r(),f(O,{elevation:"0",border:""},{default:e(()=>[a(ie,{class:"d-flex align-center px-4 py-3 bg-grey-lighten-4"},{default:e(()=>[a(B,{icon:"mdi-bank-transfer",class:"mr-2"}),t[1]||(t[1]=i("span",{class:"text-h6"},"Transaction History",-1)),a(ue),c.value?(r(),f(W,{key:0,size:"small",color:"primary",variant:"flat"},{default:e(()=>[b(y(c.value)+" transactions ",1)]),_:1})):$("",!0)]),_:1}),a(G),g.value?(r(),f(A,{key:0,class:"pa-4"},{default:e(()=>[(r(),w(R,null,M(3,o=>a(de,{key:o,class:"mb-4 pa-4 rounded-lg bg-grey-lighten-4"},{default:e(()=>[a(ee,{type:"list-item-avatar, text@2"})]),_:2},1024)),64))]),_:1})):!u.value.length&&!g.value?(r(),f(A,{key:1},{default:e(()=>[a(ae,{type:"info",variant:"tonal",border:"start",class:"mb-0"},{prepend:e(()=>[a(B,{icon:"mdi-information"})]),default:e(()=>[t[2]||(t[2]=b(" No transactions found. "))]),_:1})]),_:1})):(r(),f(me,{key:2},{default:e(()=>[(r(!0),w(R,null,M(u.value,(o,J)=>(r(),f(pe,{key:o.id,class:re({"bg-grey-lighten-4":J%2!==0})},{prepend:e(()=>[a(te,{color:L(o.status),size:"48"},{default:e(()=>[a(B,{icon:"mdi-bank-transfer",size:"32"})]),_:2},1032,["color"])]),default:e(()=>[a(fe,{class:"font-weight-medium"},{default:e(()=>{var F;return[b(y(I(_)(o.created_at||((F=o.timestamps)==null?void 0:F.created_at))),1)]}),_:2},1024),a(H,{class:"text-caption text-grey"},{default:e(()=>{var F;return[b(y(I(x)(o.created_at||((F=o.timestamps)==null?void 0:F.created_at))),1)]}),_:2},1024),a(H,null,{default:e(()=>[t[3]||(t[3]=i("span",{class:"text-caption text-grey"},"Status:",-1)),a(W,{color:L(o.status),size:"small",variant:"flat",class:"ml-1 text-capitalize"},{default:e(()=>[b(y(o.status),1)]),_:2},1032,["color"])]),_:2},1024),a(H,{class:"mt-2"},{default:e(()=>[a(le,null,{default:e(()=>[a(P,{cols:"12",sm:"4",class:"text-start"},{default:e(()=>[t[4]||(t[4]=i("div",{class:"text-caption text-grey mb-1"},"Gross Amount",-1)),i("div",qe,y(I(T)(o.gross_amount,o.currency.symbol,o.currency.code)),1)]),_:2},1024),a(P,{cols:"12",sm:"4",class:"text-start"},{default:e(()=>[t[5]||(t[5]=i("div",{class:"text-caption text-grey mb-1"},"Net Amount",-1)),i("div",Oe,y(I(T)(o.net_amount,o.currency.symbol,o.currency.code)),1)]),_:2},1024),a(P,{cols:"12",sm:"4",class:"text-start"},{default:e(()=>[t[6]||(t[6]=i("div",{class:"text-caption text-grey mb-1"},"Service Fee",-1)),i("div",Je,y(I(T)(o.app_service_fee,o.currency.symbol,o.currency.code)),1)]),_:2},1024)]),_:2},1024)]),_:2},1024),o.metadata&&(o.metadata.transaction_reference||o.metadata.description)?(r(),f(H,{key:0,class:"mt-2"},{default:e(()=>[a(G,{class:"mb-2"}),o.metadata.transaction_reference?(r(),w("div",Ke,[t[7]||(t[7]=i("span",{class:"text-caption text-grey"},"Reference:",-1)),i("span",Qe,y(o.metadata.transaction_reference),1)])):$("",!0),o.metadata.description?(r(),w("div",Xe,[t[8]||(t[8]=i("span",{class:"text-caption text-grey"},"Description:",-1)),i("span",Ze,y(o.metadata.description),1)])):$("",!0)]),_:2},1024)):$("",!0)]),_:2},1032,["class"]))),128)),i("div",{ref_key:"sentinelRef",ref:l,class:"sentinel-element py-2"},[I(z)?(r(),w("div",ea,[a(ne,{indeterminate:"",color:"primary"})])):$("",!0)],512),!U.value&&u.value.length>0?(r(),w("div",aa,[a(W,{color:"grey",size:"small",variant:"flat"},{default:e(()=>t[9]||(t[9]=[b(" No more transactions ")])),_:1})])):$("",!0)]),_:1})),a(ve,{modelValue:E.value,"onUpdate:modelValue":t[0]||(t[0]=o=>E.value=o),color:"error",timeout:"3000"},{actions:e(()=>[a(X,{variant:"text",onClick:d},{default:e(()=>t[10]||(t[10]=[b("Retry")])),_:1})]),default:e(()=>{var o;return[b(y(((o=k.value)==null?void 0:o.message)||"Failed to load transactions")+" ",1)]}),_:1},8,["modelValue"])]),_:1}))}}),oa=q(ta,[["__scopeId","data-v-722a2a38"]]),sa={key:0,class:"text-center py-4"},ra={key:0,class:"pa-4 text-center text-caption text-grey"},na=Y({__name:"ProjectInvestorBalanceHistory",props:{accessUuid:{},investorId:{}},emits:["update:history","update:loading","update:total"],setup(D,{emit:p}){const V=D,v=p,{$axios:j}=Q(),{formatLocalDateTime:T}=K(),_=m([]),x=m(!0),u=m(null),c=m(!1),g=m(!0),k=m(0),E=S(()=>`/api/projects/${V.accessUuid}/earnings/investors/${V.investorId}/balance-history`),U=h=>({completed:"success",pending:"warning",failed:"error"})[h]||"grey",s=(h,t)=>`${t} ${h}`,n=(h,t)=>T(`${h} ${t}`),l=async h=>{try{const{data:t}=await j.get(E.value,{params:{page:h}});return h===1?_.value=t.data:_.value=[..._.value,...t.data],k.value=t.meta.total,g.value=t.meta.current_page<t.meta.last_page,v("update:history",_.value),v("update:total",k.value),t.data}catch(t){throw u.value=t instanceof Error?t:new Error("Failed to load balance history"),c.value=!0,console.error("Error fetching balance history:",t),u.value}finally{x.value=!1}},{sentinelRef:z,isLoading:C,initLoader:N,page:L}=ce(l,g,{immediate:!1});se(()=>{v("update:loading",C.value)});function d(){g.value=!0,u.value=null,x.value=!0,N()}return Z(()=>{N()}),(h,t)=>(r(),f(O,{elevation:"0",border:""},{default:e(()=>[a(ie,{class:"d-flex align-center px-4 py-3 bg-grey-lighten-4"},{default:e(()=>[a(B,{icon:"mdi-history",class:"mr-2"}),t[1]||(t[1]=i("span",{class:"text-h6"},"Balance History",-1)),a(ue),k.value?(r(),f(W,{key:0,size:"small",color:"primary",variant:"flat"},{default:e(()=>[b(y(k.value)+" transactions ",1)]),_:1})):$("",!0)]),_:1}),a(G),x.value?(r(),f(A,{key:0,class:"pa-4"},{default:e(()=>[(r(),w(R,null,M(3,o=>a(de,{key:o,class:"mb-4 pa-4 rounded-lg bg-grey-lighten-4"},{default:e(()=>[a(ee,{type:"list-item-two-line"})]),_:2},1024)),64))]),_:1})):!_.value.length&&!x.value?(r(),f(A,{key:1},{default:e(()=>[a(ae,{type:"info",variant:"tonal",border:"start",class:"mb-0"},{prepend:e(()=>[a(B,{icon:"mdi-information"})]),default:e(()=>[t[2]||(t[2]=b(" No balance history found. "))]),_:1})]),_:1})):(r(),f(A,{key:2,class:"pa-0"},{default:e(()=>[a(me,null,{default:e(()=>[(r(!0),w(R,null,M(_.value,(o,J)=>(r(),f(pe,{key:o.id,ripple:!1,class:re(["py-4 px-4",{"bg-grey-lighten-4":J%2===0}])},{prepend:e(()=>[a(te,{color:U(o.status),size:"42",class:"mr-3"},{default:e(()=>[a(B,{icon:"mdi-swap-horizontal"})]),_:2},1032,["color"])]),append:e(()=>[a(W,{color:U(o.status),size:"small",variant:"flat",class:"text-capitalize"},{default:e(()=>[b(y(o.status),1)]),_:2},1032,["color"])]),default:e(()=>[a(fe,{class:"font-weight-medium mb-1"},{default:e(()=>[b(y(s(o.amount,o.currency.symbol)),1)]),_:2},1024),a(H,{class:"text-caption d-flex align-center"},{default:e(()=>[a(B,{size:"16",icon:"mdi-clock-outline",class:"mr-1",color:"grey-darken-1"}),b(" "+y(n(o.date,o.time)),1)]),_:2},1024)]),_:2},1032,["class"]))),128)),i("div",{ref_key:"sentinelRef",ref:z,class:"sentinel-element py-2"},[I(C)&&!x.value?(r(),w("div",sa,[a(ne,{indeterminate:"",color:"primary"})])):$("",!0)],512),!g.value&&_.value.length>0?(r(),w("div",ra," End of history ")):$("",!0)]),_:1})]),_:1})),a(ve,{modelValue:c.value,"onUpdate:modelValue":t[0]||(t[0]=o=>c.value=o),color:"error",timeout:"3000"},{actions:e(()=>[a(X,{variant:"text",onClick:d},{default:e(()=>t[3]||(t[3]=[b("Retry")])),_:1})]),default:e(()=>{var o;return[b(y(((o=u.value)==null?void 0:o.message)||"Failed to load balance history")+" ",1)]}),_:1},8,["modelValue"])]),_:1}))}}),la=q(na,[["__scopeId","data-v-7b86ffff"]]),ia=Y({__name:"investor-details-[investorId]",setup(D){const p=we(),V=Ce(),v=_e(),{project:j,isLoading:T}=$e(V),_=S(()=>p.params.access_uuid),x=S(()=>p.params.investorId),u=[{label:"Transactions",value:"transactions",icon:"mdi-swap-horizontal"},{label:"Withdrawals",value:"history",icon:"mdi-cash-minus"}],c=m("transactions"),g=m([]),k=m([]),E=m(0),U=m(0),s=m({transactions:!1,balanceHistory:!1});return Z(async()=>{await Promise.all([V.fetchProject(_.value),v.fetchBalance(_.value,x.value)])}),Ie([()=>p.params.access_uuid,()=>p.params.investorId],async([n,l])=>{n&&l&&await v.fetchBalance(n,l)}),(n,l)=>{const z=ye,C=Ye,N=oa,L=la;return r(),f(De,null,{default:e(()=>[a(z,{project:I(j),loading:I(T),elevation:10,subtitle:"InvestorEarnings & Revenue Analytics"},null,8,["project","loading"]),a(C,{balance:I(v).balance,loading:I(v).isLoading,"access-uuid":_.value,class:"mb-6"},null,8,["balance","loading","access-uuid"]),a(O,{elevation:"10"},{default:e(()=>[a(Le,{modelValue:c.value,"onUpdate:modelValue":l[0]||(l[0]=d=>c.value=d),"fixed-tabs":"","bg-color":"primary","slider-color":"secondary"},{default:e(()=>[(r(),w(R,null,M(u,d=>a(Se,{key:d.value,value:d.value,class:"text-none"},{default:e(()=>[a(B,{icon:d.icon,class:"mr-2"},null,8,["icon"]),b(" "+y(d.label),1)]),_:2},1032,["value"])),64))]),_:1},8,["modelValue"]),a(A,{class:"pa-0"},{default:e(()=>[a(Be,{modelValue:c.value,"onUpdate:modelValue":l[7]||(l[7]=d=>c.value=d)},{default:e(()=>[a(oe,{value:"transactions"},{default:e(()=>[a(N,{"access-uuid":_.value,"investor-id":x.value,"onUpdate:transactions":l[1]||(l[1]=d=>g.value=d),"onUpdate:loading":l[2]||(l[2]=d=>s.value.transactions=d),"onUpdate:total":l[3]||(l[3]=d=>E.value=d)},null,8,["access-uuid","investor-id"])]),_:1}),a(oe,{value:"history"},{default:e(()=>[a(L,{"access-uuid":_.value,"investor-id":x.value,"onUpdate:history":l[4]||(l[4]=d=>k.value=d),"onUpdate:loading":l[5]||(l[5]=d=>s.value.balanceHistory=d),"onUpdate:total":l[6]||(l[6]=d=>U.value=d)},null,8,["access-uuid","investor-id"])]),_:1})]),_:1},8,["modelValue"])]),_:1})]),_:1})]),_:1})}}}),tt=q(ia,[["__scopeId","data-v-d7c00134"]]);export{tt as default};
