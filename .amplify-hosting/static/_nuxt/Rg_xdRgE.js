import{f as g,g as h}from"./CGQimWOm.js";const u=g("talentCategories",{state:()=>({categories:[],currentCategory:null,currentPage:1,lastPage:1,isFetching:!1,error:null,searchTerm:"",hasMorePages:!1,perPage:16,total:0,talents:[],isFetchingTalents:!1,talentsError:null,hasMoreTalents:!1,currentCategorySlug:null,isFetchingCategory:!1}),getters:{hasMore:e=>e.hasMorePages&&!e.isFetching,hasMoreTalentsToLoad:e=>e.hasMoreTalents&&!e.isFetchingTalents},actions:{async fetchCategories(e=1,s=!0){if(this.isFetching)return[];this.isFetching=!0,this.error=null;try{const{$axios:t}=h(),i=await t.get("/guest/talent/categories",{params:{page:e,per_page:this.perPage}}),{data:a,meta:r}=i.data;if(s)this.categories=a;else{const n=a.filter(l=>!this.categories.some(o=>o.id===l.id));this.categories=[...this.categories,...n]}return this.updatePaginationMeta(r),a}catch{return this.handleError("Failed to fetch categories. Please try again."),[]}finally{this.isFetching=!1}},async fetchCategoryTalents(e,s={},t=!1){if(!(this.isFetchingTalents||!t&&this.currentCategorySlug===e&&this.talents.length)){this.currentCategorySlug!==e&&!t&&(this.talents=[],this.currentCategorySlug=e),this.isFetchingTalents=!0,this.talentsError=null;try{const{$axios:i}=h(),a=await i.get(`/guest/talent/categories/${e}/talents`,{params:s}),{data:r,meta:n}=a.data;return t?this.talents=[...this.talents,...r]:this.talents=r,this.updatePaginationMeta(n),r}catch{return this.handleError("Failed to fetch talents. Please try again."),[]}finally{this.isFetchingTalents=!1}}},async fetchCategoryBySlug(e){if(e){this.currentCategory=null,this.isFetchingCategory=!0,this.error=null;try{const{$axios:s}=h(),t=await s.get(`/guest/talent/categories/${e}`);this.currentCategory=t.data}catch{this.handleError("Failed to fetch category details. Please try again.")}finally{this.isFetchingCategory=!1}}},async loadMore(){return this.hasMore?this.fetchCategories(this.currentPage+1,!1):[]},setSearchTerm(e){this.searchTerm!==e&&(this.searchTerm=e,this.resetCategories(),this.fetchCategories())},resetCategories(){this.categories=[],this.currentPage=1,this.lastPage=1,this.hasMorePages=!1,this.error=null,this.total=0},resetTalents(){this.talents=[],this.currentPage=1,this.lastPage=1,this.hasMoreTalents=!1,this.talentsError=null,this.currentCategorySlug=null},getSingleValue(e){return Array.isArray(e)?e[0]:e},updatePaginationMeta(e){this.hasMorePages=this.getSingleValue(e.has_more_pages),this.hasMoreTalents=this.getSingleValue(e.has_more_pages),this.currentPage=this.getSingleValue(e.current_page),this.lastPage=this.getSingleValue(e.last_page),this.perPage=this.getSingleValue(e.per_page),this.total=this.getSingleValue(e.total)},handleError(e){console.error(e),this.error=e}}});export{u};
