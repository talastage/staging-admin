import{_ as O}from"./Cw5ECwNl.js";import{_ as G}from"./3SmzOII5.js";import{u as K}from"./CeETcD8a.js";import{n as M,u as N,l as Q,c as W,o as a,a as i,w as t,p as n,b as V,v as p,s as m,q as A,y as _,_ as B,g as X,j as g,x as c,J as Y,m as $,F as x,D as Z,A as ee}from"./CGQimWOm.js";import{V as R}from"./CRY4crBU.js";import{V as w}from"./CS8xUUzH.js";import{a as D}from"./DsvAftJq.js";import{V as te}from"./BkTuXOR_.js";import{_ as oe}from"./Corpgyop.js";import{_ as se}from"./CAn9t2Ej.js";import{u as ne}from"./De3D2xlH.js";import{V as ae}from"./P_q-BwEt.js";import{V as re}from"./BhN2__aY.js";import"./DcSlHAeh.js";import"./BSH7BhKc.js";/* empty css        */import"./2hEmiBig.js";import"./xvVMJZi9.js";import"./BCoct7aH.js";import"./COhe-ksk.js";import"./BcH3Kywr.js";import"./DJ0NdY24.js";import"./CjukEv2V.js";import"./C-GTDzx5.js";import"./IpAEdaYr.js";import"./DMBY-Kaj.js";import"./GXZRJwQ4.js";import"./tTgLLTve.js";import"./DoIi4J9g.js";import"./C-73ZGdz.js";import"./BFmCCZJK.js";import"./Dg4qVXYX.js";const ie={class:"text-h6 font-weight-medium text-truncate"},le={class:"text-body-2 text-grey-darken-1 mt-1"},me={class:"mt-2 d-flex gap-2"},pe=M({__name:"PageInvestmentCard",props:{investment:{}},emits:["openApproveDialog"],setup(P){const k=P,l=K(),y=N().params.pageSlug;Q(async()=>{if(!l.page&&!l.loading)try{await l.fetchPageData(y)}catch(e){console.error("Error fetching page data in PageInvestmentCard:",e)}});const u=W(()=>{var o;const e=(o=l.page)==null?void 0:o.id;return e?`/investments/earnings/projects/${k.investment.project.access_uuid}/investor-details-${e}`:"#"}),d=e=>e?`${Math.floor((Date.now()-new Date(e).getTime())/(1e3*60*60*24*30))} months ago`:"",C=e=>({approved:"success",pending:"warning",rejected:"error"})[e]||"grey";return(e,o)=>{const b=G;return a(),i(te,{elevation:"2",class:"investment-card mb-4"},{default:t(()=>[n(R,{"no-gutters":""},{default:t(()=>[n(w,{cols:"12",sm:"3",class:"media-column"},{default:t(()=>[n(b,{size:"md",videoUrl:e.investment.project.video_url,thumbnailUrl:e.investment.project.thumbnail_url,showViews:!1,showDuration:!0,class:"project-thumbnail-wrapper"},null,8,["videoUrl","thumbnailUrl"])]),_:1}),n(w,{cols:"12",sm:"6",class:"content-column pa-4"},{default:t(()=>{var v;return[V("h3",ie,p(e.investment.project.name),1),V("div",le,p((v=e.investment.project.views_count)==null?void 0:v.toLocaleString())+" views â€¢ "+p(d(e.investment.project.created_at)),1),V("div",me,[n(D,{small:"",color:e.investment.is_creator?"primary":"grey",variant:"flat"},{default:t(()=>[m(p(e.investment.is_creator?"Creator":"Investor"),1)]),_:1},8,["color"]),n(D,{small:"",color:C(e.investment.status),variant:"flat"},{default:t(()=>[m(p(e.investment.status),1)]),_:1},8,["color"]),n(D,{small:"",color:"success",variant:"flat"},{default:t(()=>[m(p(e.investment.share_percentage)+"% Share ",1)]),_:1})])]}),_:1}),n(w,{cols:"12",sm:"3",class:"actions-column pa-4"},{default:t(()=>[n(A,{to:u.value,color:"primary",variant:"tonal","prepend-icon":"mdi-information",block:""},{default:t(()=>o[1]||(o[1]=[m(" My Earnings ")])),_:1},8,["to"]),e.investment.status==="pending"?(a(),i(A,{key:0,color:"success",variant:"tonal","prepend-icon":"mdi-check",block:"",onClick:o[0]||(o[0]=v=>e.$emit("openApproveDialog",e.investment))},{default:t(()=>o[2]||(o[2]=[m(" Approve ")])),_:1})):_("",!0)]),_:1})]),_:1})]),_:1})}}}),ce=B(pe,[["__scopeId","data-v-c984daf2"]]),ue={key:1,class:"text-center my-4"},de=M({__name:"PageInvestments",setup(P){const k=N(),{$axios:l}=X(),h=k.params.pageSlug,y=g(!1),u=g(!0),d=g(!1),C=async r=>{const s=await l.get(`/api/pages/investments/${h}`,{params:{page:r}});return r===1&&(y.value=s.data.is_creator,u.value=!1),s.data.data},{items:e,isLoading:o,error:b,hasMore:v,refresh:L,reset:U}=ne(C,{threshold:100,throttle:200}),j=async()=>{d.value=!0,U(),await L(),d.value=!1},I=g(!1),S=g(null),E=r=>{S.value=r,I.value=!0},T=async r=>{await l.post(`/api/pages/investments/${h}/${r}/approve`),await j()},F=async(r,s)=>{await l.post(`/api/pages/investments/${h}/${r}/reject`,{message:s}),await j()};return(r,s)=>{const q=O,z=ce,H=oe,J=se;return a(),i(re,{fluid:""},{default:t(()=>[n(q,{title:"Page Investments",subtitle:"Projects this page has invested into"},{actions:t(()=>[n(A,{color:"primary",variant:"text","prepend-icon":"mdi-refresh",loading:d.value,onClick:j},{default:t(()=>s[1]||(s[1]=[m(" Refresh ")])),_:1},8,["loading"])]),_:1}),c(o)&&u.value?(a(),i(Y,{key:0,indeterminate:"",class:"my-4"})):_("",!0),c(e).length?(a(),$(x,{key:1},[n(R,null,{default:t(()=>[(a(!0),$(x,null,Z(c(e),f=>(a(),i(w,{cols:"12",key:f.id},{default:t(()=>[y.value?(a(),i(z,{key:0,investment:f,onOpenApproveDialog:E},null,8,["investment"])):(a(),i(H,{key:1,project:f},null,8,["project"]))]),_:2},1024))),128))]),_:1}),c(o)&&!u.value?(a(),i(ee,{key:0,indeterminate:"",class:"my-4"})):_("",!0),c(v)?_("",!0):(a(),$("div",ue,s[2]||(s[2]=[V("span",null,"No more data.",-1)])))],64)):c(o)?_("",!0):(a(),i(ae,{key:2,type:"info"},{default:t(()=>s[3]||(s[3]=[m(" No investments found. ")])),_:1})),n(J,{modelValue:I.value,"onUpdate:modelValue":s[0]||(s[0]=f=>I.value=f),investment:S.value,onApproved:T,onRejected:F},null,8,["modelValue","investment"])]),_:1})}}}),Oe=B(de,[["__scopeId","data-v-d3f87771"]]);export{Oe as default};
