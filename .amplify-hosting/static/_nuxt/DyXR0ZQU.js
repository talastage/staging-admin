import{d as L}from"./Zmmmyk0F.js";import{f as U,j as g,g as B,n as I,aM as w,o as n,m as _,p as r,w as e,x as c,a as f,A as N,y as b,F,D as T,v as h,b as x,M as z,q as M,s as y,V as A,_ as R}from"./CGQimWOm.js";import{b as $,a as j}from"./2hEmiBig.js";import{V as D}from"./CMsVONS5.js";import{V}from"./BkTuXOR_.js";import{V as E,a as P,b as Q}from"./tTgLLTve.js";import{V as Y}from"./xvVMJZi9.js";import{V as G}from"./BSH7BhKc.js";const H=U("userSearch",()=>{const i=g([]),m=g(!1),o=g(null);return{searchResults:i,isLoading:m,error:o,searchUsers:async l=>{if(!l.trim())return i.value=[],{data:[]};m.value=!0,o.value=null;try{const{$axios:d}=B(),p=await d.get("/api/search-users",{params:{query:l}});return i.value=p.data.data,p.data}catch(d){throw o.value="Failed to search users. Please try again.",d}finally{m.value=!1}},clearSearch:()=>{i.value=[],o.value=null}}}),J={class:"user-search"},K={key:1,class:"text-h6"},O={class:"d-flex align-center"},W={class:"text-body-1 text-grey"},X=I({__name:"SearchUser",props:{minSearchLength:{default:2},debounceMs:{default:300},loading:{type:Boolean,default:!1},placeholder:{default:""}},emits:["user-selected"],setup(i,{emit:m}){const o=i,v=m,t=H(),l=g(""),d=L(async a=>{a.length>=o.minSearchLength?await t.searchUsers(a):t.clearSearch()},o.debounceMs),p=a=>{d(a)},k=()=>{l.value="",t.clearSearch()},S=a=>{v("user-selected",a)},C=a=>a.split(" ").map(u=>u[0]).join("").toUpperCase().slice(0,2);return w(()=>{d.cancel()}),(a,u)=>(n(),_("div",J,[r(V,{flat:"",class:"mb-4 pa-2"},{default:e(()=>[r(D,{modelValue:l.value,"onUpdate:modelValue":[u[0]||(u[0]=s=>l.value=s),p],density:"comfortable",variant:"outlined",label:"Search users",placeholder:a.placeholder||"Enter name or username","prepend-inner-icon":"mdi-magnify",loading:c(t).isLoading,error:!!c(t).error,"error-messages":c(t).error,clearable:"","onClick:clear":k,"hide-details":""},{append:e(()=>[r($,null,{default:e(()=>[c(t).isLoading?(n(),f(N,{key:0,indeterminate:"",size:"24",color:"primary"})):b("",!0)]),_:1})]),_:1},8,["modelValue","placeholder","loading","error","error-messages"])]),_:1}),r(j,{group:""},{default:e(()=>[c(t).searchResults.length?(n(!0),_(F,{key:0},T(c(t).searchResults,s=>(n(),f(V,{key:s.id,flat:"",class:"mb-2 user-card"},{default:e(()=>[r(E,null,{prepend:e(()=>[r(Y,{size:"40",color:"grey-lighten-3"},{default:e(()=>[s.profile_photo?(n(),f(G,{key:0,src:s.profile_photo,alt:s.display_name},null,8,["src","alt"])):(n(),_("span",K,h(C(s.display_name)),1))]),_:2},1024)]),append:e(()=>[x("div",O,[z(a.$slots,"user-action",{user:s,selectUser:()=>S(s)},()=>[r(M,{color:"primary",variant:"tonal",size:"small",onClick:Z=>S(s),loading:a.loading},{default:e(()=>u[1]||(u[1]=[y(" Select ")])),_:2},1032,["onClick","loading"])],!0)])]),default:e(()=>[r(P,{class:"font-weight-medium"},{default:e(()=>[y(h(s.display_name),1)]),_:2},1024),r(Q,{class:"text-grey"},{default:e(()=>[y(" @"+h(s.username),1)]),_:2},1024)]),_:2},1024)]),_:2},1024))),128)):l.value&&!c(t).isLoading?(n(),f(V,{key:1,flat:"",class:"pa-4 text-center"},{default:e(()=>[r(A,{icon:"mdi-account-search-outline",size:"48",color:"grey-lighten-1",class:"mb-2"}),x("div",W,' No users found matching "'+h(l.value)+'" ',1)]),_:1})):b("",!0)]),_:3})]))}}),ne=R(X,[["__scopeId","data-v-c623875a"]]);export{ne as _};
