import{_ as oe}from"./CT8473XM.js";import{n as re,g as le,j as d,c as V,t as U,l as ie,o as i,m as b,p as s,w as a,a as p,b as r,V as M,q as h,s as n,J as ne,y as f,R as G,v as x,C as ue,x as T,G as de,F as ce,D as me,A as pe,U as fe,_ as ge}from"./CGQimWOm.js";import{u as ve}from"./BZRTckJ6.js";import{u as ye}from"./DMBY-Kaj.js";import{b as be,V as xe}from"./2hEmiBig.js";import{a as D,V as I,b as $,c as H}from"./BkTuXOR_.js";import{V as _e}from"./P_q-BwEt.js";import{V as Ve}from"./CiXMVmI4.js";import{V as he}from"./DoIi4J9g.js";import{V as we}from"./BvtSni_j.js";import{V as Se}from"./D4pNkYCe.js";import{V as ke}from"./DJ0NdY24.js";import{V as Ce}from"./GXZRJwQ4.js";import{V as Fe}from"./BcH3Kywr.js";const Me={class:"support-ticket-container"},Te={class:"success-animation"},De={class:"d-flex align-center"},Ie={class:"form-section mb-6"},Ae={key:0,class:"text-caption text-medium-emphasis mt-2 px-3"},Ee={class:"form-section"},Ne={class:"d-flex align-start"},Pe={class:"text-body-2 mb-0 pl-4"},qe={class:"w-100 d-flex align-center justify-space-between"},Re={class:"d-flex align-center"},Le={key:0},ze={key:1},Be={class:"d-flex align-center gap-3"},Ue={class:"text-center"},w=10,g=1e3,Ge=re({__name:"SendSupportMessage",setup($e){const{$axios:j}=le(),c=ye(),v=ve(),A=d(null),E=d(!1),y=d(!1),S=d(!1),k=d({}),u=d(""),_=d(!1),J=d(!0),o=d({category_id:null,message:""}),O=[t=>!!t||"Message is required",t=>t&&t.length>=w||`Message must be at least ${w} characters`,t=>t&&t.length<=g||`Message cannot exceed ${g} characters`],N=V(()=>E.value&&o.value.category_id&&o.value.message.trim().length>=w&&!y.value),P=V(()=>o.value.category_id||o.value.message.trim().length>0),W=V(()=>o.value.category_id?"Please provide as much detail as possible about your issue. Include any error messages, steps you took, and what you expected to happen.":"Please select a category first to enable this field..."),q=V(()=>{if(!o.value.category_id)return"";const t=v.categories.find(e=>e.id===o.value.category_id);return(t==null?void 0:t.description)||""}),Y=V(()=>{const t={1:["Include specific error messages","Mention when the issue started"],2:["Describe what you were trying to do","Include screenshots if helpful"],3:["Specify your account details","Mention payment method used"],default:["Be as specific as possible","Include relevant details like browser, device, or error messages","Mention steps to reproduce the issue"]};return t[o.value.category_id]||t.default}),C=()=>{k.value={},u.value=""},X=t=>({"text-error":t>g*.9,"text-warning":t>g*.8&&t<=g*.9}),K=()=>{C(),o.value.category_id&&fe(()=>{const t=document.querySelector(".message-textarea textarea");t&&t.focus()})},Q=()=>{C()},Z=()=>{_.value=!0},ee=()=>{R(),_.value=!1,c.info("Form cleared")},R=()=>{o.value={category_id:null,message:""},C(),A.value&&A.value.resetValidation(),S.value=!1},te=async()=>{var t,e,F,l,L,z,B;if(N.value){y.value=!0,C();try{await j.post("/api/support/tickets",{...o.value,message:o.value.message.trim()}),c.success("Your support request has been submitted successfully!"),S.value=!0,o.value={category_id:null,message:""}}catch(m){console.error("Submit error:",(t=m.response)==null?void 0:t.data),((e=m.response)==null?void 0:e.status)===422&&((l=(F=m.response)==null?void 0:F.data)!=null&&l.errors)?(k.value=m.response.data.errors,c.error("Please check the form for errors")):(z=(L=m.response)==null?void 0:L.data)!=null&&z.message?(u.value=m.response.data.message,c.error(u.value)):((B=m.response)==null?void 0:B.status)>=500?(u.value="Server is temporarily unavailable. Please try again later.",c.error("Server error - please try again later")):(u.value="An unexpected error occurred. Please try again.",c.error("Something went wrong - please try again"))}finally{y.value=!1}}},se=()=>{typeof window<"u"&&localStorage.setItem("supportFormDraft",JSON.stringify(o.value))},ae=()=>{if(typeof window<"u"){const t=localStorage.getItem("supportFormDraft");if(t)try{const e=JSON.parse(t);(e.category_id||e.message)&&(o.value=e)}catch{console.warn("Failed to load saved form data")}}};return U(o,()=>{P.value&&se()},{deep:!0}),ie(async()=>{try{await v.fetchCategories(),ae()}catch{u.value="Failed to load categories. Please refresh the page.",c.error("Failed to load support categories")}}),U(S,t=>{t&&typeof window<"u"&&localStorage.removeItem("supportFormDraft")}),(t,e)=>{const F=oe;return i(),b("div",Me,[s(G,{name:"fade",mode:"out-in"},{default:a(()=>[S.value?(i(),p(I,{key:"success",class:"success-card mx-auto text-center",elevation:"3"},{default:a(()=>[s(D,{class:"py-12"},{default:a(()=>[r("div",Te,[s(M,{icon:"mdi-check-circle",color:"success",size:"72",class:"mb-4 animate-bounce"})]),e[8]||(e[8]=r("h2",{class:"text-h4 mb-3 text-success font-weight-medium"}," Request Submitted! ",-1)),e[9]||(e[9]=r("p",{class:"text-body-1 mb-6 text-medium-emphasis"}," We've received your support request and will respond within 24 hours. You'll receive an email confirmation shortly. ",-1)),s(h,{color:"primary",variant:"outlined",size:"large",onClick:R,"prepend-icon":"mdi-plus"},{default:a(()=>e[7]||(e[7]=[n(" Submit Another Request ")])),_:1})]),_:1})]),_:1})):(i(),p(I,{key:"form",class:"form-card mx-auto",elevation:"2"},{default:a(()=>[s($,{class:"px-6 py-4 bg-primary-lighten-5"},{default:a(()=>[r("div",De,[s(M,{icon:"mdi-help-circle-outline",class:"mr-3",color:"primary"}),e[10]||(e[10]=r("div",null,[r("h3",{class:"text-h6 mb-1"},"Contact Support"),r("p",{class:"text-caption text-medium-emphasis mb-0"}," We're here to help! Tell us what you need assistance with. ")],-1))])]),_:1}),y.value?(i(),p(ne,{key:0,indeterminate:"",color:"primary",height:"3"})):f("",!0),s(G,{name:"slide-y-transition"},{default:a(()=>[u.value?(i(),p(_e,{key:0,type:"error",variant:"tonal",closable:"",class:"ma-4 mb-0","onClick:close":e[0]||(e[0]=l=>u.value="")},{prepend:a(()=>[s(M,{icon:"mdi-alert-circle"})]),default:a(()=>[n(" "+x(u.value),1)]),_:1})):f("",!0)]),_:1}),s(Ve,{ref_key:"form",ref:A,modelValue:E.value,"onUpdate:modelValue":e[3]||(e[3]=l=>E.value=l),onSubmit:ue(te,["prevent"])},{default:a(()=>[s(D,{class:"px-6 pt-6"},{default:a(()=>[r("div",Ie,[e[11]||(e[11]=r("label",{class:"form-label mb-3 d-block"},[n(" What can we help you with? "),r("span",{class:"text-error"},"*")],-1)),s(F,{modelValue:o.value.category_id,"onUpdate:modelValue":[e[1]||(e[1]=l=>o.value.category_id=l),K],categories:T(v).categories,loading:T(v).isLoading,"error-messages":k.value.category_id,placeholder:"Choose a category...",variant:"outlined",density:"comfortable"},null,8,["modelValue","categories","loading","error-messages"]),s(be,null,{default:a(()=>[q.value?(i(),b("div",Ae,x(q.value),1)):f("",!0)]),_:1})]),r("div",Ee,[e[13]||(e[13]=r("label",{class:"form-label mb-3 d-block"},[n(" Describe your issue "),r("span",{class:"text-error"},"*")],-1)),s(he,{modelValue:o.value.message,"onUpdate:modelValue":e[2]||(e[2]=l=>o.value.message=l),"error-messages":k.value.message,rules:O,variant:"outlined",maxlength:g,counter:o.value.message.length>0,rows:"5","auto-grow":"","max-rows":8,placeholder:W.value,disabled:!o.value.category_id,onInput:Q,class:"message-textarea"},{counter:a(({props:l})=>[r("div",{class:de(["text-caption",X(l.value)])},x(l.value)+" / "+x(g),3)]),_:1},8,["modelValue","error-messages","counter","placeholder","disabled"]),s(xe,null,{default:a(()=>[J.value&&o.value.category_id?(i(),p(I,{key:0,variant:"tonal",color:"info",class:"mt-3"},{default:a(()=>[s(D,{class:"py-3"},{default:a(()=>[r("div",Ne,[s(M,{icon:"mdi-lightbulb-outline",color:"info",size:"20",class:"mr-2 mt-1"}),r("div",null,[e[12]||(e[12]=r("div",{class:"text-subtitle-2 mb-2"},"Helpful Tips:",-1)),r("ul",Pe,[(i(!0),b(ce,null,me(Y.value,l=>(i(),b("li",{key:l},x(l),1))),128))])])])]),_:1})]),_:1})):f("",!0)]),_:1})])]),_:1}),s(H,{class:"px-6 pb-6 pt-0"},{default:a(()=>[s(we,{class:"mb-4"}),r("div",qe,[r("div",Re,[e[14]||(e[14]=r("span",{class:"text-caption text-medium-emphasis"},[r("span",{class:"text-error"},"*"),n(" Required fields ")],-1)),!N.value&&o.value.message.length>0?(i(),p(Se,{key:0,activator:"parent",location:"top"},{default:a(()=>[o.value.category_id?o.value.message.length<w?(i(),b("div",ze," Message must be at least "+x(w)+" characters ")):f("",!0):(i(),b("div",Le," Please select a category "))]),_:1})):f("",!0)]),r("div",Be,[P.value?(i(),p(h,{key:0,variant:"text",color:"error",onClick:Z,disabled:y.value},{default:a(()=>e[15]||(e[15]=[n(" Clear Form ")])),_:1},8,["disabled"])):f("",!0),s(h,{color:"primary",size:"large",type:"submit",loading:y.value,disabled:!N.value,"prepend-icon":"mdi-send"},{loading:a(()=>e[16]||(e[16]=[r("span",null,"Submitting...",-1)])),default:a(()=>[e[17]||(e[17]=n(" Submit Request "))]),_:1},8,["loading","disabled"])])])]),_:1})]),_:1},8,["modelValue"]),s(ke,{modelValue:T(v).isLoading,"onUpdate:modelValue":e[4]||(e[4]=l=>T(v).isLoading=l),class:"align-center justify-center",persistent:"",contained:""},{default:a(()=>[r("div",Ue,[s(pe,{indeterminate:"",color:"primary",size:"48"}),e[18]||(e[18]=r("div",{class:"mt-3 text-body-2"},"Loading categories...",-1))])]),_:1},8,["modelValue"])]),_:1}))]),_:1}),s(Fe,{modelValue:_.value,"onUpdate:modelValue":e[6]||(e[6]=l=>_.value=l),"max-width":"400"},{default:a(()=>[s(I,null,{default:a(()=>[s($,{class:"text-h6"},{default:a(()=>e[19]||(e[19]=[n("Clear Form?")])),_:1}),s(D,null,{default:a(()=>e[20]||(e[20]=[n(" Are you sure you want to clear all form data? This action cannot be undone. ")])),_:1}),s(H,null,{default:a(()=>[s(Ce),s(h,{variant:"text",onClick:e[5]||(e[5]=l=>_.value=!1)},{default:a(()=>e[21]||(e[21]=[n("Cancel")])),_:1}),s(h,{color:"error",variant:"text",onClick:ee},{default:a(()=>e[22]||(e[22]=[n("Clear")])),_:1})]),_:1})]),_:1})]),_:1},8,["modelValue"])])}}}),ot=ge(Ge,[["__scopeId","data-v-519c176b"]]);export{ot as S};
